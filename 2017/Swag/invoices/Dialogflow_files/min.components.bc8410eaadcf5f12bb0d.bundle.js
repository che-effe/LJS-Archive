webpackJsonp([9],[,,,,,,,,function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(){o()(this,e)}return r()(e,null,[{key:"notify",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.Status.INFO;e.showStatus(t,n)}},{key:"info",value:function(t){e.showStatus(t,e.Status.INFO)}},{key:"infoHTML",value:function(t){e.showStatus(t,e.Status.INFO,!0)}},{key:"error",value:function(t){e.showStatus(t,e.Status.ERROR)}},{key:"errorHTML",value:function(t){e.showStatus(t,e.Status.ERROR,!0)}},{key:"success",value:function(t){e.showStatus(t,e.Status.SUCCESS)}},{key:"stdErrorSkipIfEmpty",value:function(t){try{var n=t.data.status.errorDetails;n&&e.error(n)}catch(e){}return e.getQService().reject(t)}},{key:"stdErrorHtml",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Error";return e.stdError(t,n,!0)}},{key:"stdError",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Error",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.getStdErrorMessageFromXhr(t);return o||(o=e.getStdErrorMessageFromResponse(t)),i?e.errorHTML(o||n):e.error(o||n),e.getQService().reject(t)}},{key:"stdErrorNoReject",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Error";e.stdError(t,n).catch(function(){})}},{key:"showStatus",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.Status.INFO,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.getService().showStatus(t,n,i)}},{key:"getService",value:function(){return this.statusesService||(this.statusesService=angular.element(document.body).injector().get("statusesService")),this.statusesService}},{key:"getQService",value:function(){return this.qService||(this.qService=angular.element(document.body).injector().get("$q")),this.qService}},{key:"getStdErrorMessageFromXhr",value:function(e){return _.has(e,"data.status.errorDetails")?e.data.status.errorDetails:null}},{key:"getStdErrorMessageFromResponse",value:function(e){return _.has(e,"status.errorDetails")?e.status.errorDetails:null}}]),e}();s.statusesService=null,s.qService=null,function(e){!function(e){e[e.ERROR="error"]="ERROR",e[e.INFO="info"]="INFO",e[e.SUCCESS="success"]="SUCCESS"}(e.Status||(e.Status={}))}(s||(s={}))},,,,,function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(){o()(this,e)}return r()(e,null,[{key:"publish",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.observers[e]&&this.observers[e].forEach(function(n){n(e,t)})}},{key:"subscribe",value:function(e,t){this.observers[e]||(this.observers[e]=[]),this.observers[e].push(t)}},{key:"unsubscribe",value:function(e,t){if(this.observers[e]){var n=this.observers[e].findIndex(function(e){return e===t});if(!(n<0))return this.observers[e].splice(n,1),!0}}},{key:"unsubscribeAllFromEvent",value:function(e){delete this.observers[e]}}]),e}();s.observers={},function(e){!function(e){e[e.DEPRECATED_DOMAINS_TURNED_OFF=0]="DEPRECATED_DOMAINS_TURNED_OFF",e[e.CURRENT_AGENT_CHANGED=1]="CURRENT_AGENT_CHANGED",e[e.AGENT_DATA_UPDATE=2]="AGENT_DATA_UPDATE",e[e.AGENT_UPLOAD_SUCCESS=3]="AGENT_UPLOAD_SUCCESS"}(e.DEFINED_EVENTS||(e.DEFINED_EVENTS={}))}(s||(s={}))},,,,,function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=function(){function e(t,n){o()(this,e),this.$scope=t,this.$timeout=n}return r()(e,[{key:"$onInit",value:function(){this.$timeout(this.elasticAdjust.bind(this))}},{key:"elasticAdjust",value:function(){this.$scope.$broadcast("elastic:adjust")}}]),e}();t.a=s},,function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(){o()(this,e)}return r()(e,null,[{key:"handleLazyLoad",value:function(t,n){return e.promises[n]||(e.promises[n]=t),e.promises[n].then(function(){var e=n;void 0!==e.onLoadFn&&e.onLoadFn()})}},{key:"handleComponentLazyLoad",value:function(t,n,i,o){return e.promises[n]||(e.promises[n]=t.then(e.loadLazyComponents(o))),e.promises[n].then(function(){return i})}},{key:"loadLazyComponents",value:function(e){return function(t){t.default.forEach(function(t){e.component(t.name,t.component)})}}}]),e}();s.promises={},function(e){!function(e){e[e.SMALLTALK=0]="SMALLTALK",e[e.INTEGRATION=1]="INTEGRATION",e[e.TRAINING=2]="TRAINING",e[e.AGENT_STORE=3]="AGENT_STORE",e[e.CUSTOM_RESPONSE=4]="CUSTOM_RESPONSE",e[e.COMPONENT_ANALYTICS=5]="COMPONENT_ANALYTICS",e[e.SUPPORT=6]="SUPPORT"}(e.COMPONENT||(e.COMPONENT={}));!function(e){e[e.ACE_EDITOR={onLoadFn:function(){ace.config.set("basePath","/api-client/js/ace")}}]="ACE_EDITOR"}(e.SOURCE||(e.SOURCE={}))}(s||(s={}))},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(9),l=n.n(s),u=n(5),c=n.n(u),d=n(11),m=n.n(d),g=n(12);n.d(t,"a",function(){return p});var h=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=m()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&l()(t,n,r),r},p=function(){function e(){o()(this,e),this.innerViewState={isLoading:!1}}return r()(e,[{key:"getConfig",value:function(){return this.apiConfig.getClientConfig()}},{key:"getConfigRecord",value:function(e,t){return this.apiConfig.getConfigRecord(e,t)}},{key:"hasCapability",value:function(e){return this.apiConfig.hasCapability(e)}},{key:"isLoading",value:function(){return this.innerViewState.isLoading}},{key:"showLoading",value:function(){return this.setIsLoading(!0)}},{key:"hideLoading",value:function(){return this.setIsLoading(!1)}},{key:"setIsLoading",value:function(e){var t=this;return!0!==e&&!1!==e&&(e=!this.innerViewState.isLoading),this.$timeout(function(){t.innerViewState.isLoading=e})}}]),e}();h([n.i(g.b)("apiConfig")],p.prototype,"apiConfig",void 0),h([n.i(g.b)("$timeout")],p.prototype,"$timeout",void 0)},,,,,function(e,t,n){e.exports={default:n(64),__esModule:!0}},,,,,,,,,,,,,function(e,t,n){e.exports={default:n(248),__esModule:!0}},,function(e,t,n){"use strict";var i=n(5),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(17),c=n(37),d=n(55),m=n(8);n.d(t,"a",function(){return g});var g=function(){function e(){r()(this,e)}return l()(e,[{key:"splitTheModel",value:function(e,t){var n=[],i=void 0,o=void 0,a=void 0,r=e.length;for(i=0,o=i*t,a=Math.min((i+1)*t,r);o<r||a<r;++i,o=i*t,a=Math.min((i+1)*t,r))n[i]=e.slice(o,a);return n}}],[{key:"formatLocale",value:function(t){if(!t)return"";if(!e.localeFormatCache[t]){var n=t.toString().split("-");n[0]&&(n[0]=n[0].toLowerCase()),n[1]&&(n[1]=n[1].toUpperCase()),e.localeFormatCache[t]=n.join("-")}return e.localeFormatCache[t]}},{key:"relativeTime",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=void 0,a=void 0,r=void 0,s=new Date,l=s.getTime()-t,u=null,c="";return l<e.ONE_AND_A_HALF_MINUTE?c="Just now":l<e.ONE_HOUR?(o=Math.floor(l/e.ONE_MINUTE),u=o,c="min"+(o>1?"s":""),c+=i?" ago":""):l<e.ONE_DAY?(a=Math.floor(l/e.ONE_HOUR),u=a,c="hour"+(a>1?"s":""),c+=i?" ago":""):(r=Math.floor(l/e.ONE_DAY),u=r,c="day"+(r>1?"s":""),c+=i?" ago":""),n===e.RelativeTimeMode.MODE_NUMBER?u:n===e.RelativeTimeMode.MODE_STRING?c:u?u+" "+c:c}},{key:"replaceNotNAME",value:function(t){return t.replace(e.NAME_RE,"")}},{key:"pushToMap",value:function(e,t,n){if(n[e]){n[e].some(function(e){return e===t})||n[e].push(t)}else n[e]=[t];return n}},{key:"replaceNotLatinAlphanumeric",value:function(t){return t.replace(e.LATIN_ALPHANUMERIC_RE,"")}},{key:"getLatinAlphaNumericRe",value:function(){return e.LATIN_ALPHANUMERIC_RE}},{key:"whitespaceShift",value:function(t){return t=t.replace(e.WHITESPACE_SHIFT_RE_ALIAS,"$1>$3$2"),t=t.replace(e.WHITESPACE_SHIFT_RE,"$1>$2")}},{key:"replaceHtmlEscapeToChar",value:function(t){return t?t.replace(e.HTML_ESCAPE_TO_CHAR_RE,function(t,n,i,o){return e.htmlEscapeToChar[n]}):t}},{key:"replaceCharToHtmlEscape",value:function(t){return t.replace(e.CHAR_TO_HTML_ESCAPE_RE,function(t,n,i,o){return e.charToHtmlEscape[n]})}},{key:"replaceHtmlToWhitespace",value:function(t){return t.replace(e.NBSP_RE,function(e,t){return" "})}},{key:"replaceWhitespaceToHtml",value:function(t){var n=t.length;return t.replace(e.WHITESPACE_RE,function(e,t){function i(e,t){var n=new Array(e),i=t?0:1;for(a=0;a<e;++a)n[a]=a%2===i?" ":"&nbsp;";return n}var o=e.length,a=void 0,r=void 0;return n===o?(r=i(o,o%2==0),r[0]="&nbsp;"):r=0===t?i(o,!1):t===n-o?i(o,o%2==0):i(o,!0),r.join("")})}},{key:"searchFnFactory",value:function(t,n){return function(i,o){var a=e.trimFirst(i.toLowerCase(),n),r=t();o(r&&r.length>0?$.map(r,function(t){var i=e.trimFirst(t.toLowerCase(),n);return i.indexOf(a)>=0&&i!==a?t:null}):[])}}},{key:"diff_1",value:function(e,t,n){n=n||function(e,t){return e===t};var i=void 0,o=void 0,a=void 0,r=e.length,s=t.length;if(!angular.isArray(e)||!angular.isArray(t))throw"IllegalArgumentException: arr1 or arr2 is not array.";for(i=0;i<r&&i<s&&n(e[i],t[i]);)++i;if(i===r&&i===s)return{id:i,op:"equals",len:0};for(o=r-1,a=s-1;o>=0&&a>=0&&n(e[o],t[a]);)--o,--a;++o,++a;var l=void 0,u=void 0;return o===a?(l="edit",u=o-i):a>o?(l="add",u=a-i):(l="delete",u=o-i),{id:i,op:l,len:u}}},{key:"mergeArrays",value:function(e,t){if(!angular.isArray(e)||!angular.isArray(e))throw"Illegal arguments: arguments are not arrays.";var n=[],i=[],o=t.length,a=new Array(o);e.forEach(function(e){var n=void 0;t.some(function(t,i){return n=i,angular.equals(e,t)})?a[n]=!0:i.push(e)});for(var r=0;r<o;++r)a[r]||n.push(t[r]);return{deleted:n,added:i}}},{key:"_merge",value:function(t,n,i){if(t===n)return!0;if(null===t||null===n)return!1;if(t!==t&&n!==n)return!0;var a=void 0===t?"undefined":o()(t),r=void 0===n?"undefined":o()(n),s=void 0,l=void 0,u=void 0,c=void 0;if(a===r&&"object"===a){if(angular.isArray(t))return!!angular.isArray(n)&&(u=!0,c=t.length,n.forEach(function(n,o){e._isScope(n)||e._isWindow(n)||(o<c?e._merge(t[o],n,i)||(u=!1):t.push(i?angular.copy(n):n))}),u);if(angular.isDate(t))return!!angular.isDate(n)&&(isNaN(t.getTime())&&isNaN(n.getTime())||t.getTime()===n.getTime());if(e._isRegExp(t)&&e._isRegExp(n))return t.toString()===n.toString();if(e._isScope(t)||e._isScope(n)||e._isWindow(t)||e._isWindow(n)||angular.isArray(n))return!1;l={};for(s in t)"$"===s.charAt(0)||angular.isFunction(t[s])||e._equals(t[s],n[s])&&(l[s]=!0);u=!0;for(s in n)l.hasOwnProperty(s)||"$"===s.charAt(0)||void 0===n[s]||angular.isFunction(n[s])||(s in t?e._merge(t[s],n[s],i)||(u=!1):t[s]=i?angular.copy(n[s]):n[s]);return u}return!1}},{key:"_equals",value:function(t,n){if(t===n)return!0;if(null===t||null===n)return!1;if(t!==t&&n!==n)return!0;var i,a,r=void 0===t?"undefined":o()(t),s=void 0===n?"undefined":o()(n);if(r==s&&"object"==r){if(!angular.isArray(t)){if(angular.isDate(t))return!!angular.isDate(n)&&e._equals(t.getTime(),n.getTime());if(e._isRegExp(t))return!!e._isRegExp(n)&&t.toString()==n.toString();if(e._isScope(t)||e._isScope(n)||e._isWindow(t)||e._isWindow(n)||angular.isArray(n)||angular.isDate(n)||e._isRegExp(n))return!1;a={};for(i in t)if("$"!==i.charAt(0)&&!angular.isFunction(t[i])){if(!e._equals(t[i],n[i]))return!1;a[i]=!0}for(i in n)if(!a.hasOwnProperty(i)&&"$"!==i.charAt(0)&&void 0!==n[i]&&!angular.isFunction(n[i]))return!1;return!0}if(!angular.isArray(n))return!1;if(t.length==n.length)return t.every(function(t){return n.some(function(n){return e._equals(t,n)})})}return!1}},{key:"_isScope",value:function(e){return e&&e.$evalAsync&&e.$watch}},{key:"_isRegExp",value:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}},{key:"_isWindow",value:function(e){return e&&e.window===e}},{key:"replaceContent",value:function(e,t){if(angular.isArray(e)&&angular.isArray(t))e.splice(0);else{if(!angular.isObject(e)||!angular.isObject(t))return;angular.forEach(e,function(t,n){delete e[n]})}angular.copy(t,e)}},{key:"getProperty",value:function(e,t){var n,i,a;return n=t.split("."),i=n.length-1,a=n.every(function(t,n){return e=e[t],"object"==(void 0===e?"undefined":o()(e))||n==i}),a?e:void 0}},{key:"setProperty",value:function(e,t,n){var i=void 0,a=void 0,r=void 0;return i=t.split("."),a=i.pop(),r=i.every(function(t,n){return e=e[t],"object"===(void 0===e?"undefined":o()(e))}),r&&(e[a]=n),r}},{key:"makeFullName",value:function(e,t){var n=e||"";return t&&(n&&(n+=" "),n+=t),n}},{key:"capitalize",value:function(e){return e&&angular.isString(e)&&e.length>0?e.charAt(0).toUpperCase()+e.substr(1):e}},{key:"checkIdRanges",value:function(e,t,n){return t>=0&&e<t?e=t:n>0&&e>=n&&(e=n-1),e}},{key:"synonymsReplace",value:function(t){return t&&angular.isArray(t)?t.reduce(function(t,n,i,o){var a=n.replace(e.NEW_LINE_RE,";");return a=a.split(e.SEMICOLON_RE),t.concat(a)},[]):t}},{key:"registerPopupErrorHandler",value:function(t,n,i,o){t.$on("$destroy",function(){e.getInterceptor().unregisterHandler(n)}),e.getInterceptor().registerHandler(n,{url:i,callback:function(e){o&&o(e),m.a.stdErrorNoReject(e)}})}},{key:"registerErrorHandler",value:function(t,n,i){t.$on("$destroy",function(){e.getInterceptor().unregisterHandler(n)}),e.getInterceptor().registerHandler(n,i)}},{key:"registerNoopHandler",value:function(t,n){t.$on("$destroy",function(){e.getInterceptor().unregisterHandler(n)}),e.getInterceptor().registerHandler(n,{url:"",callback:function(e){}})}},{key:"trimFirst",value:function(e,t){return 0===e.indexOf(t)?e.substr(t.length):e}},{key:"containsInStringOrArrayFn",value:function(e){function t(t){return angular.isString(t)&&t.toLowerCase().indexOf(e.toLowerCase())>=0}return function(e){return t(e)||angular.isArray(e)&&e.some(t)}}},{key:"convertToHtmlEntities",value:function(e){for(var t=e.length,n="",i=void 0,o=0;o<t;++o)i=e[o],n+="'"===i?"&#x27;":'"'===i?"&quot;":"<"===i?"&lt;":">"===i?"&gt;":i;return n}},{key:"setSelectionRange",value:function(e,t,n){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,n);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i.select()}}},{key:"isApiStatusOk",value:function(e){var t=e.data,n=void 0;return t&&(n=t.status)&&(n.code<200||n.code>299)}},{key:"isSafari",value:function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("safari")>-1&&e.indexOf("chrome")<0}},{key:"isChrome",value:function(){return navigator.userAgent.toLowerCase().indexOf("chrome")>-1}},{key:"isFirefox",value:function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1}},{key:"isOpera",value:function(){return navigator.userAgent.toLowerCase().indexOf("opr")>-1}},{key:"getUrlParameter",value:function(e){var t=decodeURIComponent(window.location.search.substring(1)),n=t.split("&"),i=void 0,o=void 0;for(o=0;o<n.length;o++)if(i=n[o].split("="),i[0]===e)return void 0===i[1]||i[1]}},{key:"fromSlackLanding",value:function(){return!!e.getUrlParameter("slack")}},{key:"fromFacebookLanding",value:function(){return!!e.getUrlParameter("facebook")}},{key:"spreadsheetsParse",value:function(e){if(!e)return[];for(var t=[],n=[],i=void 0,o=e.feed&&e.feed.entry,a=0;a<o.length&&null!==(i=o[a].gs$cell)&&1===Number(i.row);a++)n.push(i.$t);for(var r=(n.length,0);r<o.length;r++)i=o[r].gs$cell,1!==Number(i.row)&&n[i.col-1]&&(t[i.row]||(t[i.row]={}),t[i.row][n[i.col-1]]=i.$t);return _.compact(t)}},{key:"getCohort",value:function(){var e=new Date,t={};t.year=e.getUTCFullYear();var n=new Date(t.year,0,0),i=e.getTime()-n.getTime();return t.day=Math.floor(i/864e5),t.week=Math.floor(i/6048e5),t.month=e.getUTCMonth()+1,t}},{key:"isPrintableKeycode",value:function(e,t){return t=!!angular.isUndefined(t)||t,e>47&&e<58||32===e||!t&&13===e||e>64&&e<91||e>95&&e<112||e>185&&e<193||e>218&&e<223}},{key:"trimJson",value:function(e){if(!e)return e;for(var t=0,n=e.length-1,i=n;"{"!==e[t]&&"["!==e[t]&&t<n;)t++;for(;"}"!==e[i]&&"]"!==e[i]&&i>0;)i--;return t<i?e.substring(t,++i):e}},{key:"getInterceptor",value:function(){return this.httpInterceptor||(this.httpInterceptor=angular.element(document.body).injector().get("httpInterceptor")),this.httpInterceptor}}]),e}();g.httpInterceptor=null,g.ONE_AND_A_HALF_MINUTE=9e4,g.ONE_MINUTE=6e4,g.ONE_HOUR=36e5,g.ONE_DAY=864e5,g.localeFormatCache={},function(e){!function(e){e[e.MODE_NUMBER="number"]="MODE_NUMBER",e[e.MODE_STRING="string"]="MODE_STRING",e[e.MODE_FULL="full"]="MODE_FULL"}(e.RelativeTimeMode||(e.RelativeTimeMode={})),e.NEW_LINE_RE=/\n/g,e.SEMICOLON_RE=/;/g,e.NBSP_RE=/(&nbsp;)/g,e.WHITESPACE_RE=/\s+/g,e.WHITESPACE_SHIFT_RE=/([^>\s]+)([\s\,]+)>/g,e.WHITESPACE_SHIFT_RE_ALIAS=/([^>\s]+)([\s\,]+)>(:[\w-]+)/g,e.LATIN_ALPHANUMERIC_RE=/([^A-Za-z0-9_\-]+)/g,e.HTML_ESCAPE_TO_CHAR_RE=/(&nbsp;|&quot;|&amp;|&lt;|&gt;)/g,e.htmlEscapeToChar={"&nbsp;":" ","&quot;":'"',"&amp;":"&","&lt;":"<","&gt;":">"},e.CHAR_TO_HTML_ESCAPE_RE=/( |"|&|<|>)/g,e.charToHtmlEscape={" ":"&nbsp;",'"':"&quot;","&":"&amp;","<":"&lt;",">":"&gt;"},e.NAME_RE=/([^A-z0-9_\-@.]+)/g;var t=function(){function e(){r()(this,e),this.map={}}return l()(e,[{key:"initFromIntent",value:function(e){return this.map=e.templates.reduce(this._fillFromTemplate.bind(this),{}),this.map}},{key:"pushToMap",value:function(e,t){t&&0===t.indexOf("<")&&(t="");var n=this.map;if(n[e]){n[e].some(function(e){return e===t})||n[e].push(t)}else n[e]=[t];return this}},{key:"updateFromTemplate",value:function(e){return this._fillFromTemplate.apply(this,[this.map,e])}},{key:"_fillFromTemplate",value:function(e,t){var n=this;return t=_.isString(t)?t:u.a.glueParserReady(t),c.a.collectMeta(t).reduce(function(e,t,i,o){if("alias"===t.type){var a=d.a.metaOfNode(t),r=d.a.aliasOfNode(t);n.pushToMap(a,r)}return e},e)}}]),e}();e.NameToAliasMap=t}(g||(g={}))},,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(2),a=i(o),r=n(11),s=i(r);t.default=function e(t,n,i){null===t&&(t=Function.prototype);var o=(0,s.default)(t,n);if(void 0===o){var r=(0,a.default)(t);return null===r?void 0:e(r,n,i)}if("value"in o)return o.value;var l=o.get;if(void 0!==l)return l.call(i)}},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=function(){function e(){o()(this,e)}return r()(e,null,[{key:"track",value:function(e,t,n,i){try{ga("send","event",e,t,n,i)}catch(e){}}},{key:"trackAoG",value:function(t){e.track(e.CATEGORY_ACTIONS_ON_GOOGLE,e.ACTION_AOG[t],null,null)}},{key:"trackAgent",value:function(t,n){e.track(e.CATEGORY_AGENT,e.ACTION_AGENT[t],n,null)}},{key:"trackSignup",value:function(t){e.track(e.CATEGORY_SIGNUP,"default",t,null)}},{key:"trackCloudFunctionsEditor",value:function(t){e.track(e.CATEGORY_CLOUD_FUNCTIONS,e.ACTION_FUNCTIONS[t],null,null)}}]),e}();s.CATEGORY_SIGNUP="Sign up",s.CATEGORY_REQUEST="Request",s.CATEGORY_ACTIONS_ON_GOOGLE="Actions on Google",s.CATEGORY_AGENT="Agent",s.CATEGORY_CLOUD_FUNCTIONS="Cloud Functions",function(e){!function(e){e[e.SUBMIT=0]="SUBMIT",e[e.PREVIEW=1]="PREVIEW",e[e.V2_TEST=2]="V2_TEST",e[e.V2_UPDATE=3]="V2_UPDATE"}(e.ACTION_AOG||(e.ACTION_AOG={}));!function(e){e[e.LOAD_SAMPLE_DATA=0]="LOAD_SAMPLE_DATA",e[e.LOAD_PUBLIC_AGENT=1]="LOAD_PUBLIC_AGENT"}(e.ACTION_AGENT||(e.ACTION_AGENT={}));!function(e){e[e.LOADING_FAILED=0]="LOADING_FAILED",e[e.ENABLE=1]="ENABLE",e[e.DISABLE=2]="DISABLE",e[e.DEPLOY=3]="DEPLOY",e[e.DEPLOY_FAILED=4]="DEPLOY_FAILED",e[e.PROVISIONING_SUCCEEDED=5]="PROVISIONING_SUCCEEDED",e[e.PROVISIONING_FAILED=6]="PROVISIONING_FAILED",e[e.QUOTA_EXCEEDED=7]="QUOTA_EXCEEDED"}(e.ACTION_FUNCTIONS||(e.ACTION_FUNCTIONS={}))}(s||(s={})),t.a=s},,,,,,,,,,,,,function(e,t,n){var i=n(42),o=n(14)("toStringTag"),a="Arguments"==i(function(){return arguments}()),r=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=r(t=Object(e),o))?n:a?i(t):"Object"==(s=i(t))&&"function"==typeof t.callee?"Arguments":s}},,,,,,function(e,t,n){var i=n(10),o=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},,,,,,,,,,,,,,function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(38),l=function(){function e(){o()(this,e)}return r()(e,null,[{key:"checkAndGetError",value:function(t,n){var i=[];return t&&e.check(t,n,i),0===i.length?"":i.join("\n").concat("\n")}},{key:"remove",value:function(t,n){e.removeGoogleAssistantDependencies(t,n)}},{key:"check",value:function(t,n,i){e.checkGoogleAssistantDependencies(t,n,i)}},{key:"checkGoogleAssistantDependencies",value:function(e,t,n){var i=!1;if(t.events&&(i=t.events.some(function(e){return e.name===s.a.Event.EVENT_NAME_GOOGLE_ASSISTANT_WELCOME})),!i){var o=e.googleAssistant;i=o&&(o.hasStartIntent(t.id)||o.hasEndIntent(t.id))}i&&n.push("Intent is used in Google Assistant integration.")}},{key:"removeGoogleAssistantDependencies",value:function(e,t){var n=e.googleAssistant;n&&(n.removeEndIntent(t.id),n.removeStartIntent(t.id))}}]),e}();t.a=l},,,,,,function(e,t,n){e.exports={default:n(240),__esModule:!0}},,,,,function(e,t,n){"use strict";var i=n(104),o=n.n(i),a=n(2),r=n.n(a),s=n(0),l=n.n(s),u=n(1),c=n.n(u),d=n(4),m=n.n(d),g=n(3),h=n.n(g),p=n(21),f=n(45),v=(n(114),"BILLING_PLAN_FREE"),b=3e3,y=/Error: getaddrinfo ENOTFOUND/,k=function(e){function t(e,n){l()(this,t);var i=m()(this,(t.__proto__||r()(t)).call(this));return i.$q=e,i.CloudFunctionsPersistence=n,i.showFirebaseBillingWarning=!1,i.hasOutOfQuotaErrorOccurredInCurrentSession=!1,i.currentOutOfQuotaCheckCycleNumber=0,i}return t.$inject=["$q","CloudFunctionsPersistence"],h()(t,e),c()(t,[{key:"$onChanges",value:function(){this.currentOutOfQuotaCheckCycleNumber++,this.cloudFunctionsEnabled&&this.repeatedlyCheckOutOfQuota(this.currentOutOfQuotaCheckCycleNumber)}},{key:"$onDestroy",value:function(){this.currentOutOfQuotaCheckCycleNumber++}},{key:"repeatedlyCheckOutOfQuota",value:function(e){var t=this;this.currentOutOfQuotaCheckCycleNumber==e&&this.$q.all([this.CloudFunctionsPersistence.getFirebaseBillingPlan(this.cloudProjectId),this.CloudFunctionsPersistence.getLogs(this.cloudProjectId)]).then(function(n){var i=o()(n,2),a=i[0],r=i[1],s=r.filter(function(e){return t.filterLog(e)}).length>0;t.showFirebaseBillingWarning=a===v&&s,t.showFirebaseBillingWarning&&!t.hasOutOfQuotaErrorOccurredInCurrentSession&&(t.hasOutOfQuotaErrorOccurredInCurrentSession=!0,f.a.trackCloudFunctionsEditor(f.a.ACTION_FUNCTIONS.QUOTA_EXCEEDED)),t.$timeout(function(){return t.repeatedlyCheckOutOfQuota(e)},b)})}},{key:"getFireconsoleBillingLink",value:function(){return"https://console.firebase.google.com/project/"+this.cloudProjectId+"/overview?purchaseBillingPlan=true"}},{key:"filterLog",value:function(e){var t=(new Date).getTime()-60*this.lookbackMinutes*1e3;return parseInt(e.timestamp)>t&&y.test(e.payload)}}]),t}(p.a);t.a=k},function(e,t,n){"use strict";var i=n(204),o=n(354);n(377);var a={bindings:{response:"=",speakControl:"=",parentCallback:"=",sendRequest:"="},template:o,controller:i.a,controllerAs:"vm"};t.a=a},,,function(e,t,n){"use strict";var i=n(26),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s);n.d(t,"a",function(){return u});var u=function(){function e(){r()(this,e)}return l()(e,null,[{key:"resolveDownloadPromise",value:function(e,t,n){var i=null,a=null;try{i=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(n.headers("content-disposition"))[1].replace(/['"]/g,""),a=n.headers("content-type")}catch(e){}i&&a||(t=t||"json",i=i||e+"."+t,a=a||"application/"+t+";charset=utf-8");var r="json"===t?o()(n.data,null,2):n.data,s=new Blob([r],{type:a});saveAs(s,i)}}]),e}()},,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=n(233),a=i(o),r=n(84),s=i(r);t.default=function(){function e(e,t){var n=[],i=!0,o=!1,a=void 0;try{for(var r,l=(0,s.default)(e);!(i=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if((0,a.default)(Object(t)))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},,,,,,,function(e,t,n){var i,o,a,r=n(40),s=n(256),l=n(105),u=n(66),c=n(16),d=c.process,m=c.setImmediate,g=c.clearImmediate,h=c.MessageChannel,p=0,f={},v="onreadystatechange",b=function(){var e=+this;if(f.hasOwnProperty(e)){var t=f[e];delete f[e],t()}},y=function(e){b.call(e.data)};m&&g||(m=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return f[++p]=function(){s("function"==typeof e?e:Function(e),t)},i(p),p},g=function(e){delete f[e]},"process"==n(42)(d)?i=function(e){d.nextTick(r(b,e,1))}:h?(o=new h,a=o.port2,o.port1.onmessage=y,i=r(a.postMessage,a,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(e){c.postMessage(e+"","*")},c.addEventListener("message",y,!1)):i=v in u("script")?function(e){l.appendChild(u("script"))[v]=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(r(b,e,1),0)}),e.exports={set:m,clear:g}},function(e,t,n){var i=n(58),o=n(14)("iterator"),a=n(35);e.exports=n(10).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||a[i(e)]}},function(e,t){e.exports='<md-dialog-content>\n  <div class="md-dialog-content" layout="row" layout-align="center center" ng-if="vm.isLoading()">\n    <div layout="row" layout-align="center center">\n      <md-progress-circular  md-mode=\'indeterminate\' md-diameter="40"></md-progress-circular>\n    </div>\n  </div>\n\n  <div class="md-dialog-content" ng-if="!vm.isLoading()">\n\n    <h1 ng-if="!vm.existing">Publish as a new runtime</h1>\n    <h1 ng-if="vm.existing">Publish as an existing runtime</h1>\n\n    <md-input-container class="md-block" ng-if="vm.existing">\n      <br/>\n      <label>Choose a runtime</label>\n      <md-select ng-model="vm.newRuntime">\n        <md-option ng-repeat="runtime in vm.runtimeList" ng-value="runtime"><span ng-bind="runtime.name"></span></md-option>\n      </md-select>\n      <br/><br/>\n    </md-input-container>\n\n    <md-input-container class="md-block" ng-if="!vm.existing">\n      <label>Create a runtime name</label>\n      <input ng-model="vm.newRuntime.name" required/>\n    </md-input-container>\n\n    <md-input-container ng-if="!vm.version" class="md-block">\n      <label>Comment (optional)</label>\n      <input ng-model="vm.newRuntime.comment"/>\n    </md-input-container>\n\n  </div>\n</md-dialog-content>\n<md-dialog-actions ng-if="!vm.isLoading()">\n  <md-button ng-click="vm.cancelDialog()">Cancel</md-button>\n  <div flex></div>\n  <md-button ng-click="vm.publishRuntime()" ng-disabled="!vm.newRuntime.name">Publish</md-button>\n</md-dialog-actions>\n'},function(e,t){e.exports='<div class="failure-callout" ng-show="vm.showFirebaseBillingWarning && vm.cloudFunctionsEnabled"\n     layout="row" layout-align="space-between center">\n    <div>\n        Billing account not configured. External network is not accessible and quotas are severely limited. Configure billing account to remove these restrictions.\n    </div>\n    <md-button\n        ng-href="{{vm.getFireconsoleBillingLink()}}"\n        target="_blank" rel="noopener"\n        type="button" class="md-secondary md-raised editor-button">\n        Upgrade\n    </md-button>\n</div>'},function(e,t,n){"use strict";angular.module("ui.ace",[]).constant("uiAceConfig",{}).directive("uiAce",["uiAceConfig",function(e){if(angular.isUndefined(window.ace))throw new Error("ui-ace need ace to work... (o rly?)");var t=function(e,t,n){if(angular.isDefined(n.workerPath)){window.ace.require("ace/config").set("workerPath",n.workerPath)}angular.isDefined(n.require)&&n.require.forEach(function(e){window.ace.require(e)}),angular.isDefined(n.showGutter)&&e.renderer.setShowGutter(n.showGutter),angular.isDefined(n.useWrapMode)&&t.setUseWrapMode(n.useWrapMode),angular.isDefined(n.showInvisibles)&&e.renderer.setShowInvisibles(n.showInvisibles),angular.isDefined(n.showIndentGuides)&&e.renderer.setDisplayIndentGuides(n.showIndentGuides),angular.isDefined(n.useSoftTabs)&&t.setUseSoftTabs(n.useSoftTabs),angular.isDefined(n.showPrintMargin)&&e.setShowPrintMargin(n.showPrintMargin),angular.isDefined(n.disableSearch)&&n.disableSearch&&e.commands.addCommands([{name:"unfind",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(){return!1},readOnly:!0}]),angular.isString(n.theme)&&e.setTheme("ace/theme/"+n.theme),angular.isString(n.mode)&&t.setMode("ace/mode/"+n.mode),angular.isDefined(n.firstLineNumber)&&(angular.isNumber(n.firstLineNumber)?t.setOption("firstLineNumber",n.firstLineNumber):angular.isFunction(n.firstLineNumber)&&t.setOption("firstLineNumber",n.firstLineNumber()));var i,o;if(angular.isDefined(n.advanced))for(i in n.advanced)o={name:i,value:n.advanced[i]},e.setOption(o.name,o.value);if(angular.isDefined(n.rendererOptions))for(i in n.rendererOptions)o={name:i,value:n.rendererOptions[i]},e.renderer.setOption(o.name,o.value);angular.forEach(n.callbacks,function(t){angular.isFunction(t)&&t(e)})};return{restrict:"EA",require:"?ngModel",link:function(n,i,o,a){var r,s,l=e.ace||{},u=angular.extend({},l,n.$eval(o.uiAce)),c=window.ace.edit(i[0]),d=c.getSession(),m=function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);angular.isDefined(e)&&n.$evalAsync(function(){if(!angular.isFunction(e))throw new Error("ui-ace use a function as callback.");e(t)})},g={onChange:function(e){return function(t){var i=d.getValue();!a||i===a.$viewValue||n.$$phase||n.$root.$$phase||n.$evalAsync(function(){a.$setViewValue(i)}),m(e,t,c)}},onBlur:function(e){return function(){m(e,c)}}};o.$observe("readonly",function(e){c.setReadOnly(!!e||""===e)}),a&&(a.$formatters.push(function(e){if(angular.isUndefined(e)||null===e)return"";if(angular.isObject(e)||angular.isArray(e))throw new Error("ui-ace cannot use an object or an array as a model");return e}),a.$render=function(){d.setValue(a.$viewValue)});var h=function(e,i){e!==i&&(u=angular.extend({},l,n.$eval(o.uiAce)),u.callbacks=[u.onLoad],u.onLoad!==l.onLoad&&u.callbacks.unshift(l.onLoad),d.removeListener("change",r),r=g.onChange(u.onChange),d.on("change",r),c.removeListener("blur",s),s=g.onBlur(u.onBlur),c.on("blur",s),t(c,d,u))};n.$watch(o.uiAce,h,!0),h(l),i.on("$destroy",function(){c.session.$stopWorker(),c.destroy()}),n.$watch(function(){return[i[0].offsetWidth,i[0].offsetHeight]},function(){c.resize(),c.renderer.updateFull()},!0)}}}])},function(e,t,n){"use strict";function i(e,t,i){t.otherwise("/"),e.state("auth.workPlace.agent.prebuiltAgents",{url:"/prebuiltAgents/:publicAgentId",views:{agent:{controller:["$scope","$stateParams",function(e,t){"ngInject";e.publicAgentId=t.publicAgentId}],templateProvider:function(){return o.a.handleComponentLazyLoad(n.e(6).then(n.bind(null,385)),o.a.COMPONENT.AGENT_STORE,'<agent-store-library id-to-open-popup-on-init="publicAgentId"></agent-store-library>',i)}}},data:{activeTab:"prebuiltAgents",headerConfig:{label:'<em class="ico"><span class="flaticon stroke book-5"></span></em>Prebuilt Agents',model:!1,navButton:{}}}})}var o=n(20);i.$inject=["$stateProvider","$urlRouterProvider","$compileProvider"];var a=angular.module("api.agentStore",[]).config(i);t.a=a},function(e,t,n){"use strict";var i=n(20),o=angular.module("api.analytics",[]).config(["$stateProvider","$compileProvider",function(e,t){var o={templateProvider:["CurrentUser",function(e){"ngInject";return google.charts.load("current",{packages:["corechart"]}),i.a.handleComponentLazyLoad(n.e(2).then(n.bind(null,386)),i.a.COMPONENT.COMPONENT_ANALYTICS,"<analytics></analytics>",t)}],controller:angular.noop},a={activeTab:"analytics",headerConfig:{label:'<em class="ico"><span class="flaticon stroke graph-2"></span></em>Analytics',model:!1,navButton:{}}};e.state("auth.workPlace.agent.analytics",{url:"/analytics",views:{agent:o},data:a})}]);t.a=o},function(e,t,n){"use strict";var i=n(174),o=n(173),a=n(175),r=n(177),s=angular.module("api.fulfillment",["api.other"]).config(["$stateProvider","$urlRouterProvider",function(e,t){"ngInject";e.state("auth.workPlace.agent.fulfillment",{url:"/fulfillment",views:{agent:{template:"<fulfillment></fulfillment>",controller:["$scope",function(e){}]}},data:{activeTab:"fulfillment",headerConfig:{label:'<em class="ico"><span class="flaticon stroke lightning-bolt"></span></em>Fulfillment',model:!1,navButton:{}}}})}]).component("firebaseBillingWarning",new i.a).component("cloudFunctionsFulfillment",new o.a).component("fulfillment",new a.a).component("headerWithToggle",new r.a);t.a=s},function(e,t,n){"use strict";var i=n(178),o=n(20),a=angular.module("api.integrations",[]).config(["$stateProvider","$compileProvider",function(e,t){var i={templateProvider:function(){return o.a.handleComponentLazyLoad(n.e(1).then(n.bind(null,387)),o.a.COMPONENT.INTEGRATION,"<integrations></integrations>",t)},controller:angular.noop},a={activeTab:"integrations",headerConfig:{label:'<em class="ico"><span class="flaticon stroke reload-4"></span></em>Integrations',model:!1,navButton:{}}};e.state("auth.workPlace.agent.integrations",{url:"/integrations",views:{agent:i},data:a})}]).component("googleAssistantIntentExpansionComponent",i.a);t.a=a},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(8),l=n(13),u=function(){function e(t,n){o()(this,e),this.CurrentAgentService=t,this.apiConfig=n,this.ioUrl=null,this.agentId=null,this.loaded=!1,l.a.subscribe(l.a.DEFINED_EVENTS.CURRENT_AGENT_CHANGED,this.agentChangedHandler.bind(this)),this.apiConfig.getClientConfig().uiNotificationServiceUrl?this.ioUrl=this.apiConfig.getClientConfig().uiNotificationServiceUrl:this.ioUrl=e.DEFAULT_IO_URL,this.createScript()}return e.$inject=["CurrentAgentService","apiConfig"],r()(e,[{key:"load",value:function(){}},{key:"createScript",value:function(){}},{key:"makeIsLoaded",value:function(){this.agentId=this.CurrentAgentService.getId(),this.loaded=!0,this.initSocket()}},{key:"initSocket",value:function(){var t=this;this.loaded&&(this.socket&&this.socket.connected&&this.socket.disconnect(),this.agentId&&(console.log("about to init"),this.socket=io.connect(this.ioUrl,{query:this.getHandshakeQuery()}),this.socket.on(e.PushEventType.COMPILE_FINISHED,function(){l.a.publish(e.PushEventType.COMPILE_FINISHED,{agentId:t.agentId}),s.a.notify("Agent compilation finished")}),this.socket.on(e.PushEventType.ML_TRAIN_STARTED,function(){l.a.publish(e.PushEventType.ML_TRAIN_STARTED,{agentId:t.agentId}),console.log(">>>PUSH","Agent training started",t.agentId)}),this.socket.on(e.PushEventType.ML_TRAIN_FINISHED,function(){l.a.publish(e.PushEventType.ML_TRAIN_FINISHED,{agentId:t.agentId}),console.log(">>>PUSH","Agent training finished",t.agentId)}),this.socket.on(e.PushEventType.ML_TRAIN_OUTDATED,function(){l.a.publish(e.PushEventType.ML_TRAIN_OUTDATED,{agentId:t.agentId}),console.log(">>>PUSH","Agent training outdated",t.agentId)}),this.socket.on(e.PushEventType.ML_TRAIN_EMPTY,function(){l.a.publish(e.PushEventType.ML_TRAIN_EMPTY,{agentId:t.agentId}),console.log(">>>PUSH","Agent training empty",t.agentId)})))}},{key:"agentChangedHandler",value:function(e,t){this.agentId!==t&&(this.agentId=t,this.initSocket())}},{key:"getHandshakeQuery",value:function(){return"agentId="+this.agentId}}]),e}();u.DEFAULT_IO_PORT="8003",u.DEFAULT_IO_URL=location.protocol+"//"+location.hostname+":"+u.DEFAULT_IO_PORT;var c=angular.module("api.pushNotifications",["api.other"]).service("apiPushNotificationManager",u);!function(e){e.PushEventType={COMPILE_FINISHED:"1101",ML_TRAIN_STARTED:"1102",ML_TRAIN_FINISHED:"1103",ML_TRAIN_OUTDATED:"1104",ML_TRAIN_EMPTY:"1105"}}(u||(u={})),t.a=c},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(8);n.d(t,"a",function(){return u});var l=function(){function e(t,n,i,a){o()(this,e),this.$timeout=t,this.$mdDialog=n,this.OauthData=i,this.googleAssistantPersistence=a,this.viewState={isLoading:!1}}return e.$inject=["$timeout","$mdDialog","OauthData","googleAssistantPersistence"],r()(e,[{key:"$onInit",value:function(){}},{key:"cancelDialog",value:function(){this.$mdDialog.cancel()}},{key:"closeDialog",value:function(){this.$mdDialog.hide()}},{key:"authorizeGCP",value:function(){var e=this;this.OauthData.authorize("google_gcp").then(this.googleAssistantPersistence.incrementalAuthCallback).then(function(){return e.$timeout(function(){return e.viewState.isLoading=!1})}).then(this.closeDialog.bind(this)).catch(function(t){e.$timeout(function(){return e.viewState.isLoading=!1}),s.a.stdErrorSkipIfEmpty(t).catch(angular.noop)})}}]),e}(),u={bindings:{},template:n(345),controller:l,controllerAs:"vm"}},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(8);n.d(t,"a",function(){return u});var l=function(){function e(t,n,i,a,r,s,l,u){var c=this;o()(this,e),this.$mdDialog=t,this.AgentData=n,this.CurrentAgentService=i,this.$timeout=a,this.batchPersistence=r,this.CurrentUser=s,this.BreadcrumbsService=l,this.$state=u,this.isLoading=!1,this.success=!1,this.selectedAgentId=null,this.additionalParams={copyEntities:!0,overwriteEntities:!1,overwriteIntents:!1},this.currentAgent=i.getCurrentAgent(),n.cacheAgents().then(function(e){c.agentList=e.data.agents.filter(function(e){return e.id!==c.currentAgent.id}).sort(function(e,t){return e.name<t.name?-1:1})})}return e.$inject=["$mdDialog","AgentData","CurrentAgentService","$timeout","batchPersistence","CurrentUser","BreadcrumbsService","$state"],r()(e,[{key:"$onInit",value:function(){}},{key:"closeDialog",value:function(){this.$mdDialog.hide()}},{key:"getLiteral",value:function(){return"intent"===this.subject?"intents":"entities"}},{key:"perform",value:function(){var e=this;if(this.isLoading=!0,null==this.selectedAgentId||!this.batchOperationIds||!this.batchOperationIds.length)return void console.log("error performing batch operation");this.batchPersistence.moveCopyBatchRequest(this.batchOperationIds,this.selectedAgentId,this.batchOperation,this.subject,this.additionalParams).then(function(){return e.success=!0}).finally(function(){e.$timeout(function(){return e.isLoading=!1})})}},{key:"goToAgent",value:function(){var e=this;this.$mdDialog.hide(),this.AgentData.cacheAgents().then(function(t){var n=t.data.agents.find(function(t){return t.id===e.selectedAgentId});n||s.a.error("Agent was not found"),e.CurrentUser.setKey(e.currentAgent.primaryKey,n.id),e.CurrentAgentService.setCurrentAgent(null,!0),e.BreadcrumbsService.updateDropdown(),e.$state.go("auth.workPlace.agent.intent_list",{agentId:n.id})})}}]),e}(),u={bindings:{batchOperationIds:"<",batchOperation:"@",subject:"@"},controller:l,template:n(346),controllerAs:"vm"}},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(21),h=n(8);n.d(t,"a",function(){return f});var p=function(e){function t(e,n,i,a,s,l){r()(this,t);var u=c()(this,(t.__proto__||o()(t)).call(this));return u.$http=e,u.OauthData=n,u.LoginData=i,u.LoginService=a,u.OauthLoginService=s,u.urls=l,u.agentNames=[],u.viewState={started:!1,finished:!1,isPasswordEnabled:!1,isAnyNetworkPresent:!1},u}return t.$inject=["$http","OauthData","LoginData","LoginService","OauthLoginService","urls"],m()(t,e),l()(t,[{key:"$onInit",value:function(){this.isNetworkPresent=this.OauthLoginService.isNetworkPresent,this.viewState.isAnyNetworkPresent=this.OauthLoginService.isNetworkPresent("facebook")||this.OauthLoginService.isNetworkPresent("slack")||this.OauthLoginService.isNetworkPresent("github"),this.viewState.isPasswordEnabled=this.urls.passwordEnabled}},{key:"start",value:function(){var e=this;this.showLoading().then(function(){return e.$http.post(e.urls.usersUrls.cleanToken,null)}).then(function(){return e.viewState.started=!0}).catch(h.a.stdErrorNoReject).then(function(){return e.hideLoading()})}},{key:"oauthLogin",value:function(e){return this.showLoading(),this.OauthData.authorize(e).then(this.OauthData.login).then(this.retrieveOAuthToken.bind(this)).then(this.getInfo.bind(this)).catch(h.a.stdErrorNoReject).then(this.hideLoading.bind(this))}},{key:"passwordLogin",value:function(e,t){var n=this;this.showLoading().then(function(){return n.LoginData.login(e,t)}).then(this.retrievePasswordToken.bind(this)).then(this.getInfo.bind(this)).catch(function(e){h.a.error(e.data.error_description)}).then(this.hideLoading.bind(this))}},{key:"retrievePasswordToken",value:function(e){this.token=e.data.access_token}},{key:"retrieveOAuthToken",value:function(e){this.token=e.data.token}},{key:"getInfo",value:function(){var e=this;return this.$http.get("/api-client/retrieveAccess/userInfo",{headers:{Authorization:"Bearer "+this.token}}).then(function(t){if(e.currentUser=t.data.username,e.agentNames=t.data.agentNames?t.data.agentNames:[],t.data.isTestingInfoAvailable)return e.continueLogin()}).catch(function(t){h.a.stdError(t),e.clear()})}},{key:"connect",value:function(){var e=this;return this.showLoading().then(function(){return e.OauthData.authorize("google")}).then(function(t){return e.$http.post("/api-client/retrieveAccess/connect",t,{headers:{Authorization:"Bearer "+e.token}})}).then(function(){e.viewState.finished=!0}).catch(h.a.stdErrorSkipIfEmpty).catch(angular.noop).then(function(){return e.hideLoading()})}},{key:"clear",value:function(){this.currentUser=null,this.token=null,this.agentNames=[]}},{key:"continueLogin",value:function(){return this.LoginService.onLoginSuccess(this.currentUser,{data:{access_token:this.token}})}}]),t}(g.a);n(372);var f={bindings:{},template:n(348),controller:p,controllerAs:"vm"}},function(e,t,n){"use strict";var i=n(0),o=n.n(i);n(373);var a={bindings:{message:"@"},template:n(349),controller:r,controllerAs:"vm"};t.a=a;var r=function e(){o()(this,e)}},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return l});var s=function(){function e(t,n){o()(this,e),this.$scope=t,this.$sce=n}return e.$inject=["$scope","$sce"],r()(e,[{key:"getTrustHTML",value:function(){return this.$sce.trustAsHtml(this.notice.message)}},{key:"dismiss",value:function(){this.notice.wasShown=!0}}]),e}();n(374);var l={bindings:{notice:"="},controller:s,controllerAs:"vm",template:n(350)}},function(e,t,n){"use strict";var i=n(0),o=n.n(i);n.d(t,"a",function(){return r});var a=function e(){o()(this,e)};n(375);var r={controller:a,controllerAs:"vm",bindings:{notifications:"="},template:n(351)}},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(21);n.d(t,"a",function(){return p});var h=function(e){function t(e,n){r()(this,t);var i=c()(this,(t.__proto__||o()(t)).call(this));return i.googleAssistantPersistence=e,i.$mdDialog=n,i}return t.$inject=["googleAssistantPersistence","$mdDialog"],m()(t,e),l()(t,[{key:"$onInit",value:function(){}},{key:"acceptTos",value:function(){this.googleAssistantPersistence.acceptTerms(),this.$mdDialog.hide()}}]),t}(g.a),p={bindings:{},controller:h,template:n(352),controllerAs:"vm"}},,function(e,t,n){"use strict";var i=n(20),o=angular.module("api.smalltalk",[]).config(["$stateProvider","$compileProvider",function(e,t){"ngInject";e.state("auth.workPlace.agent.smalltalk",{url:"/smalltalk",views:{agent:{templateProvider:function(){return i.a.handleComponentLazyLoad(n.e(5).then(n.bind(null,388)),i.a.COMPONENT.SMALLTALK,'<smalltalk domains-list="domainsList" smalltalk-map="smalltalkV1V2Map"></smalltalk>',t)},controller:["$scope","domainsList","smalltalkV1V2Map",function(e,t,n){e.domainsList=t,e.smalltalkV1V2Map=n}],resolve:{domainsList:["$http","urls","CurrentAgentService","domainDataService",function(e,t,n,i){var o=n.getCurrentLanguage().toString();return i.loadDomainsConfig(o)}],smalltalkV1V2Map:["domainDataService",function(e){return e.getSmalltalkV1V2Map().then(function(e){return e.data})}]}}},data:{activeTab:"smalltalk",headerConfig:{label:'<em class="ico"><span class="flaticon stroke chat-3"></span></em>Small Talk',model:!1,navButton:{}}}})}]);t.a=o},function(e,t,n){"use strict";var i=n(20);n.d(t,"a",function(){return o});var o=angular.module("api.support",[]).config(["$stateProvider","$compileProvider",function(e,t){"ngInject";e.state("auth.workPlace.support",{url:"/support",views:{workplace:{templateProvider:function(){return i.a.handleComponentLazyLoad(n.e(7).then(n.bind(null,389)),i.a.COMPONENT.SUPPORT,'<support agent-list="agentList"></support>',t)},controller:["$scope","agentList",function(e,t){e.agentList=t.sort(function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})}],resolve:{agentList:["AgentData",function(e){return e.cacheAgents().then(function(e){return e.data.agents})}]}},control:{templateUrl:"partials/mainscreen/control-panel.html",controller:"ControlController"}},data:{activeTab:"support",headerConfig:{label:'<em class="ico"><span class="flaticon stroke help-2"></span></em>Support',model:!1,navButton:{}}}})}])},function(e,t,n){"use strict";var i=n(89),o=n(353);n(376);var a={bindings:{cloudFunctionsEnabled:"<",cloudProjectId:"<",lookbackMinutes:"<"},template:o,controller:i.a,controllerAs:"vm"};t.a=a},function(e,t,n){"use strict";var i=n(20),o=angular.module("api.training",["api.interactions","api.other"]).config(["$stateProvider","$urlRouterProvider","$compileProvider","urls",function(e,t,o,a){"ngInject";t.otherwise("/"),e.state("auth.workPlace.agent.training",{url:"/training",views:{agent:{templateProvider:function(){return i.a.handleComponentLazyLoad(n.e(3).then(n.bind(null,391)),i.a.COMPONENT.TRAINING,'<training conversations="conversations"></training>',o)},controller:["$scope","autocompleteLists",function(e,t){}],resolve:{autocompleteLists:["AutocompleteData",function(e){return e.listAutocomplete().then(function(e){return e})}]}}},data:{activeTab:"training",headerConfig:{label:'<em class="ico"><span class="flaticon stroke training-menu topmenu"></span></em>Training',model:!1,navButton:{items:[{label:"Upload",sref:"auth.workPlace.agent.interactions_upload"}]}}}}).state("auth.workPlace.agent.interactions_upload",{url:"/uploadInteractions",views:{agent:{templateUrl:"partials/interactions_upload.html",controller:"UploadController",resolve:{uploadType:function(){return"interaction"},uploadUrl:function(){return a.apiUrls.interactions},goBackState:function(){return"auth.workPlace.agent.training"}}}},data:{headerConfig:{form:!1,label:'<em class="ico"><span class="flaticon stroke thinking-comment-2"></span></em>Upload logs file'}}})}]);t.a=o},function(e,t,n){"use strict";var i=n(205),o=angular.module("api.whitelist",["api.other"]).config(["$stateProvider",function(e){"ngInject";e.state("auth.whitelist",{url:"/whitelist",views:{auth:{template:"<whitelist></whitelist>",controller:["$scope",function(e){}]}}})}]).component("whitelist",i.a);t.a=o},,,,,function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=function(){function e(t){o()(this,e),this.apiConfig=t,this.textsCache={}}return e.$inject=["apiConfig"],r()(e,[{key:"getEntrySynonymsNumber",value:function(){var e=this.apiConfig.getLimits();return e.enableAgentLimits?e.entrySynonymsNumber:void 0}},{key:"getTextResponsesNumber",value:function(){var e=this.apiConfig.getLimits();return e.enableAgentLimits?e.textResponsesNumber:void 0}},{key:"getParamPromptsNumber",value:function(){var e=this.apiConfig.getLimits();return e.enableAgentLimits?e.paramPromptsNumber:void 0}},{key:"getTextLength",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.apiConfig.getLimits();return n&&!i.enableAgentLimits?void 0:i[e.TEXT_LIMITS[t]]}},{key:"isLimitExceeded",value:function(t,n){var i=this.apiConfig.getLimits();return(e.PROFILE_ENTRIES.indexOf(t)>-1?i.enableProfileLimits:i.enableAgentLimits)&&n>=i[e.ENTRIES[t].prop]}},{key:"isConstLimitExceeded",value:function(t,n){return n>=this.apiConfig.getLimits()[e.ENTRIES[t].prop]}},{key:"getLimitsTitle",value:function(){return e.LIMITS_TITLE}},{key:"getReadOnlyAlertTexts",value:function(){return{title:e.READ_ONLY_TITLE,message:e.READ_ONLY_MESSAGE}}},{key:"getText",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.textsCache[t];if(angular.isUndefined(i)){var o=e.ENTRIES[t];i=this.buildLimitHtml(o.text,this.apiConfig.getLimits()[o.prop],n),this.textsCache[t]=i}return i}},{key:"clearTextsCache",value:function(){this.textsCache={}}},{key:"buildLimitHtml",value:function(t,n){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return"The number of "+t+" has reached the limit of "+n+'. \n                <a target="_blank" href='+e.GOOGLE_ASSISTANT_LIMITS_URL+">Learn more</a> \n                about configuration limits.";var i=this.apiConfig.getSupportEmail();return"The number of "+t+" has reached the limit of "+n+'.\n                Email us at <a class="link" href="mailto:'+i+"?Subject="+e.EMAIL_SUBJECT+'">'+i+"</a>\n                 for higher quota."}}]),e}();t.a=s,s.EMAIL_SUBJECT="Request for higher quota",s.LIMITS_TITLE="Limit exceeded",s.READ_ONLY_TITLE="Insufficient permissions",s.READ_ONLY_MESSAGE="You do not have rights for this operation.",s.GOOGLE_ASSISTANT_LIMITS_URL="https://developers.google.com/actions/develop/apiai/agents-and-actions#configuration_limits",s.PROFILE_ENTRIES=["agents"],s.ENTRIES={agents:{text:"agents per user",prop:"agentsNumber"},userSays:{text:"examples per intent",prop:"userSaysNumber"},intents:{text:"intents",prop:"intentsNumber"},intentParams:{text:"parameters per intent",prop:"intentParamsNumber"},inputContexts:{text:"input contexts per intent",prop:"inputContextsNumber"},outputContexts:{text:"output contexts per intent",prop:"outputContextsNumber"},entities:{text:"entities",prop:"entitiesNumber"},entries:{text:"entries per entity",prop:"entityEntriesNumber"},GAIntents:{text:"intents",prop:"googleIntentsNumber"},GASuggestionChips:{text:"suggestion chips",prop:"googleSuggestionChipsNumber"},GAListCardItems:{text:"list card items",prop:"googleListCardItemsNumber"},GACustomPayloads:{text:"custom payloads",prop:"googleCustomPayloadsNumber"}},s.TEXT_LIMITS={agentDescription:"agentDescriptionLength",userSays:"userSaysTextLength",entry:"entryValueLength",intent:"intentNameLength",entity:"entityNameLength",action:"actionNameLength",context:"contextNameLength",param:"paramNameLength",textResponse:"textResponseLength",promptsItem:"maxShowPromptsLength",selectorItem:"maxSelectorItemLength",GASuggestion:"googleSuggestionTextLength",url:"urlLength",quickReply:"quickReplyLength"}},function(e,t,n){"use strict";var i=n(164),o=n(165),a=n(166),r=n(167),s=n(168),l=n(170),u=n(171),c=n(172),d=n(160),m=n(169),g=n(228);n.d(t,"a",function(){return h});var h=angular.module("api.agent.components",[]);h.component("agentAvatar",i.a).component("agentShare",u.a).component("agentSample",l.a).component("agentDeepLink",o.a).component("agentDeepLinkSelector",r.a).component("agentDeepLinkPopup",a.a).component("agentLangs",s.a).component("controlPanelLangSwitcher",c.a).component("agentRuntimes",m.a).service("runtimePersistence",g.a).service("googleProjectLinksManager",d.a)},function(e,t,n){"use strict";var i=n(203),o=n(198),a=n(195),r=n(197),s=n(185),l=n(194),u=n(193),c=n(186),d=n(187),m=n(191),g=n(192),h=n(189),p=n(188),f=n(190),v=n(183),b=n(181),y=n(180),k=n(200),A=n(201),S=n(179);n.d(t,"a",function(){return w});var w=angular.module("api.intent.components",[]);w.component("jsonEditor",i.a).component("intentRichResponse",new o.a).component("intentResponseContent",new a.a).component("intentTextResponse",r.a).component("intentCardResponse",s.a).component("intentQuickResponse",l.a).component("intentImageResponse",u.a).component("intentCustomResponse",c.a).component("intentBasicCardResponse",d.a).component("intentListCardResponse",m.a).component("intentSuggestionChipsResponse",g.a).component("intentChatBubbleResponse",h.a).component("intentCarouselCardResponse",p.a).component("intentLinkOutChipResponse",f.a).component("intentUserSaysEditor",v.a).component("intentFollowupIntents",new b.a).component("intentEvents",y.a).component("intentContexts",S.a).component("intentWebhook",k.a).component("intentsListItem",new A.a)},function(e,t,n){"use strict";var i=n(218),o=n(219),a=n(220),r=n(222),s=n(221),l=n(223),u=n(224),c=n(225),d=n(226),m=n(227),g=n(229),h=n(230);n.d(t,"a",function(){return p});var p=angular.module("api.persistence",["api.security"]);p.service("autoMarkupPersistence",a.a).service("googleAssistantPersistence",c.a).service("IntentData",d.a).service("EntityData",u.a).service("AgentData",i.a).service("UsersData",g.a).service("apiConfig",o.a).service("InteractionsData",m.a).service("domainDataService",l.a).service("batchPersistence",s.a).service("WhitelistData",h.a).service("CloudFunctionsPersistence",r.a)},function(e,t,n){"use strict";var i=n(63),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(155),c=n(212),d=function(){function e(){var t;r()(this,e),this.numberFormatter={format:function(e){return u.a.shortenNumber(e,1)}},this.periodMsg=(t={},o()(t,c.a.Period.DAILY,"Daily"),o()(t,c.a.Period.MONTHLY,"Monthly"),o()(t,c.a.Period.WEEKLY,"Weekly"),t)}return l()(e,[{key:"getChartOptions",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=[],i=0;i<t;i++)n.push({color:e.BASIC_COLOR_CURRENT}),n.push({color:e.BASIC_COLOR_HISTORY,lineDashStyle:[2,3]});return{chartArea:{width:"100%",height:"100%"},hAxis:{baselineColor:"transparent",gridlines:{color:"transparent",count:-1,units:{days:{format:["MM/dd"]},hours:{format:["HH:mm","ha"]}}},textStyle:{color:"#9e9e9e",fontSize:12}},lineWidth:2,vAxis:{textStyle:{color:"#9e9e9e",fontSize:11},viewWindow:{min:0},baselineColor:"#d6d6d6",gridlines:{color:"#d6d6d6"},format:"short"},series:n,tooltip:{isHtml:!0},legend:{position:"none"},focusTarget:"category"}}},{key:"getPlatforms",value:function(){return e.PLATFORMS}}]),e}();d.PLATFORMS=[{name:"All platforms",value:"undefined"},{name:"Google",value:"google"},{name:"Facebook",value:"facebook"},{name:"Kik",value:"kik"},{name:"Slack",value:"slack"},{name:"Slack Testbot",value:"slack_testbot"},{name:"Line",value:"line"},{name:"Skype",value:"skype"},{name:"Spark",value:"spark"},{name:"Telegram",value:"telegram"},{name:"Tropo",value:"tropo"},{name:"Twilio",value:"twilio"},{name:"Twilio IP",value:"twilio-ip"},{name:"Twitter",value:"twitter"}],d.BASIC_COLOR_CURRENT="#36a0e1",d.BASIC_COLOR_HISTORY="#77d1f9",d.WEEKLY_COLOR_CURRENT="#36a0e1",d.WEEKLY_COLOR_HISTORY="#77d1f9",d.DAILY_COLOR_CURRENT="#36a0e1",d.DAILY_COLOR_HISTORY="#77d1f9",d.MONTHLY_COLOR_CURRENT="#36a0e1",d.MONTHLY_COLOR_HISTORY="#77d1f9",t.a=d},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(8),l=n(13),u=n(27),c=n(32),d=n(232);n.d(t,"a",function(){return m});var m=function(){function e(t,n,i,a,r,s,u,c,m,g){o()(this,e),this.$q=t,this.$interval=n,this.$timeout=i,this.AgentData=a,this.CurrentUser=r,this.IntentData=s,this.AutocompleteData=u,this.AnalyticsService=c,this.apiConfig=m,this.limitsManager=g,this.poller=null,this.currentAgent=null,this.currentKey=null,this.currentLanguage={},this.currentRole=e.ROLE_PENDING,this.loadSettingsPromiseWrapper={agentId:null,promise:null,onLoadCallbacks:[]},l.a.subscribe(l.a.DEFINED_EVENTS.AGENT_DATA_UPDATE,this.onAgentDataUpdate.bind(this)),l.a.subscribe(l.a.DEFINED_EVENTS.CURRENT_AGENT_CHANGED,this.loadAgentSettings.bind(this)),this.poller=new d.a(n,i,a,c,this,r)}return e.$inject=["$q","$interval","$timeout","AgentData","CurrentUser","IntentData","AutocompleteData","AnalyticsService","apiConfig","limitsManager"],r()(e,[{key:"updateCurrentAgentFromServer",value:function(){var e=this;return this.AgentData.getAgent(this.getId()).then(function(t){return t.data&&t.data.agent?(t.data.agent=new u.a(t.data.agent),e.setCurrentAgent(t.data.agent),e.$q.resolve(t)):e.$q.reject(t)})}},{key:"updateCurrentAgent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.setCurrentAgent(e,t)}},{key:"setCurrentAgent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.currentAgent=e||null,t&&(this.IntentData.invalidateIntentsCache(),this.AutocompleteData.invalidateAutocomplete())}},{key:"getCurrentAgent",value:function(){var t=this,n=this.CurrentUser.getKey();if(this.currentAgent&&this.currentKey===n)return this._returnAgentWrapper(this.currentAgent);this.currentKey=n;var i=this.AgentData.cacheAgentsAr(),o=this.findAgent(i,function(i){return t.keyIsSuperuser(t.currentKey)?i.id===t.currentKey.substr(e.SUPERUSER_TAG.length):i.id===n});return o?(o=this._returnAgentWrapper(o),this.currentAgent=o,o):!o&&Array.isArray(i)&&i.length?(this.currentAgent=i[0],this.currentKey=this.currentAgent.id,this._returnAgentWrapper(i[0])):null}},{key:"getCurrentAgentAsync",value:function(){var e=this,t=this.$q.defer();return this.AgentData.cacheAgents().finally(function(){t.resolve(e.getCurrentAgent())}),t.promise}},{key:"keyIsSuperuser",value:function(t){return t&&0===t.indexOf(e.SUPERUSER_TAG)}},{key:"findAgent",value:function(e,t){return e.find(t)}},{key:"useCustomClassifier",value:function(){var e=this.getCurrentAgent();return!!e&&e.useCustomClassifier}},{key:"intentParamsAutoSync",value:function(){var e=this.getCurrentAgent();return!!e&&e.intentParamsAutoSync}},{key:"getSecondaryKey",value:function(){var e=this.getCurrentAgent();return e?e.secondaryKey:null}},{key:"getPrimaryKey",value:function(){var e=this.getCurrentAgent();return e?e.primaryKey:null}},{key:"getId",value:function(){var e=this.getCurrentAgent();return e?e.id:null}},{key:"getLanguage",value:function(){var e=this.getCurrentAgent();return e&&e.language?e.language:null}},{key:"getLanguageAsString",value:function(){var e=this.getCurrentAgent();return e&&e.language?e.language.toString().toLowerCase():null}},{key:"getTrainingStatus",value:function(){return this.poller.getTrainingStatus()}},{key:"setTrainingStatus",value:function(e){return this.poller.setTrainingStatus(e)}},{key:"startIsAgentInTrainingPolling",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.poller.startIsAgentInTrainingPolling(e)}},{key:"checkTrainingStatus",value:function(){return this.poller.checkTrainingStatus()}},{key:"publishAgent",value:function(){return this.AgentData.publishAgent(this.getCurrentAgent()).then(function(){return s.a.info("Agent published")}).catch(s.a.stdError)}},{key:"onAgentUploadSuccess",value:function(){return l.a.publish(l.a.DEFINED_EVENTS.AGENT_UPLOAD_SUCCESS),this.setCurrentAgent(null),this.AgentData.clearCacheAgentsAr()}},{key:"checkOwned",value:function(){var t=this,n=this.$q.defer(),i=function(){n.resolve("ROLE_OWNER"===t.currentRole||"ROLE_AGENT_ADMIN"===t.currentRole)};return this.currentRole===e.ROLE_PENDING?this.loadSettingsPromiseWrapper.onLoadCallbacks.push(i):i(),n.promise}},{key:"checkReadOnly",value:function(){var t=this,n=this.$q.defer(),i=function(){n.resolve("ROLE_AGENT_REVIEWER"===t.currentRole)};return this.currentRole===e.ROLE_PENDING?this.loadSettingsPromiseWrapper.onLoadCallbacks.push(i):i(),n.promise}},{key:"waitForAgentSettings",value:function(){return this.loadSettingsPromiseWrapper.promise||this.$q.resolve()}},{key:"getCurrentLanguage",value:function(){var e=this.getCurrentAgent();if(e){var t=this.currentLanguage[this.getId()];return t&&e.getSupportedLanguages().some(function(e){return e===t})?t:(this.setCurrentLanguage(e.language),e.language)}return c.a.SupportedLanguages.UNSPECIFIED}},{key:"getCurrentRootLanguageString",value:function(){var e=this.getCurrentLanguage().toString().split("-");return e&&e[0]?e[0]:this.getCurrentLanguage().toString()}},{key:"setCurrentLanguage",value:function(e){return this.getCurrentAgent().getSupportedLanguages().some(function(t){return t===e})&&(this.currentLanguage[this.getId()]=e),this}},{key:"_returnAgentWrapper",value:function(e){try{if("Agent"===e.constructor.name)return e;throw new Error}catch(t){return new u.a(e)}}},{key:"onAgentDataUpdate",value:function(e,t){var n=this.getCurrentAgent();if(n&&_.has(t,"subject")&&_.has(t,"event"))switch(t.subject){case"intent":"created"===t.event?n.intentCount+=1:"removed"===t.event&&(n.intentCount-=_.has(t,"count")?t.count:1);break;case"entity":"created"===t.event?n.entityCount+=1:"removed"===t.event&&(n.entityCount-=_.has(t,"count")?t.count:1)}}},{key:"loadAgentSettings",value:function(t,n){var i=this;this.poller.stopIsAgentInTrainingPolling(),this.poller.setTrainingStatus(!1),this.poller.checkTrainingStatus(),this.loadSettingsPromiseWrapper.agentId!==n&&(this.loadSettingsPromiseWrapper.promise&&(this.loadSettingsPromiseWrapper.promise=null),this.currentRole=e.ROLE_PENDING,this.loadSettingsPromiseWrapper.agentId=n,this.loadSettingsPromiseWrapper.promise=this.AgentData.getSecuritySettings().then(function(e){i.loadSettingsPromiseWrapper.agentId===n&&(i.currentRole=e.role,_.assign(i.apiConfig.getLimits(!0),e.limitsConfig),i.limitsManager.clearTextsCache())}).catch(angular.noop).then(function(){i.loadSettingsPromiseWrapper.agentId===n&&(i.loadSettingsPromiseWrapper.agentId=null,i.loadSettingsPromiseWrapper.promise=null,i.loadSettingsPromiseWrapper.onLoadCallbacks&&(i.loadSettingsPromiseWrapper.onLoadCallbacks.forEach(function(e){return e()}),i.loadSettingsPromiseWrapper.onLoadCallbacks=[]))}))}}]),e}();m.SUPERUSER_TAG="superuser",m.ROLE_PENDING="PENDING"},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(13);n.d(t,"a",function(){return l});var l=function(){function e(t,n,i,a){o()(this,e),this.$cookies=t,this.uuid=n,this.AnalyticsService=i,this.urls=a}return e.$inject=["$cookies","uuid","AnalyticsService","urls"],r()(e,[{key:"setUser",value:function(e){this.setCurrentUserEmail(e)}},{key:"getUser",value:function(){return this.getCurrentUserEmail()}},{key:"setCurrentUserEmail",value:function(t){this.currentUserEmail=t,this.$cookies.putObject("currentUser",t,e.COOKIES_OPT)}},{key:"getCurrentUserEmail",value:function(){return this.currentUserEmail||(this.currentUserEmail=this.$cookies.getObject("currentUser")),this.currentUserEmail}},{key:"clear",value:function(){this.AnalyticsService.reset(),this.setCurrentUserEmail(null),this.profile=null,this.agentKey=null,this.sessionId=null}},{key:"setProfile",value:function(e){if(this.profile=e,this.profile.planId&&!this.profile.planName){var t=this.profile.planId.split("_")[0];this.profile.planName=_.capitalize(t)}}},{key:"getProfile",value:function(){return this.profile}},{key:"setPlan",value:function(t){var n=this.getCurrentUserEmail();n&&this.$cookies.putObject("userProfile:"+n,t,e.COOKIES_OPT)}},{key:"setUserToken",value:function(e){this.userAccessToken=e}},{key:"getUserToken",value:function(){return this.userAccessToken}},{key:"setKey",value:function(t,n){var i=t;this.isSuperuser(this.getCurrentUserEmail().toLowerCase())&&(i="superuser"+t);var o=this.agentKey!==i;if(this.agentKey=i,n){var a=this.getCurrentUserEmail();a&&this.$cookies.putObject("currentAgentId:"+a.split("@").join("_"),n,e.COOKIES_OPT)}o&&s.a.publish(s.a.DEFINED_EVENTS.CURRENT_AGENT_CHANGED,n)}},{key:"isSuperuser",value:function(e){return e&&0===e.indexOf("superuser-")}},{key:"getKey",value:function(){return this.agentKey}},{key:"getCurrentAgentId",value:function(){var e=this.getCurrentUserEmail();return e?this.$cookies.getObject("currentAgentId:"+e.split("@").join("_")):null}},{key:"dropKey",value:function(){this.agentKey=null;var e=this.getCurrentUserEmail();this.$cookies.remove("currentAgentId:"+e.split("@").join("_"))}},{key:"getSessionId",value:function(){if(!this.sessionId){var t=this.getCurrentUserEmail();if(t&&(this.sessionId=this.$cookies.getObject("sessionId:"+t),!this.sessionId)){var n=new Array(16);this.uuid.v4(null,n,0),this.sessionId=this.uuid.unparse(n),this.$cookies.putObject("sessionId:"+t,this.sessionId,e.COOKIES_OPT),console.log("New sessionId generated: ",this.sessionId)}}return this.sessionId}}]),e}();l.COOKIES_OPT={secure:"https:"===window.location.protocol,expires:new Date(_.now()+6048e5)}},function(e,t,n){"use strict";var i=n(84),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(79),c=n(13),d=n(17),m=function(){function e(t){r()(this,e),this.CurrentAgentService=t,this.intentParamsList=[],this.userSaysList=[],this.userSaysParameterStorage=[]}return e.$inject=["CurrentAgentService"],l()(e,[{key:"subscribeAll",value:function(e){var t=this;this.enabled()&&(this.intentParamsList=e.intentParamsList,this.userSaysList=e.userSaysList,this.userSaysParameterStorage=[],this.userSaysList.forEach(function(e){t.userSaysParameterStorage.push(t.getParametersFromUserSays(e))}),this.bindParamsToUserSays(),this.removeOutdatedParams())}},{key:"subscribe",value:function(e){this.enabled()&&(this.userSaysParameterStorage.splice(e,0,[]),this.userSaysParameterStorage[e]=this.getParametersFromUserSays(this.userSaysList[e]))}},{key:"unsubscribeAll",value:function(){this.intentParamsList=[],this.userSaysList=[],this.userSaysParameterStorage=[]}},{key:"unsubscribe",value:function(e){this.userSaysParameterStorage.splice(e,1),this.removeOutdatedParams()}},{key:"userSaysParamChanged",value:function(e,t,n,i,o){if(this.enabled()){for(var a=!(null!==i||null!==n),r=!1,s=!1,l=!1,u=!1,m=0,g=0,h=0;h<this.userSaysParameterStorage[o].length;h++){var p=this.userSaysParameterStorage[o][h];if(p.alias===n&&p.meta===i&&m++,p.alias===e&&p.meta===t&&g++,m>0&&g>1)break}m>0&&(l=!0),g>1&&(u=!0);for(var f=0;f<this.userSaysParameterStorage.length;f++){for(var v=0;v<this.userSaysParameterStorage[f].length;v++)if(o!==f){var b=this.userSaysParameterStorage[f][v];if(b.alias===n&&b.meta===i&&(r=!0),b.alias===e&&b.meta===t&&(s=!0),s&&r)break}if(s&&r)break}if(!l&&!r&&u){var y=this.getCorrespondingIntentParamIndexByAliasAndMeta(n,i);y>=0&&this.intentParamsList.splice(y,1)}if(l&&!s)this.createOrBindIntentParam(e,t);else if(a&&!s)this.createOrBindIntentParam(e,t);else if(r&&!s)this.createOrBindIntentParam(e,t);else if(!a&&!s){var k=this.getCorrespondingIntentParamIndexByAliasAndMeta(n,i);k>=0&&this.updateIntentParam(e,t,k)}if(s&&!r){var A=this.getCorrespondingIntentParamIndexByAliasAndMeta(n,i);A>=0&&this.intentParamsList.splice(A,1)}if(t!==d.b.IGNORE&&e){this.checkDuplicates(this.userSaysParameterStorage[o],e,t)&&this.setParamsIsList(t,e)}c.a.publish("updateAlias",this.userSaysList),c.a.publish("userSaysParamUpdate")}}},{key:"updateUserSaysParams",value:function(e,t){this.enabled()&&(this.userSaysParameterStorage[e]=t,this.bindParamsToUserSays(),this.removeOutdatedParams(),this.setIsListOnDuplicatedParams(this.userSaysParameterStorage[e]),c.a.publish("userSaysParamUpdate"))}},{key:"bindParamsToUserSays",value:function(){for(var e=[].concat.apply([],this.userSaysParameterStorage),t=0;t<e.length;t++){var n=e[t],i=this.checkDuplicates(e,n.alias,n.meta);this.createOrBindIntentParam(n.alias,n.meta,i)}}},{key:"broadcastReplaceParameter",value:function(e,t,n,i){for(var o={name:e,dataType:n},a={name:t,dataType:i},r=0;r<this.userSaysList.length;r++){var s=d.a.broadReplaceParamsForTemplate(this.userSaysList[r],a,o,this.userSaysParameterStorage[r]);this.userSaysList[r].data=s.data}c.a.publish("updateView"),c.a.publish("updateAlias",this.userSaysList)}},{key:"getIntentParams",value:function(){return this.intentParamsList}},{key:"setIntentParams",value:function(e){this.intentParamsList=e}},{key:"moveUpUserSays",value:function(e,t){this.userSaysList.splice(t,0,this.userSaysList.splice(e,1)[0]),this.userSaysParameterStorage.splice(t,0,this.userSaysParameterStorage.splice(e,1)[0])}},{key:"enabled",value:function(){return this.CurrentAgentService.intentParamsAutoSync()}},{key:"getParametersFromUserSays",value:function(e){return d.a.getParametersFromTemplate(e)}},{key:"setParamsIsList",value:function(e,t){this.intentParamsList.forEach(function(n){n.name===t&&n.dataType===e&&n.auto&&(n.isList=!0)})}},{key:"checkDuplicates",value:function(e,t,n){return _.countBy(e,function(e){return e.alias===t&&e.meta===n}).true>1}},{key:"setIsListOnDuplicatedParams",value:function(e){var t=!0,n=!1,i=void 0;try{for(var a,r=o()(e);!(t=(a=r.next()).done);t=!0){var s=a.value,l=this.checkDuplicates(e,s.alias,s.meta);if(l){var u=this.getCorrespondingIntentParamIndexByAliasAndMeta(s.alias,s.meta);u>=0&&this.updateIntentParam(s.alias,s.meta,u,l)}}}catch(e){n=!0,i=e}finally{try{!t&&r.return&&r.return()}finally{if(n)throw i}}}},{key:"removeOutdatedParams",value:function(){var e=this;if(this.enabled()){var t=[].concat.apply([],this.userSaysParameterStorage),n=[];this.intentParamsList.forEach(function(e,i){e.auto&&(e.dataType!==d.b.IGNORE&&t.some(function(t){return(t.alias?t.alias:"")===(e.name?e.name:"")&&t.meta===e.dataType})||n.push(i))});var i=0;n.forEach(function(t){e.intentParamsList.splice(t-i,1),i++})}}},{key:"getCorrespondingIntentParamIndexByAliasAndMeta",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.intentParamsList.findIndex(function(i){return n?!0===i.auto&&i.name===e&&i.dataType===t:i.name===e&&i.dataType===t})}},{key:"createOrBindIntentParam",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(n!==d.b.IGNORE&&void 0!==t&&!this.bindParameterIfExists(t,n)){var o=new u.a;o.name=t,o.dataType=n,o.value=e.buildValue(t),o.auto=!0,!0!==i&&!1!==i||(o.isList=i);var a=this.lastParamEmpty()?this.intentParamsList.length-1:this.intentParamsList.length;this.intentParamsList.splice(a,0,o)}}},{key:"bindParameterIfExists",value:function(t,n){var i=!1,o=this.getCorrespondingIntentParamIndexByAliasAndMeta(t,n,!1);if(o>=0){var a=this.intentParamsList[o],r=e.buildValue(t);a.value?(e.isValuesEquals(a.value,r)&&(a.auto=!0,i=!0),e.splitValueAndModifier(a)):(a.auto=!0,a.value=r,i=!0)}return i}},{key:"updateIntentParam",value:function(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if(n===d.b.IGNORE)return void this.intentParamsList.splice(i,1);this.intentParamsList[i].dataType=n,this.intentParamsList[i].name=t,this.intentParamsList[i].auto=!0,this.intentParamsList[i].value=e.buildValue(t),!0!==o&&!1!==o||(this.intentParamsList[i].isList=o)}},{key:"lastParamEmpty",value:function(){var e=this.intentParamsList[this.intentParamsList.length-1];return _.isEmpty(e)}}],[{key:"splitValueAndModifier",value:function(e){if(e.value&&e.auto){var t=e.value,n=t.split(".");n.length<2||(e.value=n.splice(0,1)[0],e.valueModifier=n.join("."))}}},{key:"isValuesEquals",value:function(e,t){var n=e.indexOf(".");return(e=n>-1?e.substring(0,n):e)===t}},{key:"buildValue",value:function(e){return"$"+e}}]),e}();t.a=m},function(e,t,n){"use strict";var i=n(39),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s);n.d(t,"a",function(){return u});var u=function(){function e(t,n){r()(this,e),this.$http=t,this.$q=n,this.serverLanguagesMap=null,this.rootLanguagesMap=null,this.localesMap=null,this.langsPromise=null}return e.$inject=["$http","$q"],l()(e,[{key:"getRootLanguages",value:function(){var e=this;return this.rootLanguagesMap?this.$q.resolve(this.rootLanguagesMap):(this.rootLanguagesMap={},this.getLanguagesMap().then(function(t){return o()(t).filter(function(e){return!t[e].rootLanguage}).forEach(function(n){e.rootLanguagesMap[n]=t[n].fullLangName}),e.rootLanguagesMap}))}},{key:"getLocalesForRoot",value:function(e){return this.getLocales().then(function(t){return t[e.toString()]?t[e.toString()]:null})}},{key:"getLocales",value:function(){var e=this;return this.localesMap?this.$q.resolve(this.localesMap):(this.localesMap={},this.getLanguagesMap().then(function(t){return o()(t).filter(function(e){return t[e].rootLanguage}).forEach(function(n){var i=n.slice(0,2);e.localesMap[i]||(e.localesMap[i]={}),e.localesMap[i][n]=t[n].fullLangName}),e.localesMap}))}},{key:"getLanguagesMap",value:function(){var e=this;return this.serverLanguagesMap?this.$q.resolve(this.serverLanguagesMap):this.loadLanguages().then(function(t){return e.serverLanguagesMap=t,e.serverLanguagesMap})}},{key:"loadLanguages",value:function(){return this.langsPromise||(this.langsPromise=this.$http.get("/api/langs")),this.langsPromise.then(function(e){return e.data}).catch(function(){return{}})}}]),e}()},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=function(){function e(t){var n=this;o()(this,e),this.$q=t,this.initialized=!1,this.onvoiceschanged=!1,this.onvoiceschangedlisteners=[],"speechSynthesis"in window?(this.tts=window.speechSynthesis,this.initialized=!0,this.tts.onvoiceschanged=function(){n.onvoiceschangedlisteners&&(n.onvoiceschangedlisteners.forEach(function(e){return e()}),n.onvoiceschangedlisteners=[]),n.onvoiceschanged=!0}):alert("Web Audio API is not supported in this browser")}return e.$inject=["$q"],r()(e,[{key:"checkEnabled",value:function(e){var t=this,n=this.$q.defer();if(this.initialized){var i=function(){n.resolve(!!t.getSuitableVoice(e))};this.onvoiceschanged?i():this.onvoiceschangedlisteners.push(i)}else n.resolve(!1);return n.promise}},{key:"setListener",value:function(e){this.listener=e}},{key:"speak",value:function(t,n){if(this.initialized){var i=t.replace(e.TAG_REGEX,"");this.speakLocal(i,n)}}},{key:"stop",value:function(){this.tts.cancel()}},{key:"speakLocal",value:function(e,t){this.msg=new SpeechSynthesisUtterance(e);var n=this.getSuitableVoice(t);n?this.msg.voice=n:this.msg.lang=t,this.msg.onstart=this.onStart.bind(this),this.msg.onend=this.onEnd.bind(this),this.msg.onerror=this.onError.bind(this),this.tts.speak(this.msg)}},{key:"getSuitableVoice",value:function(e){var t=null,n=null,i=void 0,o=e.indexOf("-");return o>-1&&(i=e.substring(0,o)),this.tts.getVoices().some(function(o){return n||(i?o.lang.startsWith(i)&&(n=o):o.lang===e&&(n=o)),!t&&o.lang===e&&o.localService&&(t=o),t&&n}),t||n}},{key:"onStart",value:function(){this.listener&&this.listener.onStart()}},{key:"onEnd",value:function(){this.msg=null,this.listener&&this.listener.onEnd()}},{key:"onError",value:function(e){console.log("TTS error: "+e),this.msg=null,this.listener&&this.listener.onError(e)}}]),e}();t.a=s,s.TAG_REGEX=/(<([^>]+)>)/gi},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(56);n.d(t,"a",function(){return l});var l=function(){function e(t,n,i,a,r,s){o()(this,e),this.$q=t,this.$http=n,this.$filter=i,this.CurrentUser=a,this.$location=r,this.urls=s}return e.$inject=["$q","$http","$filter","CurrentUser","$location","urls"],r()(e,[{key:"setAgent",value:function(e){this.agent=e}},{key:"createRequest",value:function(e,t,n,i){if(i)return this.$q.reject({status:{code:501,errorDetails:"Audio request is not supported."}});var o=this.urls.apiUrls.test+"?v="+this.urls.protocolVersion,a={q:e,timezone:this.getTimeZoneForQuery(),lang:t,sessionId:this.CurrentUser.getSessionId(),resetContexts:n},r={method:"POST",url:o,headers:{devMode:"true"},data:a};return this.$q.resolve(r)}},{key:"generateCurl",value:function(e){var t=this.$location.protocol(),n=this.$location.host(),i=String(this.$location.port()),o=encodeURIComponent(e.data.q),a=this.agent&&this.agent.secondaryKey||this.CurrentUser.getKey(),r=e.data.timezone,s=e.data.lang,l=e.data.sessionId,u="api";return n.indexOf("console.dialogflow.com")>=0&&(n="api.dialogflow.com",u="v1"),i="https"===t||"80"===i?"":":"+i,"curl '"+t+"://"+n+i+"/"+u+"/query?v="+this.urls.protocolVersion+"&query="+o+"&lang="+s+"&sessionId="+l+"&timezone="+r+"' -H 'Authorization:Bearer "+a+"'"}},{key:"getServerResponse",value:function(e){return new s.b(e)}},{key:"getReadableJsonResponse",value:function(e,t){var n=_.clone(e);return delete n.rawResponse,t&&n.alternateResult&&(n.result=n.alternateResult),delete n.alternateResult,n}},{key:"getTimeZoneForQuery",value:function(){try{if(Intl&&Intl.DateTimeFormat){var e=(new Intl.DateTimeFormat).resolvedOptions().timeZone;if(e)return e}}catch(e){}return this.$filter("date")(new Date,"yyyy-MM-ddTHH:mm:ssZ")}}]),e}()},function(e,t,n){"use strict";var i=n(26),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(214),c=n(34),d=n(95),m=n(96),g=n(97),h=n(98),p=n(99),f=n(56);n.d(t,"a",function(){return v});var v=function(){function e(t,n,i,o,a){r()(this,e),this.$http=t,this.$q=n,this.CurrentUser=i,this.apiConfig=o,this.urls=a}return e.$inject=["$http","$q","CurrentUser","apiConfig","urls"],l()(e,[{key:"setAgent",value:function(e){this.agent=e,this.accessToken=null,this.getAccessToken()}},{key:"createRequest",value:function(e,t,n,i){var o=this,a=this.CurrentUser.getSessionId(),r=void 0;return r=i?{audioConfig:{audioEncoding:"AUDIO_ENCODING_LINEAR16",sampleRateHertz:16e3,languageCode:t}}:{text:{text:e,languageCode:t}},this.getAccessToken().then(function(t){var s={method:"POST",url:o.apiConfig.getClientConfig().cceUrl+"/v1alpha/projects/"+o.agent.cloudProjectId+"/agents/"+o.agent.cloudProjectId+"/sessions/"+a+":detectIntent",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer "+t,"Api-Ai-Dev-Mode":!0},data:{queryInput:r,queryParams:{}}},l=o.getTimeZone();return l&&(s.data.queryParams.timeZone=l),n&&(s.data.queryParams.resetContexts=n),i&&(s.data.inputAudio=e),s})}},{key:"generateCurl",value:function(e){var t=[];for(var n in e.headers)"Api-Ai-Dev-Mode"!==n&&t.push('-H "'+n+": "+e.headers[n]+'" ');return"curl "+t.join(" ")+" -d '"+o()(e.data)+"' \""+e.url+'"'}},{key:"getReadableJsonResponse",value:function(e,t){if(e.rawResponse.queryResult&&e.rawResponse.queryResult.diagnosticInfo&&e.rawResponse.queryResult.diagnosticInfo.alternative_query_result){var n=angular.copy(e.rawResponse);return t?n.queryResult=n.queryResult.diagnosticInfo.alternative_query_result:delete n.queryResult.diagnosticInfo.alternative_query_result,n}return t?null:e.rawResponse}},{key:"getServerResponse",value:function(e){var t=new f.a;return e?(t.id=e.responseId,e.queryResult?(t.result=this.convertQueryResult(e.queryResult),e.queryResult.diagnosticInfo&&e.queryResult.diagnosticInfo.alternative_query_result&&(t.alternateResult=this.convertQueryResult(e.queryResult.diagnosticInfo.alternative_query_result))):t.result={},e.error&&(t.status={code:e.error.code,errorDetails:e.error.message,errorType:e.error.status}),new f.a(t,e)):t}},{key:"convertQueryResult",value:function(e){var t=this,n=new u.a;if(n.action=e.action,n.resolvedQuery=e.queryText,n.score=e.intentDetetionConfidence,n.parameters=e.parameters,"boolean"==typeof e.allRequiredParamsCollected&&(n.actionIncomplete=!e.allRequiredParamsCollected),e.fulfillment&&(n.fulfillment={speech:e.fulfillment.text,messages:this.convertIntentMessages(e.fulfillment.messages)}),n.metadata={},e.intent)switch(n.metadata.intentId=this.getIdFromCceName(e.intent.name),n.metadata.intentName=e.intent.displayName,e.intent.webhookState){case"WEBHOOK_STATE_DISABLED":n.metadata.webhookUsed="false",n.metadata.webhookForSlotFillingUsed="false";break;case"WEBHOOK_STATE_ENABLED":n.metadata.webhookUsed="true",n.metadata.webhookForSlotFillingUsed="false";break;case"WEBHOOK_STATE_ENABLED_FOR_SLOT_FILLING":n.metadata.webhookUsed="true",n.metadata.webhookForSlotFillingUsed="true";break;default:console.warn("Unknown webhook state: ",e.intent.webhookState),n.metadata.webhookUsed="false",n.metadata.webhookForSlotFillingUsed="false"}if(e.outputContexts&&e.outputContexts.length&&(n.contexts=e.outputContexts.map(function(e){return{name:t.getIdFromCceName(e.name),lifespan:e.lifespanCount,parameters:e.parameters}})),e.diagnosticInfo){var i=e.diagnosticInfo.webhook_latency_seconds;"number"==typeof i&&(n.metadata.webhookResponseTime=1e3*i)}return n}},{key:"getIdFromCceName",value:function(e){if(!e)return null;var t=e.split("/");return t[t.length-1]}},{key:"convertIntentMessages",value:function(t){return t?t.map(function(t){var n=void 0;if(t.text)n=new p.a({type:0}),n.speech=t.text.text.join("\n");else if(t.card)n=new d.a({type:1,title:t.card.title,subtitle:t.card.subtitle,imageUrl:t.card.imageUrl,buttons:t.card.buttons});else if(t.quickReplies)n=new h.a({type:2,title:t.quickReplies.title,replies:t.quickReplies.quickReplies});else if(t.image)n=new g.a({type:3,imageUrl:t.image.imageUri});else{if(!t.payload)return console.warn("Unknown type:",t),null;n=new m.a({type:4,payload:t.payload})}return n.platform=e.PLATFORM_MAP[t.platform],n}).filter(function(e){return null!==e}):[]}},{key:"getAccessToken",value:function(){var e=this,t=this.$q.defer(),n=+new Date/1e3;return this.accessToken&&this.accessToken.expire-n>100?t.resolve(this.accessToken.token):this.$http.get(this.urls.apiUrls.agent+"/"+this.agent.id+"/cceAccessToken").then(function(n){e.accessToken={token:n.data.token,expire:n.data.expire},t.resolve(e.accessToken.token)}),t.promise}},{key:"getTimeZone",value:function(){try{return Intl&&Intl.DateTimeFormat?(new Intl.DateTimeFormat).resolvedOptions().timeZone:null}catch(e){return null}}}]),e}();v.PLATFORM_MAP={PLATFORM_DEFAULT:c.a.DEFAULT.name,PLATFORM_FACEBOOK:c.a.FACEBOOK.name,PLATFORM_KIK:c.a.KIK.name,PLATFORM_LINE:c.a.LINE.name,PLATFORM_SKYPE:c.a.SKYPE.name,PLATFORM_SLACK:c.a.SLACK.name,PLATFORM_TELEGRAM:c.a.TELEGRAM.name,PLATFORM_VIBER:c.a.VIBER.name,PLATFORM_ALEXA:c.a.ALEXA.name}},function(e,t){/**!
 * AngularJS file upload directives and services. Supoorts: file upload/drop/paste, resume, cancel/abort,
 * progress, resize, thumbnail, preview, validation and CORS
 * @author  Danial  <danial.farid@gmail.com>
 * @version 12.2.13
 */
!window.XMLHttpRequest||window.FileAPI&&FileAPI.shouldLoad||(window.XMLHttpRequest.prototype.setRequestHeader=function(e){return function(t,n){if("__setXHR_"===t){var i=n(this);i instanceof Function&&i(this)}else e.apply(this,arguments)}}(window.XMLHttpRequest.prototype.setRequestHeader));var n=angular.module("ngFileUpload",[]);n.version="12.2.13",n.service("UploadBase",["$http","$q","$timeout",function(e,t,i){function o(n){function o(e){u.notify&&u.notify(e),c.progressFunc&&i(function(){c.progressFunc(e)})}function a(e){return null!=n._start&&s?{loaded:e.loaded+n._start,total:n._file&&n._file.size||e.total,type:e.type,config:n,lengthComputable:!0,target:e.target}:e}function l(){e(n).then(function(e){if(s&&n._chunkSize&&!n._finished&&n._file){var t=n._file&&n._file.size||0;o({loaded:Math.min(n._end,t),total:t,config:n,type:"progress"}),r.upload(n,!0)}else n._finished&&delete n._finished,u.resolve(e)},function(e){u.reject(e)},function(e){u.notify(e)})}n.method=n.method||"POST",n.headers=n.headers||{};var u=n._deferred=n._deferred||t.defer(),c=u.promise;return n.disableProgress||(n.headers.__setXHR_=function(){return function(e){e&&e.upload&&e.upload.addEventListener&&(n.__XHR=e,n.xhrFn&&n.xhrFn(e),e.upload.addEventListener("progress",function(e){e.config=n,o(a(e))},!1),e.upload.addEventListener("load",function(e){e.lengthComputable&&(e.config=n,o(a(e)))},!1))}}),s?n._chunkSize&&n._end&&!n._finished?(n._start=n._end,n._end+=n._chunkSize,l()):n.resumeSizeUrl?e.get(n.resumeSizeUrl).then(function(e){n.resumeSizeResponseReader?n._start=n.resumeSizeResponseReader(e.data):n._start=parseInt((null==e.data.size?e.data:e.data.size).toString()),n._chunkSize&&(n._end=n._start+n._chunkSize),l()},function(e){throw e}):n.resumeSize?n.resumeSize().then(function(e){n._start=e,n._chunkSize&&(n._end=n._start+n._chunkSize),l()},function(e){throw e}):(n._chunkSize&&(n._start=0,n._end=n._start+n._chunkSize),l()):l(),c.success=function(e){return c.then(function(t){e(t.data,t.status,t.headers,n)}),c},c.error=function(e){return c.then(null,function(t){e(t.data,t.status,t.headers,n)}),c},c.progress=function(e){return c.progressFunc=e,c.then(null,null,function(t){e(t)}),c},c.abort=c.pause=function(){return n.__XHR&&i(function(){n.__XHR.abort()}),c},c.xhr=function(e){return n.xhrFn=function(t){return function(){t&&t.apply(c,arguments),e.apply(c,arguments)}}(n.xhrFn),c},r.promisesCount++,c.finally&&c.finally instanceof Function&&c.finally(function(){r.promisesCount--}),c}function a(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var r=this;r.promisesCount=0,this.isResumeSupported=function(){return window.Blob&&window.Blob.prototype.slice};var s=this.isResumeSupported();this.isUploadInProgress=function(){return r.promisesCount>0},this.rename=function(e,t){return e.ngfName=t,e},this.jsonBlob=function(e){null==e||angular.isString(e)||(e=JSON.stringify(e));var t=new window.Blob([e],{type:"application/json"});return t._ngfBlob=!0,t},this.json=function(e){return angular.toJson(e)},this.isFile=function(e){return null!=e&&(e instanceof window.Blob||e.flashId&&e.name&&e.size)},this.upload=function(e,t){function n(t,n){if(t._ngfBlob)return t;if(e._file=e._file||t,null!=e._start&&s){e._end&&e._end>=t.size&&(e._finished=!0,e._end=t.size);var i=t.slice(e._start,e._end||t.size);return i.name=t.name,i.ngfName=t.ngfName,e._chunkSize&&(n.append("_chunkSize",e._chunkSize),n.append("_currentChunkSize",e._end-e._start),n.append("_chunkNumber",Math.floor(e._start/e._chunkSize)),n.append("_totalSize",e._file.size)),i}return t}function i(t,o,a){if(void 0!==o)if(angular.isDate(o)&&(o=o.toISOString()),angular.isString(o))t.append(a,o);else if(r.isFile(o)){var s=n(o,t),l=a.split(",");l[1]&&(s.ngfName=l[1].replace(/^\s+|\s+$/g,""),a=l[0]),e._fileKey=e._fileKey||a,t.append(a,s,s.ngfName||s.name)}else if(angular.isObject(o)){if(o.$$ngfCircularDetection)throw"ngFileUpload: Circular reference in config.data. Make sure specified data for Upload.upload() has no circular reference: "+a;o.$$ngfCircularDetection=!0;try{for(var u in o)if(o.hasOwnProperty(u)&&"$$ngfCircularDetection"!==u){var c=null==e.objectKey?"[i]":e.objectKey;o.length&&parseInt(u)>-1&&(c=null==e.arrayKey?c:e.arrayKey),i(t,o[u],a+c.replace(/[ik]/g,u))}}finally{delete o.$$ngfCircularDetection}}else t.append(a,o)}function l(){e._chunkSize=r.translateScalars(e.resumeChunkSize),e._chunkSize=e._chunkSize?parseInt(e._chunkSize.toString()):null,e.headers=e.headers||{},e.headers["Content-Type"]=void 0,e.transformRequest=e.transformRequest?angular.isArray(e.transformRequest)?e.transformRequest:[e.transformRequest]:[],e.transformRequest.push(function(t){var n,o=new window.FormData;t=t||e.fields||{},e.file&&(t.file=e.file);for(n in t)if(t.hasOwnProperty(n)){var a=t[n];e.formDataAppender?e.formDataAppender(o,n,a):i(o,a,n)}return o})}return t||(e=a(e)),e._isDigested||(e._isDigested=!0,l()),o(e)},this.http=function(t){return t=a(t),t.transformRequest=t.transformRequest||function(t){return window.ArrayBuffer&&t instanceof window.ArrayBuffer||t instanceof window.Blob?t:e.defaults.transformRequest[0].apply(this,arguments)},t._chunkSize=r.translateScalars(t.resumeChunkSize),t._chunkSize=t._chunkSize?parseInt(t._chunkSize.toString()):null,o(t)},this.translateScalars=function(e){if(angular.isString(e)){if(e.search(/kb/i)===e.length-2)return parseFloat(1024*e.substring(0,e.length-2));if(e.search(/mb/i)===e.length-2)return parseFloat(1048576*e.substring(0,e.length-2));if(e.search(/gb/i)===e.length-2)return parseFloat(1073741824*e.substring(0,e.length-2));if(e.search(/b/i)===e.length-1)return parseFloat(e.substring(0,e.length-1));if(e.search(/s/i)===e.length-1)return parseFloat(e.substring(0,e.length-1));if(e.search(/m/i)===e.length-1)return parseFloat(60*e.substring(0,e.length-1));if(e.search(/h/i)===e.length-1)return parseFloat(3600*e.substring(0,e.length-1))}return e},this.urlToBlob=function(n){var i=t.defer();return e({url:n,method:"get",responseType:"arraybuffer"}).then(function(e){var t=new Uint8Array(e.data),o=e.headers("content-type")||"image/WebP",a=new window.Blob([t],{type:o}),r=n.match(/.*\/(.+?)(\?.*)?$/);r.length>1&&(a.name=r[1]),i.resolve(a)},function(e){i.reject(e)}),i.promise},this.setDefaults=function(e){this.defaults=e||{}},this.defaults={},this.version=n.version}]),n.service("Upload",["$parse","$timeout","$compile","$q","UploadExif",function(e,t,n,i,o){function a(e,t,n){var o=[l.emptyPromise()];return angular.forEach(e,function(i,a){0===i.type.indexOf("image/jpeg")&&l.attrGetter("ngfFixOrientation",t,n,{$file:i})&&o.push(l.happyPromise(l.applyExifRotation(i),i).then(function(t){e.splice(a,1,t)}))}),i.all(o)}function r(e,t,n,o){var a=l.attrGetter("ngfResize",t,n);if(!a||!l.isResizeSupported()||!e.length)return l.emptyPromise();if(a instanceof Function){var r=i.defer();return a(e).then(function(i){s(i,e,t,n,o).then(function(e){r.resolve(e)},function(e){r.reject(e)})},function(e){r.reject(e)})}return s(a,e,t,n,o)}function s(e,t,n,o,a){function r(i,r){if(0===i.type.indexOf("image")){if(e.pattern&&!l.validatePattern(i,e.pattern))return;e.resizeIf=function(e,t){return l.attrGetter("ngfResizeIf",n,o,{$width:e,$height:t,$file:i})};var u=l.resize(i,e);s.push(u),u.then(function(e){t.splice(r,1,e)},function(e){i.$error="resize",(i.$errorMessages=i.$errorMessages||{}).resize=!0,i.$errorParam=(e?(e.message?e.message:e)+": ":"")+(i&&i.name),a.$ngfValidations.push({name:"resize",valid:!1}),l.applyModelValidation(a,t)})}}for(var s=[l.emptyPromise()],u=0;u<t.length;u++)r(t[u],u);return i.all(s)}var l=o;return l.getAttrWithDefaults=function(e,t){if(null!=e[t])return e[t];var n=l.defaults[t];return null==n?n:angular.isString(n)?n:JSON.stringify(n)},l.attrGetter=function(t,n,i,o){var a=this.getAttrWithDefaults(n,t);if(!i)return a;try{return o?e(a)(i,o):e(a)(i)}catch(e){if(t.search(/min|max|pattern/i))return a;throw e}},l.shouldUpdateOn=function(e,t,n){var i=l.attrGetter("ngfModelOptions",t,n);return!i||!i.updateOn||i.updateOn.split(" ").indexOf(e)>-1},l.emptyPromise=function(){var e=i.defer(),n=arguments;return t(function(){e.resolve.apply(e,n)}),e.promise},l.rejectPromise=function(){var e=i.defer(),n=arguments;return t(function(){e.reject.apply(e,n)}),e.promise},l.happyPromise=function(e,n){var o=i.defer();return e.then(function(e){o.resolve(e)},function(e){t(function(){throw e}),o.resolve(n)}),o.promise},l.updateModel=function(n,i,o,s,u,c,d){function m(a,r,u,d,m){i.$$ngfPrevValidFiles=a,i.$$ngfPrevInvalidFiles=r;var g=a&&a.length?a[0]:null,h=r&&r.length?r[0]:null;n&&(l.applyModelValidation(n,a),n.$setViewValue(m?g:a)),s&&e(s)(o,{$files:a,$file:g,$newFiles:u,$duplicateFiles:d,$invalidFiles:r,$invalidFile:h,$event:c});var p=l.attrGetter("ngfModelInvalid",i);p&&t(function(){e(p).assign(o,m?h:r)}),t(function(){})}function g(){function e(e,t){return e.name===t.name&&(e.$ngfOrigSize||e.size)===(t.$ngfOrigSize||t.size)&&e.type===t.type}function t(t){var n;for(n=0;n<v.length;n++)if(e(t,v[n]))return!0;for(n=0;n<b.length;n++)if(e(t,b[n]))return!0;return!1}if(u){f=[],y=[];for(var n=0;n<u.length;n++)t(u[n])?y.push(u[n]):f.push(u[n])}}function h(e){return angular.isArray(e)?e:[e]}function p(){function e(){t(function(){m(S?v.concat(A):A,S?b.concat(k):k,u,y,w)},C&&C.debounce?C.debounce.change||C.debounce:0)}var a=E?f:A;r(a,i,o,n).then(function(){E?l.validate(f,S?v.length:0,n,i,o).then(function(t){A=t.validsFiles,k=t.invalidsFiles,e()}):e()},function(){for(var t=0;t<a.length;t++){var n=a[t];if("resize"===n.$error){var i=A.indexOf(n);i>-1&&(A.splice(i,1),k.push(n)),e()}}})}var f,v,b,y=[],k=[],A=[];v=i.$$ngfPrevValidFiles||[],b=i.$$ngfPrevInvalidFiles||[],n&&n.$modelValue&&(v=h(n.$modelValue));var S=l.attrGetter("ngfKeep",i,o);f=(u||[]).slice(0),"distinct"!==S&&!0!==l.attrGetter("ngfKeepDistinct",i,o)||g(i,o);var w=!S&&!l.attrGetter("ngfMultiple",i,o)&&!l.attrGetter("multiple",i);if(!S||f.length){l.attrGetter("ngfBeforeModelChange",i,o,{$files:u,$file:u&&u.length?u[0]:null,$newFiles:f,$duplicateFiles:y,$event:c});var E=l.attrGetter("ngfValidateAfterResize",i,o),C=l.attrGetter("ngfModelOptions",i,o);l.validate(f,S?v.length:0,n,i,o).then(function(e){d?m(f,[],u,y,w):(C&&C.allowInvalid||E?A=f:(A=e.validFiles,k=e.invalidFiles),l.attrGetter("ngfFixOrientation",i,o)&&l.isExifSupported()?a(A,i,o).then(function(){p()}):p())})}},l}]),n.directive("ngfSelect",["$parse","$timeout","$compile","Upload",function(e,t,n,i){function o(e){var t=e.match(/Android[^\d]*(\d+)\.(\d+)/);if(t&&t.length>2){var n=i.defaults.androidFixMinorVersion||4;return parseInt(t[1])<4||parseInt(t[1])===n&&parseInt(t[2])<n}return-1===e.indexOf("Chrome")&&/.*Windows.*Safari.*/.test(e)}function a(e,t,n,i,a,s,l,u){function c(){return"input"===t[0].tagName.toLowerCase()&&n.type&&"file"===n.type.toLowerCase()}function d(){return y("ngfChange")||y("ngfSelect")}function m(t){if(u.shouldUpdateOn("change",n,e)){var o=t.__files_||t.target&&t.target.files,a=[];if(!o)return;for(var r=0;r<o.length;r++)a.push(o[r]);u.updateModel(i,n,e,d(),a.length?a:null,t)}}function g(e,i){function o(t){e.attr("id","ngf-"+t),i.attr("id","ngf-label-"+t)}for(var a=0;a<t[0].attributes.length;a++){var r=t[0].attributes[a];"type"!==r.name&&"class"!==r.name&&"style"!==r.name&&("id"===r.name?(o(r.value),k.push(n.$observe("id",o))):e.attr(r.name,r.value||"required"!==r.name&&"multiple"!==r.name?r.value:r.name))}}function h(){if(c())return t;var e=angular.element('<input type="file">'),n=angular.element("<label>upload</label>");return n.css("visibility","hidden").css("position","absolute").css("overflow","hidden").css("width","0px").css("height","0px").css("border","none").css("margin","0px").css("padding","0px").attr("tabindex","-1"),g(e,n),r.push({el:t,ref:n}),document.body.appendChild(n.append(e)[0]),e}function p(n){if(t.attr("disabled"))return!1;if(!y("ngfSelectDisabled",e)){var i=f(n);if(null!=i)return i;v(n);try{c()||document.body.contains(w[0])||(r.push({el:t,ref:w.parent()}),document.body.appendChild(w.parent()[0]),w.bind("change",m))}catch(e){}return o(navigator.userAgent)?setTimeout(function(){w[0].click()},0):w[0].click(),!1}}function f(e){var t=e.changedTouches||e.originalEvent&&e.originalEvent.changedTouches;if(t){if("touchstart"===e.type)return S=t[0].clientX,A=t[0].clientY,!0;if("touchend"===e.type){var n=t[0].clientX,i=t[0].clientY;if(Math.abs(n-S)>20||Math.abs(i-A)>20)return e.stopPropagation(),e.preventDefault(),!1}return!0}}function v(t){u.shouldUpdateOn("click",n,e)&&w.val()&&(w.val(null),u.updateModel(i,n,e,d(),null,t,!0))}function b(e){if(w&&!w.attr("__ngf_ie10_Fix_")){if(!w[0].parentNode)return void(w=null);e.preventDefault(),e.stopPropagation(),w.unbind("click");var t=w.clone();return w.replaceWith(t),w=t,w.attr("__ngf_ie10_Fix_","true"),w.bind("change",m),w.bind("click",b),w[0].click(),!1}w.removeAttr("__ngf_ie10_Fix_")}var y=function(e,t){return u.attrGetter(e,n,t)};u.registerModelChangeValidator(i,n,e);var k=[];y("ngfMultiple")&&k.push(e.$watch(y("ngfMultiple"),function(){w.attr("multiple",y("ngfMultiple",e))})),y("ngfCapture")&&k.push(e.$watch(y("ngfCapture"),function(){w.attr("capture",y("ngfCapture",e))})),y("ngfAccept")&&k.push(e.$watch(y("ngfAccept"),function(){w.attr("accept",y("ngfAccept",e))})),k.push(n.$observe("accept",function(){w.attr("accept",y("accept"))}));var A=0,S=0,w=t;c()||(w=h()),w.bind("change",m),c()?t.bind("click",v):t.bind("click touchstart touchend",p),-1!==navigator.appVersion.indexOf("MSIE 10")&&w.bind("click",b),i&&i.$formatters.push(function(e){return null!=e&&0!==e.length||w.val()&&w.val(null),e}),e.$on("$destroy",function(){c()||w.parent().remove(),angular.forEach(k,function(e){e()})}),s(function(){for(var e=0;e<r.length;e++){var t=r[e];document.body.contains(t.el[0])||(r.splice(e,1),t.ref.remove())}}),window.FileAPI&&window.FileAPI.ngfFixIE&&window.FileAPI.ngfFixIE(t,w,m)}var r=[];return{restrict:"AEC",require:"?ngModel",link:function(o,r,s,l){a(o,r,s,l,e,t,n,i)}}}]),function(){function e(e){return"img"===e.tagName.toLowerCase()?"image":"audio"===e.tagName.toLowerCase()?"audio":"video"===e.tagName.toLowerCase()?"video":/./}function t(t,n,i,o,a,r,s,l){function u(e){var r=t.attrGetter("ngfNoObjectUrl",a,i);t.dataUrl(e,r).finally(function(){n(function(){var t=(r?e.$ngfDataUrl:e.$ngfBlobUrl)||e.$ngfDataUrl;l?o.css("background-image","url('"+(t||"")+"')"):o.attr("src",t),t?o.removeClass("ng-hide"):o.addClass("ng-hide")})})}n(function(){var n=i.$watch(a[r],function(n){var c=s;if("ngfThumbnail"===r&&(c||(c={width:o[0].naturalWidth||o[0].clientWidth,height:o[0].naturalHeight||o[0].clientHeight}),0===c.width&&window.getComputedStyle)){var d=getComputedStyle(o[0]);d.width&&d.width.indexOf("px")>-1&&d.height&&d.height.indexOf("px")>-1&&(c={width:parseInt(d.width.slice(0,-2)),height:parseInt(d.height.slice(0,-2))})}if(angular.isString(n))return o.removeClass("ng-hide"),l?o.css("background-image","url('"+n+"')"):o.attr("src",n);!n||!n.type||0!==n.type.search(e(o[0]))||l&&0!==n.type.indexOf("image")?o.addClass("ng-hide"):c&&t.isResizeSupported()?(c.resizeIf=function(e,o){return t.attrGetter("ngfResizeIf",a,i,{$width:e,$height:o,$file:n})},t.resize(n,c).then(function(e){u(e)},function(e){throw e})):u(n)});i.$on("$destroy",function(){n()})})}n.service("UploadDataUrl",["UploadBase","$timeout","$q",function(e,t,n){var i=e;return i.base64DataUrl=function(e){if(angular.isArray(e)){var t=n.defer(),o=0;return angular.forEach(e,function(n){i.dataUrl(n,!0).finally(function(){if(++o===e.length){var n=[];angular.forEach(e,function(e){n.push(e.$ngfDataUrl)}),t.resolve(n,e)}})}),t.promise}return i.dataUrl(e,!0)},i.dataUrl=function(e,o){if(!e)return i.emptyPromise(e,e);if(o&&null!=e.$ngfDataUrl||!o&&null!=e.$ngfBlobUrl)return i.emptyPromise(o?e.$ngfDataUrl:e.$ngfBlobUrl,e);var a=o?e.$$ngfDataUrlPromise:e.$$ngfBlobUrlPromise;if(a)return a;var r=n.defer();return t(function(){if(window.FileReader&&e&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 8")||e.size<2e4)&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 9")||e.size<4e6)){var n=window.URL||window.webkitURL;if(n&&n.createObjectURL&&!o){var a;try{a=n.createObjectURL(e)}catch(n){return void t(function(){e.$ngfBlobUrl="",r.reject()})}t(function(){if(e.$ngfBlobUrl=a,a){r.resolve(a,e),i.blobUrls=i.blobUrls||[],i.blobUrlsTotalSize=i.blobUrlsTotalSize||0,i.blobUrls.push({url:a,size:e.size}),i.blobUrlsTotalSize+=e.size||0;for(var t=i.defaults.blobUrlsMaxMemory||268435456,o=i.defaults.blobUrlsMaxQueueSize||200;(i.blobUrlsTotalSize>t||i.blobUrls.length>o)&&i.blobUrls.length>1;){var s=i.blobUrls.splice(0,1)[0];n.revokeObjectURL(s.url),i.blobUrlsTotalSize-=s.size}}})}else{var s=new FileReader;s.onload=function(n){t(function(){e.$ngfDataUrl=n.target.result,r.resolve(n.target.result,e),t(function(){delete e.$ngfDataUrl},1e3)})},s.onerror=function(){t(function(){e.$ngfDataUrl="",r.reject()})},s.readAsDataURL(e)}}else t(function(){e[o?"$ngfDataUrl":"$ngfBlobUrl"]="",r.reject()})}),a=o?e.$$ngfDataUrlPromise=r.promise:e.$$ngfBlobUrlPromise=r.promise,a.finally(function(){delete e[o?"$$ngfDataUrlPromise":"$$ngfBlobUrlPromise"]}),a},i}]),n.directive("ngfSrc",["Upload","$timeout",function(e,n){return{restrict:"AE",link:function(i,o,a){t(e,n,i,o,a,"ngfSrc",e.attrGetter("ngfResize",a,i),!1)}}}]),n.directive("ngfBackground",["Upload","$timeout",function(e,n){return{restrict:"AE",link:function(i,o,a){t(e,n,i,o,a,"ngfBackground",e.attrGetter("ngfResize",a,i),!0)}}}]),n.directive("ngfThumbnail",["Upload","$timeout",function(e,n){return{restrict:"AE",link:function(i,o,a){var r=e.attrGetter("ngfSize",a,i);t(e,n,i,o,a,"ngfThumbnail",r,e.attrGetter("ngfAsBackground",a,i))}}}]),n.config(["$compileProvider",function(e){e.imgSrcSanitizationWhitelist&&e.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|webcal|local|file|data|blob):/),e.aHrefSanitizationWhitelist&&e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|webcal|local|file|data|blob):/)}]),n.filter("ngfDataUrl",["UploadDataUrl","$sce",function(e,t){return function(n,i,o){if(angular.isString(n))return t.trustAsResourceUrl(n);var a=n&&((i?n.$ngfDataUrl:n.$ngfBlobUrl)||n.$ngfDataUrl);return n&&!a?(!n.$ngfDataUrlFilterInProgress&&angular.isObject(n)&&(n.$ngfDataUrlFilterInProgress=!0,e.dataUrl(n,i)),""):(n&&delete n.$ngfDataUrlFilterInProgress,(n&&a?o?t.trustAsResourceUrl(a):a:n)||"")}}])}(),n.service("UploadValidate",["UploadDataUrl","$q","$timeout",function(e,t,n){function i(e){var t="",n=[];if(e.length>2&&"/"===e[0]&&"/"===e[e.length-1])t=e.substring(1,e.length-1);else{var o=e.split(",");if(o.length>1)for(var a=0;a<o.length;a++){var r=i(o[a]);r.regexp?(t+="("+r.regexp+")",a<o.length-1&&(t+="|")):n=n.concat(r.excludes)}else 0===e.indexOf("!")?n.push("^((?!"+i(e.substring(1)).regexp+").)*$"):(0===e.indexOf(".")&&(e="*"+e),t="^"+e.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",t=t.replace(/\\\*/g,".*").replace(/\\\?/g,"."))}return{regexp:t,excludes:n}}function o(e,t){null==t||e.$dirty||(e.$setDirty?e.$setDirty():e.$dirty=!0)}var a=e;return a.validatePattern=function(e,t){if(!t)return!0;var n=i(t),o=!0;if(n.regexp&&n.regexp.length){var a=new RegExp(n.regexp,"i");o=null!=e.type&&a.test(e.type)||null!=e.name&&a.test(e.name)}for(var r=n.excludes.length;r--;){var s=new RegExp(n.excludes[r],"i");o=o&&(null==e.type||s.test(e.type))&&(null==e.name||s.test(e.name))}return o},a.ratioToFloat=function(e){var t=e.toString(),n=t.search(/[x:]/i);return t=n>-1?parseFloat(t.substring(0,n))/parseFloat(t.substring(n+1)):parseFloat(t)},a.registerModelChangeValidator=function(e,t,n){e&&e.$formatters.push(function(i){if(e.$dirty){var o=i;i&&!angular.isArray(i)&&(o=[i]),a.validate(o,0,e,t,n).then(function(){a.applyModelValidation(e,o)})}return i})},a.applyModelValidation=function(e,t){o(e,t),angular.forEach(e.$ngfValidations,function(t){e.$setValidity(t.name,t.valid)})},a.getValidationAttr=function(e,t,n,i,o){var r="ngf"+n[0].toUpperCase()+n.substr(1),s=a.attrGetter(r,e,t,{$file:o});if(null==s&&(s=a.attrGetter("ngfValidate",e,t,{$file:o}))){var l=(i||n).split(".");s=s[l[0]],l.length>1&&(s=s&&s[l[1]])}return s},a.validate=function(e,n,i,o,r){function s(t,n,s){if(e){for(var l=e.length,u=null;l--;){var g=e[l];if(g){var h=a.getValidationAttr(o,r,t,n,g);null!=h&&(s(g,h,l)||(-1===c.indexOf(t)?(g.$error=t,(g.$errorMessages=g.$errorMessages||{})[t]=!0,g.$errorParam=h,-1===m.indexOf(g)&&m.push(g),d||e.splice(l,1),u=!1):e.splice(l,1)))}}null!==u&&i.$ngfValidations.push({name:t,valid:u})}}function l(n,s,l,g,h){function p(t,i,o){function a(a){if(a())if(-1===c.indexOf(n)){if(i.$error=n,(i.$errorMessages=i.$errorMessages||{})[n]=!0,i.$errorParam=o,-1===m.indexOf(i)&&m.push(i),!d){var r=e.indexOf(i);r>-1&&e.splice(r,1)}t.resolve(!1)}else{var s=e.indexOf(i);s>-1&&e.splice(s,1),t.resolve(!0)}else t.resolve(!0)}null!=o?g(i,o).then(function(e){a(function(){return!h(e,o)})},function(){a(function(){return u("ngfValidateForce",{$file:i})})}):t.resolve(!0)}var f=[a.emptyPromise(!0)];e&&(e=void 0===e.length?[e]:e,angular.forEach(e,function(e){var i=t.defer();if(f.push(i.promise),l&&(null==e.type||0!==e.type.search(l)))return void i.resolve(!0);"dimensions"===n&&null!=a.attrGetter("ngfDimensions",o)?a.imageDimensions(e).then(function(t){p(i,e,u("ngfDimensions",{$file:e,$width:t.width,$height:t.height}))},function(){i.resolve(!1)}):"duration"===n&&null!=a.attrGetter("ngfDuration",o)?a.mediaDuration(e).then(function(t){p(i,e,u("ngfDuration",{$file:e,$duration:t}))},function(){i.resolve(!1)}):p(i,e,a.getValidationAttr(o,r,n,s,e))}));var v=t.defer();return t.all(f).then(function(e){for(var t=!0,o=0;o<e.length;o++)if(!e[o]){t=!1;break}i.$ngfValidations.push({name:n,valid:t}),v.resolve(t)}),v.promise}i=i||{},i.$ngfValidations=i.$ngfValidations||[],angular.forEach(i.$ngfValidations,function(e){e.valid=!0});var u=function(e,t){return a.attrGetter(e,o,r,t)},c=(a.attrGetter("ngfIgnoreInvalid",o,r)||"").split(" "),d=a.attrGetter("ngfRunAllValidations",o,r);if(null==e||0===e.length)return a.emptyPromise({validFiles:e,invalidFiles:[]});e=void 0===e.length?[e]:e.slice(0);var m=[];s("pattern",null,a.validatePattern),s("minSize","size.min",function(e,t){return e.size+.1>=a.translateScalars(t)}),s("maxSize","size.max",function(e,t){return e.size-.1<=a.translateScalars(t)});var g=0;if(s("maxTotalSize",null,function(t,n){return!((g+=t.size)>a.translateScalars(n))||(e.splice(0,e.length),!1)}),s("validateFn",null,function(e,t){return!0===t||null===t||""===t}),!e.length)return a.emptyPromise({validFiles:[],invalidFiles:m});var h=t.defer(),p=[];return p.push(l("maxHeight","height.max",/image/,this.imageDimensions,function(e,t){return e.height<=t})),p.push(l("minHeight","height.min",/image/,this.imageDimensions,function(e,t){return e.height>=t})),p.push(l("maxWidth","width.max",/image/,this.imageDimensions,function(e,t){return e.width<=t})),p.push(l("minWidth","width.min",/image/,this.imageDimensions,function(e,t){return e.width>=t})),p.push(l("dimensions",null,/image/,function(e,t){return a.emptyPromise(t)},function(e){return e})),p.push(l("ratio",null,/image/,this.imageDimensions,function(e,t){for(var n=t.toString().split(","),i=!1,o=0;o<n.length;o++)Math.abs(e.width/e.height-a.ratioToFloat(n[o]))<.01&&(i=!0);return i})),p.push(l("maxRatio","ratio.max",/image/,this.imageDimensions,function(e,t){return e.width/e.height-a.ratioToFloat(t)<1e-4})),p.push(l("minRatio","ratio.min",/image/,this.imageDimensions,function(e,t){return e.width/e.height-a.ratioToFloat(t)>-1e-4})),p.push(l("maxDuration","duration.max",/audio|video/,this.mediaDuration,function(e,t){return e<=a.translateScalars(t)})),p.push(l("minDuration","duration.min",/audio|video/,this.mediaDuration,function(e,t){return e>=a.translateScalars(t)})),p.push(l("duration",null,/audio|video/,function(e,t){return a.emptyPromise(t)},function(e){return e})),p.push(l("validateAsyncFn",null,null,function(e,t){return t},function(e){return!0===e||null===e||""===e})),t.all(p).then(function(){if(d)for(var t=0;t<e.length;t++){var i=e[t];i.$error&&e.splice(t--,1)}d=!1,s("maxFiles",null,function(e,t,i){return n+i<t}),h.resolve({validFiles:e,invalidFiles:m})}),h.promise},a.imageDimensions=function(e){if(e.$ngfWidth&&e.$ngfHeight){var i=t.defer();return n(function(){i.resolve({width:e.$ngfWidth,height:e.$ngfHeight})}),i.promise}if(e.$ngfDimensionPromise)return e.$ngfDimensionPromise;var o=t.defer();return n(function(){if(0!==e.type.indexOf("image"))return void o.reject("not image");a.dataUrl(e).then(function(t){function i(){var t=s[0].naturalWidth||s[0].clientWidth,n=s[0].naturalHeight||s[0].clientHeight;s.remove(),e.$ngfWidth=t,e.$ngfHeight=n,o.resolve({width:t,height:n})}function a(){s.remove(),o.reject("load error")}function r(){n(function(){s[0].parentNode&&(s[0].clientWidth?i():l++>10?a():r())},1e3)}var s=angular.element("<img>").attr("src",t).css("visibility","hidden").css("position","fixed").css("max-width","none !important").css("max-height","none !important");s.on("load",i),s.on("error",a);var l=0;r(),angular.element(document.getElementsByTagName("body")[0]).append(s)},function(){o.reject("load error")})}),e.$ngfDimensionPromise=o.promise,e.$ngfDimensionPromise.finally(function(){delete e.$ngfDimensionPromise}),e.$ngfDimensionPromise},a.mediaDuration=function(e){if(e.$ngfDuration){var i=t.defer();return n(function(){i.resolve(e.$ngfDuration)}),i.promise}if(e.$ngfDurationPromise)return e.$ngfDurationPromise;var o=t.defer();return n(function(){if(0!==e.type.indexOf("audio")&&0!==e.type.indexOf("video"))return void o.reject("not media");a.dataUrl(e).then(function(t){function i(){var t=s[0].duration;e.$ngfDuration=t,s.remove(),o.resolve(t)}function a(){s.remove(),o.reject("load error")}function r(){n(function(){s[0].parentNode&&(s[0].duration?i():l>10?a():r())},1e3)}var s=angular.element(0===e.type.indexOf("audio")?"<audio>":"<video>").attr("src",t).css("visibility","none").css("position","fixed");s.on("loadedmetadata",i),s.on("error",a);var l=0;r(),angular.element(document.body).append(s)},function(){o.reject("load error")})}),e.$ngfDurationPromise=o.promise,e.$ngfDurationPromise.finally(function(){delete e.$ngfDurationPromise}),e.$ngfDurationPromise},a}]),n.service("UploadResize",["UploadValidate","$q",function(e,t){var n=e,i=function(e,t,n,i,o){var a=o?Math.max(n/e,i/t):Math.min(n/e,i/t);return{width:e*a,height:t*a,marginX:e*a-n,marginY:t*a-i}},o=function(e,o,a,r,s,l,u,c){var d=t.defer(),m=document.createElement("canvas"),g=document.createElement("img");return g.setAttribute("style","visibility:hidden;position:fixed;z-index:-100000"),document.body.appendChild(g),g.onload=function(){var e=g.width,t=g.height;if(g.parentNode.removeChild(g),null!=c&&!1===c(e,t))return void d.reject("resizeIf");try{if(l){var h=n.ratioToFloat(l);e/t<h?(o=e,a=o/h):(a=t,o=a*h)}o||(o=e),a||(a=t);var p=i(e,t,o,a,u);m.width=Math.min(p.width,o),m.height=Math.min(p.height,a);m.getContext("2d").drawImage(g,Math.min(0,-p.marginX/2),Math.min(0,-p.marginY/2),p.width,p.height),d.resolve(m.toDataURL(s||"image/WebP",r||.934))}catch(e){d.reject(e)}},g.onerror=function(){g.parentNode.removeChild(g),d.reject()},g.src=e,d.promise};return n.dataUrltoBlob=function(e,t,n){for(var i=e.split(","),o=i[0].match(/:(.*?);/)[1],a=atob(i[1]),r=a.length,s=new Uint8Array(r);r--;)s[r]=a.charCodeAt(r);var l=new window.Blob([s],{type:o});return l.name=t,l.$ngfOrigSize=n,l},n.isResizeSupported=function(){var e=document.createElement("canvas");return window.atob&&e.getContext&&e.getContext("2d")&&window.Blob},n.isResizeSupported()&&Object.defineProperty(window.Blob.prototype,"name",{get:function(){return this.$ngfName},set:function(e){this.$ngfName=e},configurable:!0}),n.resize=function(e,i){if(0!==e.type.indexOf("image"))return n.emptyPromise(e);var a=t.defer();return n.dataUrl(e,!0).then(function(t){o(t,i.width,i.height,i.quality,i.type||e.type,i.ratio,i.centerCrop,i.resizeIf).then(function(o){if("image/jpeg"===e.type&&!1!==i.restoreExif)try{o=n.restoreExif(t,o)}catch(e){setTimeout(function(){throw e},1)}try{var r=n.dataUrltoBlob(o,e.name,e.size);a.resolve(r)}catch(e){a.reject(e)}},function(t){"resizeIf"===t&&a.resolve(e),a.reject(t)})},function(e){a.reject(e)}),a.promise},n}]),function(){function e(e,n,i,o,a,r,s,l,u,c){function d(){return n.attr("disabled")||b("ngfDropDisabled",e)}function m(t,n,i){if(t){var o;try{o=t&&t.getData&&t.getData("text/html")}catch(e){}f(t.items,t.files,!1!==b("ngfAllowDir",e),b("multiple")||b("ngfMultiple",e)).then(function(e){e.length?g(e,n):h(i,o).then(function(e){g(e,n)})})}}function g(t,n){l.updateModel(o,i,e,b("ngfChange")||b("ngfDrop"),t,n)}function h(t,n){if(!l.shouldUpdateOn(t,i,e)||"string"!=typeof n)return l.rejectPromise([]);var o=[];n.replace(/<(img src|img [^>]* src) *=\"([^\"]*)\"/gi,function(e,t,n){o.push(n)});var a=[],r=[];if(o.length){angular.forEach(o,function(e){a.push(l.urlToBlob(e).then(function(e){r.push(e)}))});var s=c.defer();return c.all(a).then(function(){s.resolve(r)},function(e){s.reject(e)}),s.promise}return l.emptyPromise()}function p(e,t,n,i){var o=b("ngfDragOverClass",e,{$event:n}),a="dragover";if(angular.isString(o))a=o;else if(o&&(o.delay&&(S=o.delay),o.accept||o.reject)){var r=n.dataTransfer.items;if(null!=r&&r.length)for(var s=o.pattern||b("ngfPattern",e,{$event:n}),u=r.length;u--;){if(!l.validatePattern(r[u],s)){a=o.reject;break}a=o.accept}else a=o.accept}i(a)}function f(t,n,o,a){function r(e,t){var n=c.defer();if(null!=e)if(e.isDirectory){var i=[l.emptyPromise()];if(m){var o={type:"directory"};o.name=o.path=(t||"")+e.name,g.push(o)}var a=e.createReader(),s=[],p=function(){a.readEntries(function(o){try{o.length?(s=s.concat(Array.prototype.slice.call(o||[],0)),p()):(angular.forEach(s.slice(0),function(n){g.length<=u&&h<=d&&i.push(r(n,(t||"")+e.name+"/"))}),c.all(i).then(function(){n.resolve()},function(e){n.reject(e)}))}catch(e){n.reject(e)}},function(e){n.reject(e)})};p()}else e.file(function(e){try{e.path=(t||"")+e.name,m&&(e=l.rename(e,e.path)),g.push(e),h+=e.size,n.resolve()}catch(e){n.reject(e)}},function(e){n.reject(e)});return n.promise}var u=l.getValidationAttr(i,e,"maxFiles");null==u&&(u=Number.MAX_VALUE);var d=l.getValidationAttr(i,e,"maxTotalSize");null==d&&(d=Number.MAX_VALUE);var m=b("ngfIncludeDir",e),g=[],h=0,p=[l.emptyPromise()];if(t&&t.length>0&&"file:"!==s.location.protocol)for(var f=0;f<t.length;f++){if(t[f].webkitGetAsEntry&&t[f].webkitGetAsEntry()&&t[f].webkitGetAsEntry().isDirectory){var v=t[f].webkitGetAsEntry();if(v.isDirectory&&!o)continue;null!=v&&p.push(r(v))}else{var y=t[f].getAsFile();null!=y&&(g.push(y),h+=y.size)}if(g.length>u||h>d||!a&&g.length>0)break}else if(null!=n)for(var k=0;k<n.length;k++){var A=n.item(k);if((A.type||A.size>0)&&(g.push(A),h+=A.size),g.length>u||h>d||!a&&g.length>0)break}var S=c.defer();return c.all(p).then(function(){if(a||m||!g.length)S.resolve(g);else{for(var e=0;g[e]&&"directory"===g[e].type;)e++;S.resolve([g[e]])}},function(e){S.reject(e)}),S.promise}var v=t(),b=function(e,t,n){return l.attrGetter(e,i,t,n)};if(b("dropAvailable")&&r(function(){e[b("dropAvailable")]?e[b("dropAvailable")].value=v:e[b("dropAvailable")]=v}),!v)return void(!0===b("ngfHideOnDropNotAvailable",e)&&n.css("display","none"));null==b("ngfSelect")&&l.registerModelChangeValidator(o,i,e);var y,k=null,A=a(b("ngfStopPropagation")),S=1;n[0].addEventListener("dragover",function(t){if(!d()&&l.shouldUpdateOn("drop",i,e)){if(t.preventDefault(),A(e)&&t.stopPropagation(),navigator.userAgent.indexOf("Chrome")>-1){var o=t.dataTransfer.effectAllowed;t.dataTransfer.dropEffect="move"===o||"linkMove"===o?"move":"copy"}r.cancel(k),y||(y="C",p(e,i,t,function(i){y=i,n.addClass(y),b("ngfDrag",e,{$isDragging:!0,$class:y,$event:t})}))}},!1),n[0].addEventListener("dragenter",function(t){!d()&&l.shouldUpdateOn("drop",i,e)&&(t.preventDefault(),A(e)&&t.stopPropagation())},!1),n[0].addEventListener("dragleave",function(t){!d()&&l.shouldUpdateOn("drop",i,e)&&(t.preventDefault(),A(e)&&t.stopPropagation(),k=r(function(){y&&n.removeClass(y),y=null,b("ngfDrag",e,{$isDragging:!1,$event:t})},S||100))},!1),n[0].addEventListener("drop",function(t){!d()&&l.shouldUpdateOn("drop",i,e)&&(t.preventDefault(),A(e)&&t.stopPropagation(),y&&n.removeClass(y),y=null,m(t.dataTransfer,t,"dropUrl"))},!1),n[0].addEventListener("paste",function(t){navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&b("ngfEnableFirefoxPaste",e)&&t.preventDefault(),!d()&&l.shouldUpdateOn("paste",i,e)&&m(t.clipboardData||t.originalEvent.clipboardData,t,"pasteUrl")},!1),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&b("ngfEnableFirefoxPaste",e)&&(n.attr("contenteditable",!0),n.on("keypress",function(e){e.metaKey||e.ctrlKey||e.preventDefault()}))}function t(){var e=document.createElement("div");return"draggable"in e&&"ondrop"in e&&!/Edge\/12./i.test(navigator.userAgent)}n.directive("ngfDrop",["$parse","$timeout","$window","Upload","$http","$q",function(t,n,i,o,a,r){return{restrict:"AEC",require:"?ngModel",link:function(s,l,u,c){e(s,l,u,c,t,n,i,o,a,r)}}}]),n.directive("ngfNoFileDrop",function(){return function(e,n){t()&&n.css("display","none")}}),n.directive("ngfDropAvailable",["$parse","$timeout","Upload",function(e,n,i){return function(o,a,r){if(t()){var s=e(i.attrGetter("ngfDropAvailable",r));n(function(){s(o),s.assign&&s.assign(o,!0)})}}}])}(),n.service("UploadExif",["UploadResize","$q",function(e,t){function n(e,t,n,i){switch(t){case 2:return e.transform(-1,0,0,1,n,0);case 3:return e.transform(-1,0,0,-1,n,i);case 4:return e.transform(1,0,0,-1,0,i);case 5:return e.transform(0,1,1,0,0,0);case 6:return e.transform(0,1,-1,0,i,0);case 7:return e.transform(0,-1,-1,0,i,n);case 8:return e.transform(0,-1,1,0,0,n)}}function i(e){for(var t="",n=new Uint8Array(e),i=n.byteLength,o=0;o<i;o++)t+=String.fromCharCode(n[o]);return window.btoa(t)}var o=e;return o.isExifSupported=function(){return window.FileReader&&(new FileReader).readAsArrayBuffer&&o.isResizeSupported()},o.readOrientation=function(e){var n=t.defer(),i=new FileReader,o=e.slice?e.slice(0,65536):e;return i.readAsArrayBuffer(o),i.onerror=function(e){return n.reject(e)},i.onload=function(e){var t={orientation:1},i=new DataView(this.result);if(65496!==i.getUint16(0,!1))return n.resolve(t);for(var o=i.byteLength,a=2;a<o;){var r=i.getUint16(a,!1);if(a+=2,65505===r){if(1165519206!==i.getUint32(a+=2,!1))return n.resolve(t);var s=18761===i.getUint16(a+=6,!1);a+=i.getUint32(a+4,s);var l=i.getUint16(a,s);a+=2;for(var u=0;u<l;u++)if(274===i.getUint16(a+12*u,s)){var c=i.getUint16(a+12*u+8,s);return c>=2&&c<=8&&(i.setUint16(a+12*u+8,1,s),t.fixedArrayBuffer=e.target.result),t.orientation=c,n.resolve(t)}}else{if(65280!=(65280&r))break;a+=i.getUint16(a,!1)}}return n.resolve(t)},n.promise},o.applyExifRotation=function(e){if(0!==e.type.indexOf("image/jpeg"))return o.emptyPromise(e);var a=t.defer();return o.readOrientation(e).then(function(t){if(t.orientation<2||t.orientation>8)return a.resolve(e);o.dataUrl(e,!0).then(function(r){var s=document.createElement("canvas"),l=document.createElement("img");l.onload=function(){try{s.width=t.orientation>4?l.height:l.width,s.height=t.orientation>4?l.width:l.height;var r=s.getContext("2d");n(r,t.orientation,l.width,l.height),r.drawImage(l,0,0);var u=s.toDataURL(e.type||"image/WebP",.934);u=o.restoreExif(i(t.fixedArrayBuffer),u);var c=o.dataUrltoBlob(u,e.name);a.resolve(c)}catch(e){return a.reject(e)}},l.onerror=function(){a.reject()},l.src=r},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},o.restoreExif=function(e,t){var n={};return n.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n.encode64=function(e){var t,n,i,o,a,r="",s="",l="",u=0;do{t=e[u++],n=e[u++],s=e[u++],i=t>>2,o=(3&t)<<4|n>>4,a=(15&n)<<2|s>>6,l=63&s,isNaN(n)?a=l=64:isNaN(s)&&(l=64),r=r+this.KEY_STR.charAt(i)+this.KEY_STR.charAt(o)+this.KEY_STR.charAt(a)+this.KEY_STR.charAt(l),t=n=s="",i=o=a=l=""}while(u<e.length);return r},n.restore=function(e,t){e.match("data:image/jpeg;base64,")&&(e=e.replace("data:image/jpeg;base64,",""));var n=this.decode64(e),i=this.slice2Segments(n),o=this.exifManipulation(t,i);return"data:image/jpeg;base64,"+this.encode64(o)},n.exifManipulation=function(e,t){var n=this.getExifArray(t),i=this.insertExif(e,n);return new Uint8Array(i)},n.getExifArray=function(e){for(var t,n=0;n<e.length;n++)if(t=e[n],255===t[0]&225===t[1])return t;return[]},n.insertExif=function(e,t){var n=e.replace("data:image/jpeg;base64,",""),i=this.decode64(n),o=i.indexOf(255,3),a=i.slice(0,o),r=i.slice(o),s=a;return s=s.concat(t),s=s.concat(r)},n.slice2Segments=function(e){for(var t=0,n=[];;){if(255===e[t]&218===e[t+1])break;if(255===e[t]&216===e[t+1])t+=2;else{var i=256*e[t+2]+e[t+3],o=t+i+2,a=e.slice(t,o);n.push(a),t=o}if(t>e.length)break}return n},n.decode64=function(e){var t,n,i,o,a,r="",s="",l=0,u=[];/[^A-Za-z0-9\+\/\=]/g.exec(e)&&console.log("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, NaNExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{i=this.KEY_STR.indexOf(e.charAt(l++)),o=this.KEY_STR.indexOf(e.charAt(l++)),a=this.KEY_STR.indexOf(e.charAt(l++)),s=this.KEY_STR.indexOf(e.charAt(l++)),t=i<<2|o>>4,n=(15&o)<<4|a>>2,r=(3&a)<<6|s,u.push(t),64!==a&&u.push(n),64!==s&&u.push(r),t=n=r="",i=o=a=s=""}while(l<e.length);return u},n.restore(e,t)},o}])},,function(e,t,n){"use strict";(function(n){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */
function i(e,t){function n(){return t.disableLogs||console.log("started recording "+t.type+" stream."),f?(f.clearRecordedData(),f.record(),p("recording"),v.recordingDuration&&h(),v):(r(function(){v.recordingDuration&&h()}),v)}function r(n){n&&(t.initCallback=function(){n(),n=t.initCallback=null});var i=new a(e,t);f=new i(e,t),f.record(),p("recording"),t.disableLogs||console.log("Initialized recorderType:",f.constructor.name,"for output-type:",t.type)}function u(e){function n(n){Object.keys(f).forEach(function(e){"function"!=typeof f[e]&&(v[e]=f[e])});var i=f.blob;if(!i){if(!n)throw"Recording failed.";f.blob=i=n}if(e){var o=w.createObjectURL(i);"function"==typeof e.call?e.call(v,o):e(o)}i&&!t.disableLogs&&console.log(i.type,"->",s(i.size)),t.autoWriteToDisk&&g(function(e){var n={};n[t.type+"Blob"]=e,x.Store(n)})}return f?"paused"===v.state?(v.resumeRecording(),void setTimeout(function(){u(e)},1)):"recording"!==v.state?void(t.disableLogs||console.warn("Unable to stop the recording. Recording state: ",v.state)):(t.disableLogs||console.warn("Stopped recording "+t.type+" stream."),"gif"!==t.type?f.stop(n):(f.stop(),n()),void p("stopped")):console.warn(b)}function c(){return f?"recording"!==v.state?void(t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",v.state)):(p("paused"),f.pause(),void(t.disableLogs||console.log("Paused recording."))):console.warn(b)}function d(){return f?"paused"!==v.state?void(t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",v.state)):(p("recording"),f.resume(),void(t.disableLogs||console.log("Resumed recording."))):console.warn(b)}function m(e){postMessage((new FileReaderSync).readAsDataURL(e))}function g(e,n){function i(e){var t=w.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"})),n=new Worker(t);return w.revokeObjectURL(t),n}if(!e)throw"Pass a callback function over getDataURL.";var o=n?n.blob:(f||{}).blob;if(!o)return t.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout(function(){g(e,n)},1e3);if("undefined"==typeof Worker||navigator.mozGetUserMedia){var a=new FileReader;a.readAsDataURL(o),a.onload=function(t){e(t.target.result)}}else{var r=i(m);r.onmessage=function(t){e(t.data)},r.postMessage(o)}}function h(e){if(e=e||0,"paused"===v.state)return void setTimeout(function(){h(e)},1e3);if("stopped"!==v.state){if(e>=v.recordingDuration)return void u(v.onRecordingStopped);e+=1e3,setTimeout(function(){h(e)},1e3)}}function p(e){v.state=e,"function"==typeof v.onStateChanged.call?v.onStateChanged.call(v,e):v.onStateChanged(e)}if(!e)throw"First parameter is required.";t=t||{type:"video"},t=new o(e,t);var f,v=this,b='It seems that "startRecording" is not invoked for '+t.type+" recorder.",y={startRecording:n,stopRecording:u,pauseRecording:c,resumeRecording:d,initRecorder:r,setRecordingDuration:function(e,t){if(void 0===e)throw"recordingDuration is required.";if("number"!=typeof e)throw"recordingDuration must be a number.";return v.recordingDuration=e,v.onRecordingStopped=t||function(){},{onRecordingStopped:function(e){v.onRecordingStopped=e}}},clearRecordedData:function(){if(!f)return console.warn(b);f.clearRecordedData(),t.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){return f?f.blob:console.warn(b)},getDataURL:g,toURL:function(){return f?w.createObjectURL(f.blob):console.warn(b)},getInternalRecorder:function(){return f},save:function(e){if(!f)return console.warn(b);l(f.blob,e)},getFromDisk:function(e){if(!f)return console.warn(b);i.getFromDisk(t.type,e)},setAdvertisementArray:function(e){t.advertisement=[];for(var n=e.length,i=0;i<n;i++)t.advertisement.push({duration:i,image:e[i]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){f&&"function"==typeof f.clearRecordedData&&f.clearRecordedData(),f=null,p("inactive"),v.blob=null},onStateChanged:function(e){t.disableLogs||console.log("Recorder state changed:",e)},state:"inactive",getState:function(){return v.state}};if(!this)return v=y,y;for(var k in y)this[k]=y[k];return v=this,y}/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */
function o(e,t){return t.recorderType&&!t.type&&(t.recorderType===g||t.recorderType===m?t.type="video":t.recorderType===h?t.type="gif":t.recorderType===d?t.type="audio":t.recorderType===c&&(e.getAudioTracks().length&&e.getVideoTracks().length?t.type="video":e.getAudioTracks().length&&!e.getVideoTracks().length?t.type="audio":!e.getAudioTracks().length&&e.getVideoTracks().length&&(t.type="audio"))),void 0!==c&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */
function a(e,t){var n;return(_||E||C)&&(n=d),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!_&&(n=c),"video"===t.type&&(_||C)&&(n=g),"gif"===t.type&&(n=h),"canvas"===t.type&&(n=m),u()&&n!==m&&n!==h&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(e.getVideoTracks&&e.getVideoTracks().length||e.getAudioTracks&&e.getAudioTracks().length)&&("audio"===t.type?"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(n=c):"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(n=c)),t.recorderType&&(n=t.recorderType),e instanceof Array&&e.length&&(n=p),!t.disableLogs&&n&&n.name&&console.log("Using recorderType:",n.name||n.constructor.name),n}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 */
function r(e){this.addStream=function(t){t&&(e=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t,n=this.mediaType,o=this.mimeType||{audio:null,video:null,gif:null};if("function"!=typeof n.audio&&u()&&e.getAudioTracks&&!e.getAudioTracks().length&&(n.audio=!1),"function"!=typeof n.video&&u()&&e.getVideoTracks&&!e.getVideoTracks().length&&(n.video=!1),"function"!=typeof n.gif&&u()&&e.getVideoTracks&&!e.getVideoTracks().length&&(n.gif=!1),!n.audio&&!n.video&&!n.gif)throw"MediaStream must have either audio or video tracks.";if(n.audio&&(t=null,"function"==typeof n.audio&&(t=n.audio),this.audioRecorder=new i(e,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:t,mimeType:o.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),n.video||this.audioRecorder.startRecording()),n.video){t=null,"function"==typeof n.video&&(t=n.video);var a=e;if(u()&&n.audio&&"function"==typeof n.audio){var r=e.getVideoTracks()[0];navigator.mozGetUserMedia?(a=new T,a.addTrack(r),t&&t===g&&(t=c)):a=new T([r])}this.videoRecorder=new i(a,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:t,mimeType:o.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),n.audio||this.videoRecorder.startRecording()}if(n.audio&&n.video){var s=this;u()?(s.audioRecorder=null,s.videoRecorder.startRecording()):s.videoRecorder.initRecorder(function(){s.audioRecorder.initRecorder(function(){s.videoRecorder.startRecording(),s.audioRecorder.startRecording()})})}n.gif&&(t=null,"function"==typeof n.gif&&(t=n.gif),this.gifRecorder=new i(e,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:t,mimeType:o.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(t){e(t,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(t){e(t,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(t){e(t,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.getDataURL=function(e){function t(e,t){if("undefined"!=typeof Worker){var i=n(function(e){postMessage((new FileReaderSync).readAsDataURL(e))});i.onmessage=function(e){t(e.data)},i.postMessage(e)}else{var o=new FileReader;o.readAsDataURL(e),o.onload=function(e){t(e.target.result)}}}function n(e){var t,n=w.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"})),i=new Worker(n);if(void 0!==w)t=w;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";t=webkitURL}return t.revokeObjectURL(n),i}this.getBlob(function(n){n.audio&&n.video?t(n.audio,function(i){t(n.video,function(t){e({audio:i,video:t})})}):n.audio?t(n.audio,function(t){e({audio:t})}):n.video&&t(n.video,function(t){e({video:t})})})},this.writeToDisk=function(){i.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},e.audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof e.audio?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof e.gif?e.gif:"")}}function s(e){var t=1e3,n=["Bytes","KB","MB","GB","TB"];if(0===e)return"0 Bytes";var i=parseInt(Math.floor(Math.log(e)/Math.log(t)),10);return(e/Math.pow(t,i)).toPrecision(3)+" "+n[i]}function l(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(e){}var n=(e.type||"video/webm").split("/")[1];if(t&&-1!==t.indexOf(".")){var i=t.split(".");t=i[0],n=i[1]}var o=(t||Math.round(9999999999*Math.random())+888888888)+"."+n;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,o);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,o);var a=document.createElement("a");a.href=w.createObjectURL(e),a.download=o,a.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(a),"function"==typeof a.click?a.click():(a.target="_blank",a.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),w.revokeObjectURL(a.href)}function u(){var e=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t=!!window.chrome&&!e;if(void 0!==window.InstallTrigger)return!0;var n,i,o=(navigator.appVersion,navigator.userAgent),a=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10);return(t||e)&&(n=o.indexOf("Chrome"),a=o.substring(n+7)),-1!==(i=a.indexOf(";"))&&(a=a.substring(0,i)),-1!==(i=a.indexOf(" "))&&(a=a.substring(0,i)),r=parseInt(""+a,10),isNaN(r)&&(a=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10)),r>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ignoreMutedMedia: true
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */
function c(e,t){function n(){o.timestamps.push((new Date).getTime()),"function"==typeof t.onTimeStamp&&t.onTimeStamp(o.timestamps[o.timestamps.length-1],o.timestamps)}function i(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}var o=this;if(void 0===e)throw'First argument "MediaStream" is required.';if("undefined"==typeof MediaRecorder)throw"Your browser does not supports Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(t=t||{mimeType:"video/webm"},"audio"===t.type){if(e.getVideoTracks().length&&e.getAudioTracks().length){var a;navigator.mozGetUserMedia?(a=new T,a.addTrack(e.getAudioTracks()[0])):a=new T(e.getAudioTracks()),e=a}t.mimeType&&-1!==t.mimeType.toString().toLowerCase().indexOf("audio")||(t.mimeType=_?"audio/webm":"audio/ogg"),t.mimeType&&"audio/ogg"!==t.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(t.mimeType="audio/ogg")}var r=[];this.getArrayOfBlobs=function(){return r},this.record=function(){o.blob=null,o.clearRecordedData();var i=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",i),s&&(s=null),_&&!u()&&(i="video/vp8"),"function"==typeof MediaRecorder.isTypeSupported&&i.mimeType&&(MediaRecorder.isTypeSupported(i.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",i.mimeType),i.mimeType="audio"===t.type?"audio/webm":"video/webm"));try{s=new MediaRecorder(e,i)}catch(t){s=new MediaRecorder(e)}!MediaRecorder.isTypeSupported&&"canRecordMimeType"in s&&!1===s.canRecordMimeType(t.mimeType)&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",t.mimeType)),s.ignoreMutedMedia=t.ignoreMutedMedia||!1,s.ondataavailable=function(e){return"number"==typeof t.timeSlice?void(e.data&&e.data.size&&e.data.size>100&&(n(),r.push(e.data))):!e.data||!e.data.size||e.data.size<100||o.blob?void(o.recordingCallback&&(o.recordingCallback(new Blob([],{type:i.mimeType||"video/webm"})),o.recordingCallback=null)):(o.blob=t.getNativeBlob?e.data:new Blob([e.data],{type:i.mimeType||"video/webm"}),void(o.recordingCallback&&(o.recordingCallback(o.blob),o.recordingCallback=null)))},s.onerror=function(e){t.disableLogs||(-1!==e.name.toString().toLowerCase().indexOf("invalidstate")?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",e):-1!==e.name.toString().toLowerCase().indexOf("notsupported")?console.error("MIME type (",t.mimeType,") is not supported.",e):-1!==e.name.toString().toLowerCase().indexOf("security")?console.error("MediaRecorder security error",e):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),function(e){if(!o.manuallyStopped&&s&&"inactive"===s.state)return delete t.timeslice,void s.start(6e5);setTimeout(e,1e3)}(),"inactive"!==s.state&&"stopped"!==s.state&&s.stop()},"number"==typeof t.timeSlice?(n(),s.start(t.timeSlice)):s.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[],this.stop=function(e){o.manuallyStopped=!0,s&&(this.recordingCallback=function(t){o.clearRecordedData(),e&&e(t)},"recording"===s.state&&s.stop(),"number"==typeof t.timeSlice&&setTimeout(function(){o.blob=new Blob(r,{type:t.mimeType||"video/webm"}),o.recordingCallback(o.blob)},100))},this.pause=function(){s&&"recording"===s.state&&s.pause()},this.resume=function(){s&&"paused"===s.state&&s.resume()},this.clearRecordedData=function(){r=[],s=null,o.timestamps=[]};var s;this.blob=null,this.getState=function(){return s?s.state||"inactive":"inactive"},void 0===t.checkForInactiveTracks&&(t.checkForInactiveTracks=!1);var o=this;!function e(){if(s&&!1!==t.checkForInactiveTracks)return!1===i()?(t.disableLogs||console.log("MediaStream seems stopped."),void o.stop()):void setTimeout(e,1e3)}()}/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */
function d(e,t){function n(){if(!1===t.checkForInactiveTracks)return!0;if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}function i(e,t){function n(e,t){function n(e,t,n){var o=Math.round(e.length*(t/n)),a=[],r=Number((e.length-1)/(o-1));a[0]=e[0];for(var s=1;s<o-1;s++){var l=s*r,u=Number(Math.floor(l)).toFixed(),c=Number(Math.ceil(l)).toFixed(),d=l-u;a[s]=i(e[u],e[c],d)}return a[o-1]=e[e.length-1],a}function i(e,t,n){return e+(t-e)*n}function o(e,t){for(var n=new Float64Array(t),i=0,o=e.length,a=0;a<o;a++){var r=e[a];n.set(r,i),i+=r.length}return n}function a(e,t){for(var n=e.length+t.length,i=new Float64Array(n),o=0,a=0;a<n;)i[a++]=e[o],i[a++]=t[o],o++;return i}function r(e,t,n){for(var i=n.length,o=0;o<i;o++)e.setUint8(t+o,n.charCodeAt(o))}var s=e.numberOfAudioChannels,l=e.leftBuffers.slice(0),u=e.rightBuffers.slice(0),c=e.sampleRate,d=e.internalInterleavedLength,m=e.desiredSampRate;2===s&&(l=o(l,d),u=o(u,d),m&&(l=n(l,m,c),u=n(u,m,c))),1===s&&(l=o(l,d),m&&(l=n(l,m,c))),m&&(c=m);var g;2===s&&(g=a(l,u)),1===s&&(g=l);var h=g.length,p=44+2*h,f=new ArrayBuffer(p),v=new DataView(f);r(v,0,"RIFF"),v.setUint32(4,44+2*h,!0),r(v,8,"WAVE"),r(v,12,"fmt "),v.setUint32(16,16,!0),v.setUint16(20,1,!0),v.setUint16(22,s,!0),v.setUint32(24,c,!0),v.setUint32(28,2*c,!0),v.setUint16(32,2*s,!0),v.setUint16(34,16,!0),r(v,36,"data"),v.setUint32(40,2*h,!0);for(var b=h,y=44,k=1,A=0;A<b;A++)v.setInt16(y,g[A]*(32767*k),!0),y+=2;if(t)return t({buffer:f,view:v});postMessage({buffer:f,view:v})}if(!_)return void n(e,function(e){t(e.buffer,e.view)});var i=o(n);i.onmessage=function(e){t(e.data.buffer,e.data.view),w.revokeObjectURL(i.workerURL)},i.postMessage(e)}function o(e){var t=w.createObjectURL(new Blob([e.toString(),";this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"})),n=new Worker(t);return n.workerURL=t,n}function a(e){if(!y){if(!1===n()&&(t.disableLogs||console.log("MediaStream seems stopped."),r.disconnect(),c=!1),!c)return void p.disconnect();k||(k=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var i=e.inputBuffer.getChannelData(0);if(l.push(new Float32Array(i)),2===m){var o=e.inputBuffer.getChannelData(1);u.push(new Float32Array(o))}d+=v,s.recordingLength=d}}if(!e.getAudioTracks().length)throw"Your stream has no audio tracks.";t=t||{};var r,s=this,l=[],u=[],c=!1,d=0,m=2,g=t.desiredSampRate;!0===t.leftChannel&&(m=1),1===t.numberOfAudioChannels&&(m=1),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: ",m),void 0===t.checkForInactiveTracks&&(t.checkForInactiveTracks=!0),this.record=function(){if(!1===n())throw"Please make sure MediaStream is active.";l.length=u.length=0,d=0,p&&p.connect(r),k=y=!1,c=!0},this.stop=function(e){c=!1,i({desiredSampRate:g,sampleRate:b,numberOfAudioChannels:m,internalInterleavedLength:d,leftBuffers:l,rightBuffers:1===m?[]:u},function(t,n){s.blob=new Blob([n],{type:"audio/wav"}),s.buffer=new ArrayBuffer(n.buffer.byteLength),s.view=n,s.sampleRate=g||b,s.bufferSize=v,s.length=d,e&&e(s.blob),k=!1})},L.AudioContextConstructor||(L.AudioContextConstructor=new L.AudioContext);var h=L.AudioContextConstructor,p=h.createMediaStreamSource(e),f=[0,256,512,1024,2048,4096,8192,16384],v=void 0===t.bufferSize?4096:t.bufferSize;if(-1===f.indexOf(v)&&(t.disableLogs||console.warn("Legal values for buffer-size are "+JSON.stringify(f,null,"\t"))),h.createJavaScriptNode)r=h.createJavaScriptNode(v,m,m);else{if(!h.createScriptProcessor)throw"WebAudio API has no support on this browser.";r=h.createScriptProcessor(v,m,m)}p.connect(r),t.bufferSize||(v=r.bufferSize);var b=void 0!==t.sampleRate?t.sampleRate:h.sampleRate||44100;(b<22050||b>96e3)&&(t.disableLogs||console.warn("sample-rate must be under range 22050 and 96000.")),t.disableLogs||(console.log("sample-rate",b),console.log("buffer-size",v),t.desiredSampRate&&console.log("Desired sample-rate",t.desiredSampRate));var y=!1;this.pause=function(){y=!0},this.resume=function(){if(!1===n())throw"Please make sure MediaStream is active.";if(!c)return t.disableLogs||console.log("Seems recording has been restarted."),void this.record();y=!1},this.clearRecordedData=function(){this.pause(),l.length=u.length=0,d=0};var k=!1;r.onaudioprocess=a,r.connect(h.destination),this.leftchannel=l,this.rightchannel=u,this.numberOfAudioChannels=m,this.desiredSampRate=g,this.sampleRate=b}/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */
function m(e,t){function n(){var t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),t}function i(){if(m)return g=(new Date).getTime(),setTimeout(i,500);if("canvas"===e.nodeName.toLowerCase()){var o=(new Date).getTime()-g;return g=(new Date).getTime(),h.frames.push({image:n(),duration:o}),void(d&&setTimeout(i,t.frameInterval))}html2canvas(e,{grabMouse:void 0===t.showMousePointer||t.showMousePointer,onrendered:function(e){var n=(new Date).getTime()-g;if(!n)return setTimeout(i,t.frameInterval);g=(new Date).getTime(),h.frames.push({image:e.toDataURL("image/webp",1),duration:n}),d&&setTimeout(i,t.frameInterval)}})}if("undefined"==typeof html2canvas&&"canvas"!==e.nodeName.toLowerCase())throw"Please link: https://cdn.webrtc-experiment.com/screenshot.js";t=t||{},t.frameInterval||(t.frameInterval=10);var o=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){e in document.createElement("canvas")&&(o=!0)});var a=!(!window.webkitRTCPeerConnection&&!window.webkitGetUserMedia||!window.chrome),r=50,s=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);a&&s&&s[2]&&(r=parseInt(s[2],10)),a&&r<52&&(o=!1);var l,u;if(o)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),e instanceof HTMLCanvasElement)l=e;else{if(!(e instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";l=e.canvas}else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var d;this.record=function(){if(d=!0,o){var e;"captureStream"in l?e=l.captureStream(25):"mozCaptureStream"in l?e=l.mozCaptureStream(25):"webkitCaptureStream"in l&&(e=l.webkitCaptureStream(25));try{var n=new T;n.addTrack(e.getVideoTracks()[0]),e=n}catch(e){}if(!e)throw"captureStream API are NOT available.";u=new c(e,{mimeType:"video/webm"}),u.record()}else h.frames=[],g=(new Date).getTime(),i();t.initCallback&&t.initCallback()},this.getWebPImages=function(n){if("canvas"!==e.nodeName.toLowerCase())return void n();var i=h.frames.length;h.frames.forEach(function(e,n){var o=i-n;t.disableLogs||console.log(o+"/"+i+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(o,i);var a=e.image.toDataURL("image/webp",1);h.frames[n].image=a}),t.disableLogs||console.log("Generating WebM"),n()},this.stop=function(e){d=!1;var n=this;if(o&&u)return void u.stop(e);this.getWebPImages(function(){h.compile(function(i){t.disableLogs||console.log("Recording finished!"),n.blob=i,n.blob.forEach&&(n.blob=new Blob([],{type:"video/webm"})),e&&e(n.blob),h.frames=[]})})};var m=!1;this.pause=function(){if(m=!0,u instanceof c)return void u.pause()},this.resume=function(){if(m=!1,u instanceof c)return void u.resume();d||this.record()},this.clearRecordedData=function(){this.pause(),h.frames=[]};var g=(new Date).getTime(),h=new I.Video(100)}/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */
function g(e,t){function n(e){e=void 0!==e?e:10;var t=(new Date).getTime()-l;return t?r?(l=(new Date).getTime(),setTimeout(n,100)):(l=(new Date).getTime(),s.paused&&s.play(),d.drawImage(s,0,0,c.width,c.height),u.frames.push({duration:t,image:c.toDataURL("image/webp")}),void(a||setTimeout(n,e,e))):setTimeout(n,e,e)}function i(e){var t=-1,n=e.length;!function i(){if(++t===n)return void e.callback();setTimeout(function(){e.functionToLoop(i,t)},1)}()}function o(e,t,n,o,a){var r=document.createElement("canvas");r.width=c.width,r.height=c.height;var s=r.getContext("2d"),l=[],u=-1===t,d=t&&t>0&&t<=e.length?t:e.length,m={r:0,g:0,b:0},g=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),h=n&&n>=0&&n<=1?n:0,p=o&&o>=0&&o<=1?o:0,f=!1;i({length:d,functionToLoop:function(t,n){var i,o,a,r=function(){!f&&a-i<=a*p||(u&&(f=!0),l.push(e[n])),t()};if(f)r();else{var d=new Image;d.onload=function(){s.drawImage(d,0,0,c.width,c.height);var e=s.getImageData(0,0,c.width,c.height);i=0,o=e.data.length,a=e.data.length/4;for(var t=0;t<o;t+=4){var n={r:e.data[t],g:e.data[t+1],b:e.data[t+2]};Math.sqrt(Math.pow(n.r-m.r,2)+Math.pow(n.g-m.g,2)+Math.pow(n.b-m.b,2))<=g*h&&i++}r()},d.src=e[n].image}},callback:function(){l=l.concat(e.slice(d)),l.length<=0&&l.push(e[e.length-1]),a(l)}})}t=t||{},t.frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),c.width=t.canvas.width||320,c.height=t.canvas.height||240,d=c.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(s=t.video.cloneNode(),t.initCallback&&t.initCallback()):(s=document.createElement("video"),void 0!==s.srcObject?s.srcObject=e:s.src=w.createObjectURL(e),s.onloadedmetadata=function(){t.initCallback&&t.initCallback()},s.width=t.video.width,s.height=t.video.height),s.muted=!0,s.play(),l=(new Date).getTime(),u=new I.Video,t.disableLogs||(console.log("canvas resolutions",c.width,"*",c.height),console.log("video width/height",s.width||c.width,"*",s.height||c.height)),n(t.frameInterval)};var a=!1;this.stop=function(e){a=!0;var n=this;setTimeout(function(){o(u.frames,-1,null,null,function(i){u.frames=i,t.advertisement&&t.advertisement.length&&(u.frames=t.advertisement.concat(u.frames)),u.compile(function(t){n.blob=t,n.blob.forEach&&(n.blob=new Blob([],{type:"video/webm"})),e&&e(n.blob)})})},10)};var r=!1;this.pause=function(){r=!0},this.resume=function(){r=!1,a&&this.record()},this.clearRecordedData=function(){this.pause(),u.frames=[]};var s,l,u,c=document.createElement("canvas"),d=c.getContext("2d")}/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */
function h(e,t){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";t=t||{};var n=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement;this.record=function(){function e(s){if(i)return setTimeout(function(){e(s)},100);d=y(e),void 0===typeof u&&(u=s),s-u<90||(!n&&r.paused&&r.play(),n||a.drawImage(r,0,0,o.width,o.height),t.onGifPreview&&t.onGifPreview(o.toDataURL("image/png")),c.addFrame(a),u=s)}n||(t.width||(t.width=r.offsetWidth||320),this.height||(t.height=r.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),o.width=t.canvas.width||320,o.height=t.canvas.height||240,r.width=t.video.width||320,r.height=t.video.height||240),c=new GIFEncoder,c.setRepeat(0),c.setDelay(t.frameRate||200),c.setQuality(t.quality||10),c.start(),s=Date.now();d=y(e),t.initCallback&&t.initCallback()},this.stop=function(){d&&A(d),l=Date.now(),this.blob=new Blob([new Uint8Array(c.stream().bin)],{type:"image/gif"}),c.stream().bin=[]};var i=!1;this.pause=function(){i=!0},this.resume=function(){i=!1},this.clearRecordedData=function(){c&&(this.pause(),c.stream().bin=[])};var o=document.createElement("canvas"),a=o.getContext("2d");if(n&&(e instanceof CanvasRenderingContext2D?(a=e,o=a.canvas):e instanceof HTMLCanvasElement&&(a=e.getContext("2d"),o=e)),!n){var r=document.createElement("video");r.muted=!0,r.autoplay=!0,void 0!==r.srcObject?r.srcObject=e:r.src=w.createObjectURL(e),r.play()}var s,l,u,c,d=null}/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */
function p(e,t){function n(){L.AudioContextConstructor||(L.AudioContextConstructor=new L.AudioContext),l.audioContext=L.AudioContextConstructor,l.audioSources=[],l.gainNode=l.audioContext.createGain(),l.gainNode.connect(l.audioContext.destination),l.gainNode.gain.value=0;var t=0;if(e.forEach(function(e){if(e.getAudioTracks().length){t++;var n=l.audioContext.createMediaStreamSource(e);n.connect(l.gainNode),l.audioSources.push(n)}}),t)return l.audioDestination=l.audioContext.createMediaStreamDestination(),l.audioSources.forEach(function(e){e.connect(l.audioDestination)}),l.audioDestination.stream}function i(n){d=[],n=n||e,n.forEach(function(e){if(e.getVideoTracks().length){var n=a(e);n.width=t.video.width,n.height=t.video.height,n.stream=e,d.push(n)}})}function o(){i();var e;"captureStream"in g?e=g.captureStream():"mozCaptureStream"in g?e=g.mozCaptureStream():t.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var n=new T;return e.getVideoTracks().forEach(function(e){n.addTrack(e)}),g.stream=n,n}function a(e){var t=document.createElement("video");return t.src=w.createObjectURL(e),t.muted=!0,t.volume=0,t.play(),t}function r(){if(!m){var e=d.length,n=!1;d.forEach(function(e){e.stream||(e.stream={}),e.stream.fullcanvas&&(n=e.stream)}),n?(g.width=n.width,g.height=n.height):(g.width=e>1?2*d[0].width:d[0].width,g.height=e>2?2*d[0].height:d[0].height),d.forEach(s),setTimeout(r,t.frameInterval)}}function s(e,t){if(!m){var n=0,i=0,o=e.width,a=e.height;1===t&&(n=e.width),2===t&&(i=e.height),3===t&&(n=e.width,i=e.height),void 0!==e.stream.left&&(n=e.stream.left),void 0!==e.stream.top&&(i=e.stream.top),void 0!==e.stream.width&&(o=e.stream.width),void 0!==e.stream.height&&(a=e.stream.height),h.drawImage(e,n,i,o,a),"function"==typeof e.stream.onRender&&e.stream.onRender(h,n,i,o,a,t)}}var l=this;t=t||{mimeType:"video/webm",video:{width:360,height:240}},t.frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){m=!1;var e=o(),i=n();i&&i.getAudioTracks().forEach(function(t){e.addTrack(t)}),t.previewStream&&"function"==typeof t.previewStream&&t.previewStream(e),u=new c(e,t),r(),u.record()},this.stop=function(e){m=!0,u&&u.stop(function(t){e(t),l.clearRecordedData()})};var u,d=[],m=!1,g=document.createElement("canvas"),h=g.getContext("2d");g.style="opacity:0;position:absolute;z-index:-1;top: -100000000;left:-1000000000;",(document.body||document.documentElement).appendChild(g),this.pause=function(){u&&u.pause()},this.resume=function(){u&&u.resume()},this.clearRecordedData=function(){d=[],m=!0,u&&u.clearRecordedData(),u=null,l.gainNode&&(l.gainNode.disconnect(),l.gainNode=null),l.audioSources.length&&(l.audioSources.forEach(function(e){e.disconnect()}),l.audioSources=[]),l.audioDestination&&(l.audioDestination.disconnect(),l.audioDestination=null),l.audioContext=null,h.clearRect(0,0,g.width,g.height),g.stream&&(g.stream.stop(),g.stream=null)},this.addStreams=function(n){if(!n)throw"First parameter is required.";n instanceof Array||(n=[n]),e.concat(n),u&&n.forEach(function(e){if(e.getVideoTracks().length){var n=a(e);n.width=t.video.width,n.height=t.video.height,n.stream=e,d.push(n)}if(e.getAudioTracks().length&&l.audioContext){var i=l.audioContext.createMediaStreamSource(e);i.connect(l.audioDestination),l.audioSources.push(i)}})},this.resetVideoStreams=function(e){!e||e instanceof Array||(e=[e]),i(e)}}/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires module:RecordRTC
 */
function f(e,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(void 0===e)throw'First argument "MediaStream" is required.';var n=this;n.recordRTC=new i(e,t),this.startRecording=function(){return new Promise(function(e,t){try{n.recordRTC.startRecording(),e()}catch(e){t(e)}})},this.stopRecording=function(){return new Promise(function(e,t){try{n.recordRTC.stopRecording(function(t){n.blob=n.recordRTC.getBlob(),e(t)})}catch(e){t(e)}})},this.getDataURL=function(e){return new Promise(function(e,t){try{n.recordRTC.getDataURL(function(t){e(t)})}catch(e){t(e)}})},this.getBlob=function(){return n.recordRTC.getBlob()},this.blob=null}var v,b;i.getFromDisk=function(e,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+("all"===e?"blobs":e+" blob ")+" from disk!"),x.Fetch(function(n,i){"all"!==e&&i===e+"Blob"&&t&&t(n),"all"===e&&t&&t(n,i.replace("Blob",""))})},i.writeToDisk=function(e){console.log("Writing recorded blob(s) to disk!"),e=e||{},e.audio&&e.video&&e.gif?e.audio.getDataURL(function(t){e.video.getDataURL(function(n){e.gif.getDataURL(function(e){x.Store({audioBlob:t,videoBlob:n,gifBlob:e})})})}):e.audio&&e.video?e.audio.getDataURL(function(t){e.video.getDataURL(function(e){x.Store({audioBlob:t,videoBlob:e})})}):e.audio&&e.gif?e.audio.getDataURL(function(t){e.gif.getDataURL(function(e){x.Store({audioBlob:t,gifBlob:e})})}):e.video&&e.gif?e.video.getDataURL(function(t){e.gif.getDataURL(function(e){x.Store({videoBlob:t,gifBlob:e})})}):e.audio?e.audio.getDataURL(function(e){x.Store({audioBlob:e})}):e.video?e.video.getDataURL(function(e){x.Store({videoBlob:e})}):e.gif&&e.gif.getDataURL(function(e){x.Store({gifBlob:e})})},e.exports=i,v=[],void 0!==(b=function(){return i}.apply(t,v))&&(e.exports=b),r.getFromDisk=i.getFromDisk,r.writeToDisk=i.writeToDisk,void 0!==i&&(i.MRecordRTC=r),function(e){e&&"undefined"==typeof window&&void 0!==n&&(n.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},n.console||(n.console={}),void 0!==n.console.log&&void 0!==n.console.error||(n.console.error=n.console.log=n.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(e.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""}};return e},e.HTMLVideoElement=function(){}),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}),void 0===w&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=n)}(void 0!==n?n:null);var y=window.requestAnimationFrame;if(void 0===y)if("undefined"!=typeof webkitRequestAnimationFrame)y=webkitRequestAnimationFrame;else if("undefined"!=typeof mozRequestAnimationFrame)y=mozRequestAnimationFrame;else if("undefined"!=typeof msRequestAnimationFrame)y=msRequestAnimationFrame;else if(void 0===y){var k=0;y=function(e,t){var n=(new Date).getTime(),i=Math.max(0,16-(n-k)),o=setTimeout(function(){e(n+i)},i);return k=n+i,o}}var A=window.cancelAnimationFrame;void 0===A&&("undefined"!=typeof webkitCancelAnimationFrame?A=webkitCancelAnimationFrame:"undefined"!=typeof mozCancelAnimationFrame?A=mozCancelAnimationFrame:"undefined"!=typeof msCancelAnimationFrame?A=msCancelAnimationFrame:void 0===A&&(A=function(e){clearTimeout(e)}));var S=window.AudioContext;void 0===S&&("undefined"!=typeof webkitAudioContext&&(S=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(S=mozAudioContext));var w=window.URL;void 0===w&&"undefined"!=typeof webkitURL&&(w=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var E=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),C=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),_=!C&&!E&&!!navigator.webkitGetUserMedia,T=window.MediaStream;void 0===T&&"undefined"!=typeof webkitMediaStream&&(T=webkitMediaStream),void 0!==T&&("getVideoTracks"in T.prototype||(T.prototype.getVideoTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach(function(t){-1!==t.kind.toString().indexOf("video")&&e.push(t)}),e},T.prototype.getAudioTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach(function(t){-1!==t.kind.toString().indexOf("audio")&&e.push(t)}),e}),T.prototype.__stop=T.prototype.stop,T.prototype.stop=function(){this.getAudioTracks().forEach(function(e){e.stop&&e.stop()}),this.getVideoTracks().forEach(function(e){e.stop&&e.stop()}),"function"==typeof this.__stop&&this.__stop()});/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */
var L={};void 0!==S?L.AudioContext=S:"undefined"!=typeof webkitAudioContext&&(L.AudioContext=webkitAudioContext),void 0!==i&&(i.Storage=L),void 0!==i&&(i.MediaStreamRecorder=c),void 0!==i&&(i.StereoAudioRecorder=d),void 0!==i&&(i.CanvasRecorder=m),void 0!==i&&(i.WhammyRecorder=g);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */
var I=function(){function e(e){this.frames=[],this.duration=e||1,this.quality=.8}function t(e){var t=w.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"})),n=new Worker(t);return w.revokeObjectURL(t),n}function n(e){function t(e){var t=i(e);if(!t)return[];for(var o=3e4,a=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:m(t.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:t.width,id:176},{data:t.height,id:186}]}]}]}]}],r=0,l=0;r<e.length;){var u=[],c=0;do{u.push(e[r]),c+=e[r].duration,r++}while(r<e.length&&c<o);var d=0,g={id:524531317,data:n(l,d,u)};a[1].data.push(g),l+=c}return s(a)}function n(e,t,n){return[{data:e,id:231}].concat(n.map(function(e){var n=l({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:n,id:163}}))}function i(e){if(!e[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var t=e[0].width,n=e[0].height,i=e[0].duration,o=1;o<e.length;o++)i+=e[o].duration;return{duration:i,width:t,height:n}}function o(e){for(var t=[];e>0;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function a(e){return new Uint8Array(e.split("").map(function(e){return e.charCodeAt(0)}))}function r(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var n=0;n<e.length;n+=8)t.push(parseInt(e.substr(n,8),2));return new Uint8Array(t)}function s(e){for(var t=[],n=0;n<e.length;n++){var i=e[n].data;"object"==typeof i&&(i=s(i)),"number"==typeof i&&(i=r(i.toString(2))),"string"==typeof i&&(i=a(i));var l=i.size||i.byteLength||i.length,u=Math.ceil(Math.ceil(Math.log(l)/Math.log(2))/8),c=l.toString(2),d=new Array(7*u+7+1-c.length).join("0")+c,m=new Array(u).join("0")+"1"+d;t.push(o(e[n].id)),t.push(r(m)),t.push(i)}return new Blob(t,{type:"video/webm"})}function l(e){var t=0;if(e.keyframe&&(t|=128),e.invisible&&(t|=8),e.lacing&&(t|=e.lacing<<1),e.discardable&&(t|=1),e.trackNum>127)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map(function(e){return String.fromCharCode(e)}).join("")+e.frame}function u(e){for(var t=e.RIFF[0].WEBP[0],n=t.indexOf("*"),i=0,o=[];i<4;i++)o[i]=t.charCodeAt(n+3+i);var a,r,s;return s=o[1]<<8|o[0],a=16383&s,s=o[3]<<8|o[2],r=16383&s,{width:a,height:r,data:t,riff:e}}function c(e,t){return parseInt(e.substr(t+4,4).split("").map(function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t}).join(""),2)}function d(e){for(var t=0,n={};t<e.length;){var i=e.substr(t,4),o=c(e,t),a=e.substr(t+4+4,o);t+=8+o,n[i]=n[i]||[],"RIFF"===i||"LIST"===i?n[i].push(d(a)):n[i].push(a)}return n}function m(e){return[].slice.call(new Uint8Array(new Float64Array([e]).buffer),0).map(function(e){return String.fromCharCode(e)}).reverse().join("")}var g=new t(e.map(function(e){var t=u(d(atob(e.image.slice(23))));return t.duration=e.duration,t}));postMessage(g)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var i=t(n);i.onmessage=function(t){if(t.data.error)return void console.error(t.data.error);e(t.data)},i.postMessage(this.frames)},{Video:e}}();void 0!==i&&(i.Whammy=I);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
 * @author {@link http://www.MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */
var x={init:function(){function e(e){e.createObjectStore(n.dataStoreName)}function t(){function e(e){t.objectStore(n.dataStoreName).get(e).onsuccess=function(t){n.callback&&n.callback(t.target.result,e)}}var t=i.transaction([n.dataStoreName],"readwrite");n.videoBlob&&t.objectStore(n.dataStoreName).put(n.videoBlob,"videoBlob"),n.gifBlob&&t.objectStore(n.dataStoreName).put(n.gifBlob,"gifBlob"),n.audioBlob&&t.objectStore(n.dataStoreName).put(n.audioBlob,"audioBlob"),e("audioBlob"),e("videoBlob"),e("gifBlob")}var n=this;if("undefined"==typeof indexedDB||void 0===indexedDB.open)return void console.error("IndexedDB API are not available in this browser.");var i,o=1,a=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),r=indexedDB.open(a,o);r.onerror=n.onError,r.onsuccess=function(){if(i=r.result,i.onerror=n.onError,i.setVersion)if(i.version!==o){var a=i.setVersion(o);a.onsuccess=function(){e(i),t()}}else t();else t()},r.onupgradeneeded=function(t){e(t.target.result)}},Fetch:function(e){return this.callback=e,this.init(),this},Store:function(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function(e){console.error(JSON.stringify(e,null,"\t"))},dataStoreName:"recordRTC",dbName:null};void 0!==i&&(i.DiskStorage=x),void 0!==i&&(i.GifRecorder=h),void 0!==i&&(i.MultiStreamRecorder=p),void 0!==i&&(i.RecordRTCPromisesHandler=f)}).call(t,n(381))},function(e,t,n){var i=n(290);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},,function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(){o()(this,e)}return r()(e,null,[{key:"formatNumber",value:function(e,t){return e%1==0?e.toString():e.toFixed(t,1)}},{key:"shortenNumber",value:function(t,n,i){var o="",a=i||"";return t>1e9?(t/=1e9,o="B"):t>1e6?(t/=1e6,o="M"):t>1e3&&(t/=1e3,o="K"),e.formatNumber(t,n)+o+a}},{key:"formatPercentRate",value:function(t,n){return 0==t||0==n?"0":e.formatNumber(100*t/n,1)}},{key:"getPercentRate",value:function(e,t){return 0==e||0==t?0:e/t}},{key:"getPercentChange",value:function(e,t){return 0==e||0==t?0:(e-t)/t*100}},{key:"isAllParamsSelected",value:function(e){return e.agentKey&&e.platform&&e.version&&(e.period||e.from&&e.to)}},{key:"getPeriod",value:function(e){if(!e.from||!e.to)return e.period||30}},{key:"getStartTime",value:function(e){if(!e.period&&e.from&&e.to)return e.from}},{key:"getEndTime",value:function(e){if(!e.period&&e.from&&e.to)return e.to}},{key:"percentDelta",value:function(e,t){return 0==e||0==t?0:(e-t)/t*100}},{key:"getInterceptor",value:function(){return this.httpInterceptor||(this.httpInterceptor=angular.element(document.body).injector().get("httpInterceptor")),this.httpInterceptor}}]),e}();s.httpInterceptor=null},function(e,t,n){var i=n(40),o=n(258),a=n(257),r=n(22),s=n(87),l=n(112),u={},c={},t=e.exports=function(e,t,n,d,m){var g,h,p,f,v=m?function(){return e}:l(e),b=i(n,d,t?2:1),y=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(a(v)){for(g=s(e.length);g>y;y++)if((f=t?b(r(h=e[y])[0],h[1]):b(e[y]))===u||f===c)return f}else for(p=v.call(e);!(h=p.next()).done;)if((f=o(p,b,h.value,t))===u||f===c)return f};t.BREAK=u,t.RETURN=c},function(e,t,n){e.exports={default:n(250),__esModule:!0}},function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var i=n(30);e.exports=function(e,t,n){for(var o in t)n&&e[o]?e[o]=t[o]:i(e,o,t[o]);return e}},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(t,n){o()(this,e),this.googleAssistantPersistence=t,this.$mdDialog=n}return e.$inject=["googleAssistantPersistence","$mdDialog"],r()(e,[{key:"showProjectLinkPopup",value:function(e){return this.checkScope().then(this.makeShowProjectLinkPopup.bind(this,e))}},{key:"showInsuffisientPermissionsPopup",value:function(){return this.$mdDialog.show({controllerAs:"vm",template:"<authorize-google-popup></authorize-google-popup>"})}},{key:"checkScope",value:function(){var e=this;return this.googleAssistantPersistence.checkGCPOauthTokenScope().catch(function(){return e.showInsuffisientPermissionsPopup().then(e.checkScope.bind(e))})}},{key:"getHrefToGCP",value:function(t){return e.DEFAULT_HREF_TO_GCP.replace("[PROJECT_ID]",t)}},{key:"getOverviewHrefToAOGConsole",value:function(t){return e.DEFAULT_V2_AGENT_IMPORT_HREF.replace("[PROJECT_ID]",t)}},{key:"getLinkToGCP",value:function(t,n){return e.DEFAULT_LINK_TO_GCP.replace("[PROJECT_ID]",t).replace("[PROJECT_NAME]",n||t)}},{key:"getLinkToGcpServiceAccount",value:function(t,n){var i=n.split("/"),o=4===i.length?i[3]:n;return e.DEFAULT_LINK_TO_GCP_SERVICE_ACCOUNT.replace("[PROJECT_ID]",t).replace("[SERVICE_ACCOUNT_EMAIL]",o)}},{key:"getOverviewLinkToAOGConsole",value:function(t,n){return e.DEFAULT_V2_AGENT_SUBMIT_LINK.replace("[PROJECT_ID]",t).replace("[PROJECT_NAME]",n||t)}},{key:"makeShowProjectLinkPopup",value:function(e){return this.$mdDialog.show({controller:["localAgent",function(e){"ngInject";this.agent=e}],controllerAs:"vm",clickOutsideToClose:!0,locals:{localAgent:e},template:"<agent-deep-link-popup agent='vm.agent'></agent-deep-link-popup>"})}}]),e}();s.DEFAULT_HREF_TO_GCP="https://console.cloud.google.com/home/dashboard?project=[PROJECT_ID]",s.DEFAULT_LINK_TO_GCP="<a href='"+s.DEFAULT_HREF_TO_GCP+"' target='_blank'><strong>[PROJECT_NAME]</strong></a>",s.DEFAULT_LINK_TO_GCP_SERVICE_ACCOUNT="<a href='https://console.cloud.google.com/iam-admin/serviceaccounts/project?project=[PROJECT_ID]' target='_blank'><strong>[SERVICE_ACCOUNT_EMAIL]</strong></a>",s.DEFAULT_V2_AGENT_BASE_SUBMIT_HREF="https://console.actions.google.com",s.DEFAULT_V2_AGENT_IMPORT_HREF=s.DEFAULT_V2_AGENT_BASE_SUBMIT_HREF+"/?autoImportProject=[PROJECT_ID]",s.DEFAULT_V2_WEB_SIMULATOR_HREF=s.DEFAULT_V2_AGENT_BASE_SUBMIT_HREF+"/project/[PROJECT_ID]/simulator/",s.DEFAULT_V2_AGENT_SUBMIT_HREF=s.DEFAULT_V2_AGENT_BASE_SUBMIT_HREF+"/project/[PROJECT_ID]/overview/",s.DEFAULT_V2_AGENT_SUBMIT_LINK="<a href='"+s.DEFAULT_V2_AGENT_SUBMIT_HREF+"' target='_blank'><strong>[PROJECT_NAME]</strong></a>"},,,function(e,t,n){"use strict";var i=n(16),o=n(10),a=n(25),r=n(23),s=n(14)("species");e.exports=function(e){var t="function"==typeof o[e]?o[e]:i[e];r&&t&&!t[s]&&a.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(8);n.d(t,"a",function(){return u}),n(358);var l=function(){function e(t,n){var i=this;o()(this,e),this.$timeout=t,this.FileUploader=n,this.uploader=null,this.uploaderCb=function(e,t,n){t&&t.status&&t.ref&&i.$timeout(function(){return i.agent.avatarId=t.ref})},this.onBeforeUploadItem=function(){i.agent.avatarId=null},this.onWhenAddingFileFailed=function(e,t){s.a.error("You can upload only .png files")}}return e.$inject=["$timeout","FileUploader"],r()(e,[{key:"$onInit",value:function(){this.uploader=new this.FileUploader({url:"/api-client/setAvatar/?agentId="+this.agent.id,queueLimit:1,autoUpload:!0,removeAfterUpload:!0,onSuccessItem:this.uploaderCb,onCancelItem:this.uploaderCb,onCompleteItem:this.uploaderCb,onErrorItem:this.onErrorItem,onWhenAddingFileFailed:this.onWhenAddingFileFailed,onAfterAddingFile:this.onAfterAddingFile,onBeforeUploadItem:this.onBeforeUploadItem,filters:[{name:"pngFilesFilter",fn:this.filesFilter.bind(null,".png")}]})}},{key:"getAvatarIdForSize",value:function(e){var t=this.agent.avatarId;return["x","l","s","xs"].forEach(function(n){t=t.replace(n+".png",e+".png")}),t}},{key:"onAfterAddingFile",value:function(){}},{key:"filesFilter",value:function(e,t){if(!t||!t.name)return!1;var n=t.name.toLowerCase();return n.lastIndexOf(e)===n.length-e.length}},{key:"onErrorItem",value:function(){s.a.error("You can upload only .png files")}}]),e}(),u={bindings:{agent:"=",disabled:"<"},template:n(310),controller:l,controllerAs:"vm"}},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(21),h=n(8);n.d(t,"a",function(){return f});var p=function(e){function t(e,n,i,a){r()(this,t);var s=c()(this,(t.__proto__||o()(t)).call(this));return s.$location=e,s.googleProjectLinksManager=n,s.googleAssistantPersistence=i,s.AgentData=a,s.isProjectIdGiven=!1,s.isAssistantCompatible=!1,s.isAssistantTestingAvailable=!1,s}return t.$inject=["$location","googleProjectLinksManager","googleAssistantPersistence","AgentData"],m()(t,e),l()(t,[{key:"$onInit",value:function(){var e=this;!this.isEdit&&this.$location.search()[t.PROJECT_ID_REQUEST_PARAM]&&(this.agent.cloudProjectId=this.$location.search()[t.PROJECT_ID_REQUEST_PARAM],this.$location.search(t.PROJECT_ID_REQUEST_PARAM,null),this.isProjectIdGiven=!0),this.isEdit&&this.agent.cloudProjectId&&this.agent.googleAssistant.googleAssistantCompatible&&this.showLoading().then(function(){return e.googleAssistantPersistence.isProjectCompatible()}).then(function(t){t.v2&&(e.isAssistantCompatible=!0)}).catch(angular.noop).then(this.hideLoading.bind(this))}},{key:"refreshServiceAccountKey",value:function(){var e=this;h.a.info("Working on Google Cloud Service Account"),this.AgentData.refreshServiceAccountKey(this.agent).then(function(t){e.agent=t,h.a.success("New Service Account / Key generated.")})}},{key:"setEnableCceIntegration",value:function(){var e=this;this.AgentData.setEnableCceIntegration(this.agent).then(function(t){e.agent=t})}},{key:"getServiceAccountKeyIdFromName",value:function(e){if(e){var t=e.split("/");return 6===t.length?t[5]:t}return" "}},{key:"getLinkToGCP",value:function(e){return this.googleProjectLinksManager.getLinkToGCP(e)}},{key:"getLinkToGcpServiceAccount",value:function(e,t){return this.googleProjectLinksManager.getLinkToGcpServiceAccount(e,t)}},{key:"getHrefToGCP",value:function(e){return this.googleProjectLinksManager.getHrefToGCP(e)}},{key:"getOverviewHrefToAOGConsole",value:function(e){return this.googleProjectLinksManager.getOverviewHrefToAOGConsole(e)}},{key:"linkAgent",value:function(){this.googleProjectLinksManager.showProjectLinkPopup(this.agent)}}]),t}(g.a);p.PROJECT_ID_REQUEST_PARAM="projectId";var f={bindings:{agent:"=",isEdit:"<"},template:n(311),controller:p,controllerAs:"vm"}},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(8),l=n(27);n.d(t,"a",function(){return c});var u=function(){function e(t,n,i,a,r){o()(this,e),this.CurrentAgentService=t,this.$timeout=n,this.$mdDialog=i,this.googleAssistantPersistence=a,this.googleProjectLinksManager=r,this.viewState={isLinked:!1,isLoading:!1}}return e.$inject=["CurrentAgentService","$timeout","$mdDialog","googleAssistantPersistence","googleProjectLinksManager"],r()(e,[{key:"$onInit",value:function(){this.fakeAgent=new l.a(this.agent)}},{key:"linkToGCP",value:function(){var e=this;this.viewState.isLoading=!0;var t=this.fakeAgent.cloudProjectId?this.fakeAgent.cloudProjectId:null;this.googleAssistantPersistence.enableSharing(this.fakeAgent.id,t).then(this.resolveLinkToGCPPromise.bind(this)).catch(s.a.stdError).finally(function(){e.$timeout(function(){return e.viewState.isLoading=!1})})}},{key:"getLinkToGCP",value:function(e,t){return this.googleProjectLinksManager.getLinkToGCP(e,t)}},{key:"closeDialog",value:function(){this.$mdDialog.hide()}},{key:"cancelDialog",value:function(){this.$mdDialog.cancel()}},{key:"resolveLinkToGCPPromise",value:function(){var e=this;return this.CurrentAgentService.updateCurrentAgentFromServer().then(function(t){e.agent.cloudProjectId=t.data.agent.cloudProjectId,e.fakeAgent.cloudProjectId=t.data.agent.cloudProjectId,e.$timeout(function(){return e.viewState.isLinked=!0})}).catch(s.a.stdError)}}]),e}(),c={bindings:{agent:"="},template:n(312),controller:u,controllerAs:"vm"}},function(e,t,n){"use strict";var i=n(39),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(8);n.d(t,"a",function(){return d});var c=function(){function e(t,n,i){r()(this,e),this.$timeout=t,this.googleAssistantPersistence=n,this.googleProjectLinksManager=i,this.viewState={isLoading:!1}}return e.$inject=["$timeout","googleAssistantPersistence","googleProjectLinksManager"],l()(e,[{key:"$onInit",value:function(){var e=this;if(this.unassignedProjects&&o()(this.unassignedProjects).length)return void(this.projectLinks=this.unassignedProjects);this.viewState.isLoading=!0,this.googleProjectLinksManager.checkScope().then(this.initUnassignedProjects.bind(this)).catch(function(){u.a.error("Can not get project list from Google Cloud"),e.$timeout(function(){return e.viewState.isLoading=!1})})}},{key:"getLinkToGCP",value:function(e,t){return this.googleProjectLinksManager.getLinkToGCP(e,t)}},{key:"getOverviewLinkToAOGConsole",value:function(e){return this.googleProjectLinksManager.getOverviewLinkToAOGConsole(e)}},{key:"initUnassignedProjects",value:function(){var e=this;this.googleAssistantPersistence.listUnAssignedProjects().then(function(t){e.$timeout(function(){e.projectLinks=0===o()(t).length?null:t,!e.agent.cloudProjectId||e.projectLinks&&e.projectLinks[e.agent.cloudProjectId]?e.isProjectIdGiven&&e.projectLikIsAogCompatible(e.projectLinks[e.agent.cloudProjectId].version)&&(e.agent.googleAssistant.googleAssistantCompatible=!0):(e.agent.cloudProjectId=null,e.isProjectIdGiven=!1),e.isProjectIdGiven&&(e.agent.name=e.projectLinks[e.agent.cloudProjectId].projectName.replace(/\s+/g,"-")),e.viewState.isLoading=!1})})}},{key:"projectLikIsAogCompatible",value:function(e){return"v2"===e||"v1"===e}}]),e}(),d={bindings:{agent:"=",isProjectIdGiven:"=",unassignedProjects:"<"},template:n(313),controller:c,controllerAs:"vm"}},function(e,t,n){"use strict";var i=n(39),o=n.n(i),a=n(2),r=n.n(a),s=n(0),l=n.n(s),u=n(1),c=n.n(u),d=n(4),m=n.n(d),g=n(3),h=n.n(g),p=n(21),f=n(41);n.d(t,"a",function(){return b});var v=function(e){function t(){l()(this,t);var e=m()(this,(t.__proto__||r()(t)).apply(this,arguments));return e.selectedLang=null,e.availableLocalesMaps={},e.activeLocalesMaps={},e.langsCount=0,e.activeLocalesCount=0,e}return h()(t,e),c()(t,[{key:"$onInit",value:function(){this.langsCount=o()(this.langItems).length,this.calculateAvailableLocalesMaps(),this.sortedKeys=o()(this.langItems).sort()}},{key:"calculateAvailableLocalesMaps",value:function(){var e=this;this.availableLocalesMaps={},this.activeLocalesMaps={},this.activeLocalesCount=0;var t=function(t){if(!e.localeItems[t])return"continue";var n={},i={};o()(e.localeItems[t]).forEach(function(o){_.contains(e.agent.getSupportedLanguages().map(function(e){return e.toString()}),o)?(e.activeLocalesCount++,i[o]=e.localeItems[t][o]):n[o]=e.localeItems[t][o]}),o()(n).length&&(e.availableLocalesMaps[t]=n),o()(i).length&&(e.activeLocalesMaps[t]=i)};for(var n in this.langItems){t(n)}}},{key:"onAddLangChange",value:function(){this.agent.addSupportedLanguage(this.selectedLang),this.selectedLang=null}},{key:"getLangName",value:function(e){return this.langItems[e]?this.langItems[e]:e.toString()}},{key:"removeLang",value:function(e){var t=this;return this.localeItems[e]&&o()(this.localeItems[e]).forEach(function(e){t.removeLocale(e)}),this.removeLocale(e)}},{key:"addLocale",value:function(e){this.agent.addSupportedLanguage(e),this.calculateAvailableLocalesMaps()}},{key:"removeLocale",value:function(e){var t=this.agent.getSupportedLanguages(),n=t.indexOf(e);n<0||(t.splice(n,1),this.agent.setSupportedLanguages(t),this.calculateAvailableLocalesMaps())}},{key:"getAgentSupportedLanguages",value:function(){var e=this;return o()(this.langItems).filter(function(t){return _.contains(e.agent.getSupportedLanguages().map(function(e){return e.toString()}),t)&&t!==e.agent.language.toString()})}},{key:"formatLocale",value:function(e){return f.a.formatLocale(e)}}]),t}(p.a);n(359);var b={bindings:{agent:"=",langItems:"=",localeItems:"="},template:n(314),controller:v,controllerAs:"vm"}},function(e,t,n){"use strict";var i=n(157),o=n.n(i),a=n(2),r=n.n(a),s=n(0),l=n.n(s),u=n(1),c=n.n(u),d=n(4),m=n.n(d),g=n(3),h=n.n(g),p=n(21),f=n(8);n.d(t,"a",function(){return S});var v=function(e){function t(e,n){l()(this,t);var i=m()(this,(t.__proto__||r()(t)).call(this));return i.$mdDialog=e,i.runtimePersistence=n,i.runtimeList=[],i.versionList=[],i}return t.$inject=["$mdDialog","runtimePersistence"],h()(t,e),c()(t,[{key:"$onInit",value:function(){this.loadAll(),this.enabledIntegrations=this.getEnabledIntegrations()}},{key:"getEnabledIntegrations",value:function(){var e=this,n=[];return t.integrationsList.forEach(function(t){var i=e.agent[t];i&&i.getEnabled()&&n.push(t)}),n}},{key:"loadAll",value:function(){var e=this;this.showLoading();var t=this.runtimePersistence.listRuntimes(this.agent.id).then(function(t){return e.runtimeList=t}),n=this.runtimePersistence.listVersions(this.agent.id).then(function(t){return e.versionList=t});return o.a.all([t,n]).then(this.hideLoading.bind(this)).then(function(){return o.a.resolve()})}},{key:"deleteRuntime",value:function(e){var t=this,n=this.$mdDialog.confirm();n.title("Are you sure you wan to remove runtime?").ok("Yes").cancel("No"),this.$mdDialog.show(n).then(function(){return t.runtimePersistence.removeRuntime(e).catch(f.a.stdError)}).then(this.loadAll.bind(this)).catch(angular.noop)}},{key:"publishAsNew",value:function(){this.$mdDialog.show({controller:A,controllerAs:"vm",template:n(113),locals:{agent:this.agent,version:null,existing:!1,runtimeList:this.runtimeList}}).then(this.loadAll.bind(this))}},{key:"publishAsExisting",value:function(e){this.$mdDialog.show({controller:A,controllerAs:"vm",template:n(113),locals:{agent:this.agent,version:e,existing:!0,runtimeList:this.runtimeList}}).then(this.loadAll.bind(this))}},{key:"showVersionsPopup",value:function(){this.$mdDialog.show({controller:k,controllerAs:"vm",template:n(318),locals:{versionList:this.versionList,showCreateVersionPopup:this.showCreateVersionPopup.bind(this),publishAsExisting:this.publishAsExisting.bind(this)}}).catch(angular.noop)}},{key:"showRuntimeHistory",value:function(e){this.$mdDialog.show({controller:b,controllerAs:"vm",template:n(316),locals:{runtime:e,versionList:this.versionList}}).catch(angular.noop)}},{key:"showCreateVersionPopup",value:function(){this.$mdDialog.show({controller:y,controllerAs:"vm",template:n(315),locals:{agent:this.agent}}).catch(angular.noop).then(this.loadAll.bind(this)).then(this.showVersionsPopup.bind(this))}},{key:"getVersionComment",value:function(e){var t=this.versionList.find(function(t){return t.version===e});return t&&t.comment?t.comment:""}}]),t}(p.a);v.integrationsList=["googleAssistant","apiai","facebook","slack","slackRest","viber","twitter","twilioip","twilio","skype","tropo","telegram","kik","line","spark","cortana"];var b=function(e){function t(e,n,i,o){l()(this,t);var a=m()(this,(t.__proto__||r()(t)).call(this));return a.runtime=e,a.versionList=n,a.runtimePersistence=i,a.$mdDialog=o,a.runtimeVersions=[],a.showLoading(),a.runtimePersistence.getRuntimeHistory(e).then(function(e){e.forEach(function(e){var t=a.versionList.find(function(t){return t.version===e.agentVersion});t&&a.runtimeVersions.push(t)})}).catch(angular.noop).then(a.hideLoading.bind(a)),a}return t.$inject=["runtime","versionList","runtimePersistence","$mdDialog"],h()(t,e),c()(t,[{key:"revertRuntime",value:function(e){this.showLoading(),this.runtime.agentVersion=e.version,this.runtimePersistence.updateRuntime(this.runtime).catch(angular.noop).then(this.closeDialog.bind(this))}},{key:"closeDialog",value:function(){this.$mdDialog.hide()}}]),t}(p.a),y=function(e){function t(e,n,i){l()(this,t);var o=m()(this,(t.__proto__||r()(t)).call(this));return o.agent=e,o.$mdDialog=n,o.runtimePersistence=i,o.newVersion={agentId:null,version:null,comment:null},o}return t.$inject=["agent","$mdDialog","runtimePersistence"],h()(t,e),c()(t,[{key:"cancelDialog",value:function(){this.$mdDialog.cancel()}},{key:"publishVersion",value:function(){var e=this;this.runtimePersistence.createVersion(this.newVersion.comment,this.agent.id).then(function(){e.$mdDialog.hide()})}}]),t}(p.a),k=function(e){function t(e,n,i,o){l()(this,t);var a=m()(this,(t.__proto__||r()(t)).call(this));return a.showCreateVersionPopup=e,a.publishAsExisting=n,a.versionList=i,a.$mdDialog=o,a}return t.$inject=["showCreateVersionPopup","publishAsExisting","versionList","$mdDialog"],h()(t,e),c()(t,[{key:"cancelDialog",value:function(){this.$mdDialog.cancel()}}]),t}(p.a),A=function(e){function t(e,n,i,o,a,s){l()(this,t);var u=m()(this,(t.__proto__||r()(t)).call(this));return u.$mdDialog=e,u.agent=n,u.runtimePersistence=i,u.version=o,u.existing=a,u.runtimeList=s,u.newRuntime={name:"",agentId:"",comment:null},u}return t.$inject=["$mdDialog","agent","runtimePersistence","version","existing","runtimeList"],h()(t,e),c()(t,[{key:"$onInit",value:function(){this.newRuntime.agentId=this.agent.id}},{key:"cancelDialog",value:function(){this.$mdDialog.cancel()}},{key:"publishRuntime",value:function(){var e=this;if(this.newRuntime.name)if(this.showLoading(),this.existing){var t=null;this.version?(this.newRuntime.agentVersion=this.version.version,t=o.a.resolve()):t=this.runtimePersistence.createVersion(this.newRuntime.comment,this.agent.id).then(function(t){return e.newRuntime.agentVersion=t.version}),t.then(function(){return e.runtimePersistence.updateRuntime(e.newRuntime)}).then(this.$mdDialog.hide.bind(this.$mdDialog)).catch(f.a.stdError)}else this.runtimePersistence.createRuntime(this.agent.id,this.newRuntime.name,this.newRuntime.comment).then(this.$mdDialog.hide.bind(this.$mdDialog)).catch(f.a.stdError)}}]),t}(p.a);n(360);var S={controller:v,template:n(317),controllerAs:"vm",bindings:{agent:"<"}}},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(32);n.d(t,"a",function(){return u});var l=function(){function e(t,n){var i=this;o()(this,e),this.AgentData=n,t.$watch("vm.agent.sampleData",function(e,t){"-- select value --"===e&&(i.agent.sampleData=null)})}return e.$inject=["$scope","AgentData"],r()(e,[{key:"$onInit",value:function(){this.parentCallback.onChangeLanguage=this.updateSamples.bind(this)}},{key:"updateSamples",value:function(){var e=this,t=s.a.SupportedLanguages[this.agent.language];this.AgentData.getSamplesData(t).then(function(t){t.data?e.samplesDataItems=t.data:e.samplesDataItems=null},function(){e.samplesDataItems=null})}}]),e}(),u={bindings:{agent:"=",samplesDataItems:"=",parentCallback:"="},template:n(319),controller:l,controllerAs:"vm"}},function(e,t,n){"use strict";var i=n(39),o=n.n(i),a=n(2),r=n.n(a),s=n(0),l=n.n(s),u=n(1),c=n.n(u),d=n(4),m=n.n(d),g=n(3),h=n.n(g),p=n(21),f=n(8);n.d(t,"a",function(){return b});var v=function(e){function t(e){l()(this,t);var n=m()(this,(t.__proto__||r()(t)).call(this));return n.AgentData=e,n.viewState={isError:!1},n.permissionList={},n.selectedRole=t.DEFAULT_SELECTED_ROLE,n.selectedEmail=null,n.adminList=[],n.savePromise=null,n}return t.$inject=["AgentData"],h()(t,e),c()(t,[{key:"$onInit",value:function(){var e=this;this.checkEverything(),this.userAgentCallbacks.overrideAgentSave=function(){return e.savePromise||(e.savePromise=e.save().finally(function(){return e.savePromise=null})),e.savePromise}}},{key:"$onDestroy",value:function(){this.userAgentCallbacks.overrideAgentSave=null}},{key:"checkEverything",value:function(){return this.showLoading(),this.getPermissions().catch(f.a.stdError).finally(this.hideLoading.bind(this))}},{key:"addUser",value:function(){if(this.selectedEmail&&this.selectedRole){if(this.adminList.indexOf(this.selectedEmail)>-1)return void f.a.error("You can not modify agent administrator permissions");this.permissionList[this.selectedEmail]=this.selectedRole,this.selectedEmail=null}}},{key:"removeUser",value:function(e){this.permissionList[e]=null}},{key:"areConditionsOk",value:function(){return!this.isLoading()&&!this.viewState.isError}},{key:"getPermissions",value:function(){var e=this;return this.permissionList={},this.viewState.isError=!1,this.AgentData.getPermissions(this.agent.id).then(function(t){o()(t).forEach(function(n){"ADMIN"===n?e.adminList=t[n]:t[n].forEach(function(t){e.permissionList[t]=n})})}).catch(function(){return e.viewState.isError=!0})}},{key:"save",value:function(){var e={};for(var t in this.permissionList)this.permissionList.hasOwnProperty(t)&&(e[t]=null!==this.permissionList[t]?[this.permissionList[t]]:[]);return this.showLoading(),this.AgentData.setPermissions(this.agent.id,e).catch(f.a.stdError).then(this.getPermissions.bind(this)).finally(this.hideLoading.bind(this))}}]),t}(p.a);v.DEFAULT_SELECTED_ROLE="REVIEWER",n(361);var b={bindings:{agent:"=",userAgentCallbacks:"="},controller:v,controllerAs:"vm",template:n(320)}},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(21),h=n(41);n.d(t,"a",function(){return f});var p=function(e){function t(e,n){r()(this,t);var i=c()(this,(t.__proto__||o()(t)).call(this));return i.CurrentAgentService=e,i.$state=n,i.showLoading(),i}return t.$inject=["CurrentAgentService","$state"],m()(t,e),l()(t,[{key:"$onInit",value:function(){this.hideLoading()}},{key:"getCurrentLanguage",value:function(){return this.getCurrentAgentLocal()&&this.getCurrentAgentLocal().getSupportedLanguages()?this.CurrentAgentService.getCurrentLanguage():null}},{key:"getRecent",value:function(){var e=this;return this.getCurrentAgentLocal()&&this.getCurrentAgentLocal().getSupportedLanguages()?this.getCurrentAgentLocal().getSupportedLanguages().filter(function(t){return t!==e.CurrentAgentService.getCurrentLanguage()}).slice(0,1):[]}},{key:"getTail",value:function(){var e=this;return this.getCurrentAgentLocal()&&this.getCurrentAgentLocal().getSupportedLanguages()?this.getCurrentAgentLocal().getSupportedLanguages().filter(function(t){return t!==e.CurrentAgentService.getCurrentLanguage()}).slice(1):[]}},{key:"switchLang",value:function(e){var t=this,n=this.CurrentAgentService.getCurrentLanguage();this.setIsLoading(!0).then(function(){t.CurrentAgentService.setCurrentLanguage(e),t.$state.reload().catch(function(){t.CurrentAgentService.setCurrentLanguage(n),t.hideLoading()})})}},{key:"getCurrentAgentLocal",value:function(){return this.CurrentAgentService.getCurrentAgent()}},{key:"getSupportedLanguages",value:function(){var e=this;return this.getCurrentAgentLocal()&&this.getCurrentAgentLocal().getSupportedLanguages()?this.getCurrentAgentLocal().getSupportedLanguages().map(function(t){return e.formatLocale(t)}):[]}},{key:"formatLocale",value:function(e){return h.a.formatLocale(e)}}]),t}(g.a);n(362);var f={template:n(321),bindings:{agent:"<"},controller:p,controllerAs:"vm"}},function(e,t,n){"use strict";var i=n(234),o=n.n(i),a=n(104),r=n.n(a),s=n(2),l=n.n(s),u=n(0),c=n.n(u),d=n(1),m=n.n(d),g=n(4),h=n.n(g),p=n(3),f=n.n(p),v=n(21),b=n(206),y=n(20),k=n(8),A=n(27),S=n(45),w=n(322);n(363);var E={maxLines:40,showPrintMargin:!1},C="Provisioning Cloud Functions for your project... It may take a few minutes",_="Deploying... It may take a few seconds",T=function(e){function t(e,n,i,o,a,r,s,u){c()(this,t);var d=h()(this,(t.__proto__||l()(t)).call(this));return d.$mdDialog=e,d.$window=n,d.$q=i,d.$scope=o,d.AgentData=a,d.CloudFunctionsPersistence=r,d.CurrentAgentService=s,d.unsavedChanges=u,d.deployProgressPromise=null,d.showLastDeployed=!1,d.isDeploying=!1,d.isDeployed=!1,d.isCloudFunctionOfCanonicalForm=!0,d.deployProgressConf={loading:"Deploying...",finished:"Deployed",type:"background-horizontal",recoverytime:2,aftertime:2},d.enableCloudFunctionsPromise=d.$q.resolve(null),d.currentFile=b.a,d.isCodeModified=!1,d}return t.$inject=["$mdDialog","$window","$q","$scope","AgentData","CloudFunctionsPersistence","CurrentAgentService","unsavedChanges"],f()(t,e),m()(t,[{key:"$onInit",value:function(){var e=this;this.showLoading().then(function(){return e.$q.all([e.getFunctionCodeAndInitMetadata(),y.a.handleLazyLoad(n.e(0).then(n.bind(null,83)),y.a.SOURCE.ACE_EDITOR).then(function(){e.indexJsEditor=ace.edit("indexJsTextarea"),e.indexJsEditor.getSession().setMode("ace/mode/javascript"),e.indexJsEditor.setTheme("ace/theme/clouds"),e.indexJsEditor.setOptions(E),e.packageJsonEditor=ace.edit("packageJsonTextarea"),e.packageJsonEditor.getSession().setMode("ace/mode/json"),e.packageJsonEditor.setTheme("ace/theme/clouds"),e.packageJsonEditor.setOptions(E),!e.isAgentReadOnly&&e.agent.webhook.cloudFunctionsEnabled||e.setEditorReadonly(!0)})])}).then(function(t){var n=r()(t,1),i=n[0];e.indexJsEditor.setValue(i.indexJsFile.sourceCode,-1),e.packageJsonEditor.setValue(i.packageJsonFile.sourceCode,-1);var o=function(){e.isCodeModified=!0};e.indexJsEditor.getSession().on("change",o),e.packageJsonEditor.getSession().on("change",o),e.unsavedChanges.register(e.$scope,void 0,void 0,function(){return e.isCodeModified})}).catch(function(t){S.a.trackCloudFunctionsEditor(S.a.ACTION_FUNCTIONS.LOADING_FAILED),e.agent.webhook.cloudFunctionsEnabled?k.a.stdError(t):e.onInitError=t}).then(function(){return e.hideLoading()}),this.$scope.$on("cloudFunctionsEnabledChanged",function(t,n){n.enable?(e.isAgentReadOnly||e.setEditorReadonly(!1),e.agent.webhook.cloudFunctionsInitialized||(e.enableCloudFunctionsPromise=e.CloudFunctionsPersistence.enableFunctionsAsync(e.agent.cloudProjectId))):e.setEditorReadonly(!0)})}},{key:"getFunctionCodeAndInitMetadata",value:function(){var e=this;return this.CloudFunctionsPersistence.getFunction(this.agent.cloudProjectId).then(function(t){if(t.cloudFunction&&!n.i(b.b)(t.cloudFunction,e.agent.cloudProjectId,t.functionsBucketName))return e.isCloudFunctionOfCanonicalForm=!1,e.$q.reject();if(e.functionsBucketName=t.functionsBucketName,e.cloudFunction=t.cloudFunction,e.showLastDeployed=e.cloudFunction&&e.cloudFunction.updateTime&&!isNaN(Date.parse(e.cloudFunction.updateTime)),e.showLastDeployed&&(e.lastDeployed=new Date(e.cloudFunction.updateTime)),t.deploymentFailureMessage&&e.showDeploymentFailureMessage(t.deploymentFailureMessage),0===t.files.length)return e.$q.resolve(b.c);e.isDeployed=!0;var i=t.files.find(function(e){return e.fileName===b.a}),o=t.files.find(function(e){return e.fileName===b.d});return e.$q.resolve({indexJsFile:i,packageJsonFile:o})})}},{key:"showDeploymentFailureMessage",value:function(e){var t=e.indexOf("at createScript (vm.js");t>-1&&(e=e.substring(0,t).trim()),this.deploymentFailureMessage="The deployment of your Cloud Function failed:\n"+e}},{key:"setEditorReadonly",value:function(e){var t=!e,n=!e,i=o()({readOnly:e,highlightActiveLine:t,highlightGutterLine:n},E);this.indexJsEditor.setOptions(i),this.packageJsonEditor.setOptions(i);var a=e?"none":"";this.indexJsEditor.renderer.$cursorLayer.element.style.display=a,this.packageJsonEditor.renderer.$cursorLayer.element.style.display=a}},{key:"enableAndInitializeCloudFunctions",value:function(){var e=this;this.onInitError?(k.a.stdErrorHtml(this.onInitError),this.$timeout(function(){e.agent.webhook.available=!1,e.agent.webhook.cloudFunctionsEnabled=!1})):this.functionsToggleChanged()}},{key:"isCurrentFile",value:function(e){return e===this.currentFile}},{key:"setCurrentFile",value:function(e){this.agent.webhook.cloudFunctionsEnabled&&(this.currentFile=e)}},{key:"getLinkToFirebaseConsole",value:function(){return"https://console.firebase.google.com/project/"+this.agent.cloudProjectId+"/functions/logs"}},{key:"saveAndDeploy",value:function(e){var t=this;this.showLastDeployed=!1,this.deploymentFailureMessage=null,this.isDeploying=!0;var i={fileName:b.a,sourceCode:this.indexJsEditor.getValue()},o={fileName:b.d,sourceCode:this.packageJsonEditor.getValue()},a=null==this.cloudFunction;a&&(this.cloudFunction=n.i(b.e)(this.agent.cloudProjectId,this.functionsBucketName));var r={projectId:this.agent.cloudProjectId,functionsBucketName:this.functionsBucketName,createFunction:a,cloudFunction:this.cloudFunction,files:[i,o]};this.deployProgressPromise=this.enableCloudFunctionsPromise.then(function(e){return e&&e.name?t.pollEnableFunctionsStatus(e.name,0):t.$q.resolve()}).then(function(){return t.CloudFunctionsPersistence.deployFunction(r)}).then(function(n){return k.a.success("Successfully saved the Cloud Function. Now deploying it ..."),t.isCodeModified=!1,e&&e(),t.pollDeploymentStatus(n.operationName,1,0)}).then(function(){return t.agent.webhook.url=t.cloudFunction.triggerUrl,t.AgentData.updateAgent(t.agent)}).then(function(){return t.CurrentAgentService.setCurrentAgent(t.agent)}).then(function(){k.a.success("Successfully deployed your Cloud Function and saved your Webhook."),S.a.trackCloudFunctionsEditor(S.a.ACTION_FUNCTIONS.DEPLOY)}).catch(function(e){S.a.trackCloudFunctionsEditor(S.a.ACTION_FUNCTIONS.DEPLOY_FAILED),e&&e.ignoreError||k.a.stdError(e)}).finally(function(){t.isCodeModified=!1,t.isDeploying=!1,t.isDeployed=!0})}},{key:"disableDownload",value:function(){return this.isAgentReadOnly||this.isDeploying||!this.agent.webhook.cloudFunctionsEnabled}},{key:"download",value:function(){var e=this,t=this.CloudFunctionsPersistence.downloadFunctionUrl(this.functionsBucketName);if(this.isCodeModified||!this.isDeployed){var n=this.$mdDialog.confirm().title("Would you like to save and deploy?").textContent("Your code is changed and not deployed. Only saved and deployed code can be downloaded.").ok("Save, deploy and download.").cancel("Cancel");this.$mdDialog.show(n).then(function(){e.saveAndDeploy(function(){e.$window.open(t,"_top")})})}else this.$window.open(t,"_top")}},{key:"pollEnableFunctionsStatus",value:function(e,t){var n=this;return this.CloudFunctionsPersistence.checkServiceManagerOperation(e.replace("operations/","")).then(function(i){if(i.response){S.a.trackCloudFunctionsEditor(S.a.ACTION_FUNCTIONS.PROVISIONING_SUCCEEDED),n.agent.webhook.cloudFunctionsInitialized=!0,n.enableCloudFunctionsPromise=n.$q.resolve(null),S.a.trackCloudFunctionsEditor(n.agent.webhook.cloudFunctionsEnabled?S.a.ACTION_FUNCTIONS.DISABLE:S.a.ACTION_FUNCTIONS.ENABLE),k.a.success("Successfully provisioned Cloud Functions for your project. Now saving your Function ...");var o=new A.a(n.CurrentAgentService.getCurrentAgent());return o.webhook.cloudFunctionsInitialized=!0,n.AgentData.updateAgent(o).then(function(){return n.CurrentAgentService.setCurrentAgent(o)}).then(function(){return n.$timeout(function(){return n.$q.resolve()},5e3)})}return i.error?(S.a.trackCloudFunctionsEditor(S.a.ACTION_FUNCTIONS.PROVISIONING_FAILED),k.a.error("Provisioning Cloud Functions failed. Please refresh the page and try again."),n.$q.reject({ignoreError:!0})):(t%4==0&&k.a.info(C),n.$timeout(function(){return n.pollEnableFunctionsStatus(e,t+1)},900))})}},{key:"pollDeploymentStatus",value:function(e,t,n){var i=this;return this.CloudFunctionsPersistence.checkOperation(e).then(function(o){return o.response?(i.lastDeployed=new Date,i.showLastDeployed=!0,i.$q.resolve()):o.error?(i.showDeploymentFailureMessage(o.error.message),i.$q.reject({ignoreError:!0})):(t%4==0&&k.a.info(_),i.$timeout(function(){return i.pollDeploymentStatus(e,t+1,n)},900))}).catch(function(o){return o&&o.ignoreError?i.$q.reject(o):n<10?i.pollDeploymentStatus(e,t,n+1):i.$q.reject(o)})}},{key:"cloudFunctionsEnabled",get:function(){return this.agent.webhook.available&&this.agent.webhook.cloudFunctionsEnabled},set:function(e){this.agent.webhook.available=e,this.agent.webhook.cloudFunctionsEnabled=e}}]),t}(v.a),L=function e(){c()(this,e),this.bindings={agent:"=",isAgentReadOnly:"=",functionsToggleChanged:"&"},this.template=w,this.controller=T,this.controllerAs="vm"};t.a=L},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(89),r=n(114),s=function e(){o()(this,e),this.bindings={cloudFunctionsEnabled:"<",cloudProjectId:"<",lookbackMinutes:"<"},this.template=r,this.controller=a.a,this.controllerAs="vm"};t.a=s},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(176),r=n(323);n(364);var s=function e(){o()(this,e),this.bindings={},this.template=r,this.controller=a.a,this.controllerAs="vm"};t.a=s},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(8),l=n(27),u=function(){function e(t,n,i,a,r,u,c,d){var m=this;o()(this,e),this.$mdDialog=t,this.$scope=n,this.$q=i,this.CurrentAgentService=a,this.CurrentUser=r,this.InnerHeaderService=u,this.AgentData=c,this.AnalyticsService=d,this.saveProgressPromise=null,this.optionsUseForDomains=[{label:"Enable webhook for all domains",value:!0},{label:"Disable webhook for all domains",value:!1}],this.updateAgent=function(){return m.AgentData.updateAgent(m.agent).then(function(e){return e})},this.saveFulfillment=function(){var e=m;if(m.prepareToSaveHeaders(),m.saveProgressPromise=m.updateAgent(),m.saveProgressPromise)return m.saveProgressPromise.then(function(){e.CurrentAgentService.updateCurrentAgent()}).catch(function(e){e&&e.data&&e.data.status&&e.data.status.errorDetails&&s.a.notify(e.data.status.errorDetails,s.a.Status.ERROR)});s.a.notify("There were some errors during agent saving",s.a.Status.ERROR)},this.initWebhook=function(){m.headers=[];var e=m.agent.webhook.headers;for(var t in e)e.hasOwnProperty(t)&&m.headers.push({key:t,value:e[t]});m.addHeader()},this.prepareToSaveHeaders=function(){var e={};m.headers.forEach(function(t,n){e[t.key]=t.value}),m.agent.webhook.headers=e},this.addHeader=function(){m.headers.push({key:"",value:""})},this.removeHeader=function(e){m.headers.length>1&&m.headers.splice(e,1)},this.isWebhookValid=function(){var e=m.agent.webhook;return!(e&&e.available&&!e.url)},this.userProfile=r.getProfile(),this.agent=new l.a(a.getCurrentAgent()),a.checkReadOnly().then(function(e){m.isAgentReadOnly=e}),this.initWebhook()}return e.$inject=["$mdDialog","$scope","$q","CurrentAgentService","CurrentUser","InnerHeaderService","AgentData","AnalyticsService"],r()(e,[{key:"webhookToggleChanged",value:function(){var e=this;if(this.agent.webhook.cloudFunctionsEnabled){var t=this.$mdDialog.confirm().title("Enabling a custom webhook").textContent("If you enable a custom webhook, fulfillment via your Cloud Function will be disabled. Would you like to continue?").cancel("No").ok("Yes");this.$mdDialog.show(t).then(function(){e.agent.webhook.cloudFunctionsEnabled=!1,e.$scope.$broadcast("cloudFunctionsEnabledChanged",{enable:!1})}).catch(function(){e.agent.webhook.cloudFunctionsEnabled=!0,e.$scope.$broadcast("cloudFunctionsEnabledChanged",{enable:!0})})}}},{key:"cloudFunctionsToggleChanged",value:function(){var e=this;if(!this.agent.webhook.cloudFunctionsEnabled&&this.agent.webhook.available){var t=this.$mdDialog.confirm().title("Enabling fulfillment via Cloud Functions").textContent("If you enable fulfillment via Cloud Functions, your custom webhook will be disabled. Would you like to continue?").cancel("No").ok("Yes");this.$mdDialog.show(t).then(function(){e.agent.webhook.cloudFunctionsEnabled=!0,e.$scope.$broadcast("cloudFunctionsEnabledChanged",{enable:!0})}).catch(function(){e.agent.webhook.cloudFunctionsEnabled=!1,e.$scope.$broadcast("cloudFunctionsEnabledChanged",{enable:!1})})}else this.$scope.$broadcast("cloudFunctionsEnabledChanged",{enable:!this.agent.webhook.cloudFunctionsEnabled})}},{key:"customWebhookEnabled",get:function(){return this.agent.webhook.available&&!this.agent.webhook.cloudFunctionsEnabled},set:function(e){this.agent.webhook.available=e,e&&(this.agent.webhook.cloudFunctionsEnabled=!1)}}]),e}();t.a=u},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(324),r=function e(){o()(this,e)},s=function e(){o()(this,e),this.bindings={header:"@",subHeader:"@",toggleModel:"=",toggleDisabled:"=",toggleChanged:"&"},this.template=a,this.controller=r,this.controllerAs="vm"};t.a=s},function(e,t,n){"use strict";var i=n(26),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(8),c=function(){function e(t){r()(this,e),this.AgentData=t,this.shown=!1,this.isEndIntent=!1,this.initialState={}}return e.$inject=["AgentData"],l()(e,[{key:"$onInit",value:function(){var e=this;this.callbacks.onAfterSaveIntent=this.onAfterSave.bind(this),this.initialState=this.getState(),this.intent.id&&this.agent&&this.agent.googleAssistant&&this.agent.googleAssistant.getEnabled()&&(this.isEndIntent=this.agent.googleAssistant.endIntentIds.some(function(t){return t===e.intent.id}),this.initialState=this.getState(),this.isEndIntent&&(this.shown=!0))}},{key:"getState",value:function(){return{isEnd:this.isEndIntent}}},{key:"onAfterSave",value:function(){var e=this.getState();this.intent.id&&this.agent&&this.agent.googleAssistant&&this.agent.googleAssistant.getEnabled()&&o()(e)!==o()(this.initialState)&&this.agent.googleAssistant.getEnabled()&&(this.isEndIntent?this.agent.googleAssistant.addEndIntent(this.intent.id):this.agent.googleAssistant.removeEndIntent(this.intent.id),this.AgentData.updateAgent(this.agent).catch(u.a.stdError))}}]),e}(),d={bindings:{agent:"=",intent:"=",callbacks:"="},template:n(325),controller:c,controllerAs:"vm"};t.a=d},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(38);n(365);var l=function(){function e(t,n){o()(this,e),this.limitsManager=t,this.UtilsService=n,this.contextsShown=!1,this.separatorKeys=[32,13]}return e.$inject=["limitsManager","UtilsService"],r()(e,[{key:"$onInit",value:function(){(this.resetContexts||this.inputContexts&&this.inputContexts.length||this.outputContexts&&this.outputContexts.length)&&(this.contextsShown=!0)}},{key:"newOutputContext",value:function(e){return new s.a.AffectedContext({name:e})}},{key:"checkLifespan",value:function(e){var t=e.lifespan?parseInt(e.lifespan.toString(),10):0;e.lifespan=t}},{key:"preventInput",value:function(e){e.stopPropagation(),e.preventDefault(),e.target.focus()}},{key:"querySearchInput",value:function(e){var t=this;return this.autocompleteConfig.filter(function(n){return n.toLowerCase().indexOf(e.toLowerCase())>=0&&!t.inputContexts.some(function(e){return e.toLowerCase()===n.toLowerCase()})})}},{key:"querySearchOutput",value:function(e){var t=this;return this.autocompleteConfig.filter(function(n){return n.toLowerCase().indexOf(e.toLowerCase())>=0&&!t.outputContexts.some(function(e){return e.name.toLowerCase()===n.toLowerCase()})})}},{key:"isInputContextsLimitExceeded",value:function(){return this.limitsManager.isLimitExceeded("inputContexts",this.inputContexts.length)}},{key:"isOutputContextsLimitExceeded",value:function(){return this.limitsManager.isLimitExceeded("outputContexts",this.outputContexts.length)}},{key:"isLimitExceeded",value:function(){return this.isInputContextsLimitExceeded()||this.isOutputContextsLimitExceeded()}},{key:"getLimitText",value:function(){var e=this.isInputContextsLimitExceeded()?"inputContexts":"outputContexts";return this.limitsManager.getText(e)}}]),e}(),u={bindings:{inputContexts:"=",outputContexts:"=",resetContexts:"=",autocompleteConfig:"<"},template:n(326),controller:l,controllerAs:"vm"};t.a=u},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(38),l=n(13);n(366);var u=function(){function e(t){o()(this,e),this.UtilsService=t,this.eventsShown=!1,this.separatorKeys=[32,13],this.LIST_EVENTS_AUTOCOMPLETE=[],this.LIST_EVENTS_AUTOCOMPLETE=s.a.Event.listPossibleWelcomeEvents()}return e.$inject=["UtilsService"],r()(e,[{key:"$onInit",value:function(){this.events||(this.events=[]),this.events.length&&(this.eventsShown=!0)}},{key:"newEvent",value:function(e){return new s.a.Event({name:e})}},{key:"onAdd",value:function(t){e.notifyChange()}},{key:"onRemove",value:function(t){e.notifyChange()}},{key:"querySearch",value:function(e){var t=this;return this.LIST_EVENTS_AUTOCOMPLETE.filter(function(n){return n.toLowerCase().indexOf(e.toLowerCase())>=0&&!t.events.some(function(e){return e.name.toLowerCase()===n.toLowerCase()})})}}],[{key:"notifyChange",value:function(){l.a.publish("intentEventsChange")}}]),e}(),c={bindings:{events:"="},template:n(327),controller:u,controllerAs:"vm"};t.a=c},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(182),r=n(328),s=function e(){o()(this,e),this.bindings={parentIntent:"<"},this.template=r,this.controller=a.a,this.controllerAs="vm"};t.a=s},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=function(){function e(t,n,i,a,r,s,l,u){o()(this,e),this.$scope=t,this.$state=n,this.IntentSharedService=i,this.urls=a,this.CurrentAgentService=r,this.AnalyticsService=s,this.Confirm=l,this.IntentData=u,this.followUpIntents=[],this.isLoadedFollowUpIntents=!1,this.agent=r.getCurrentAgent()}return e.$inject=["$scope","$state","IntentSharedService","urls","CurrentAgentService","AnalyticsService","Confirm","IntentData"],r()(e,[{key:"$onInit",value:function(){this.followUpIntents=this.parentIntent.followUpIntents||[]}}]),e}();t.a=s},function(e,t,n){"use strict";var i=n(184),o=n(329);n(367);var a={bindings:{intent:"<",agent:"<",autoCompleteConfig:"<",templatesAlias:"=",userSaysList:"=",intentParamsList:"=",parentCallbacks:"=",isAgentReadOnly:"<"},template:o,controller:i.a,controllerAs:"vm"};t.a=a},function(e,t,n){"use strict";var i=n(26),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(17),c=n(43),d=n(13),m=function(){function e(t,n,i,o,a){var s=this;r()(this,e),this.$scope=t,this.$timeout=n,this.intentParamsAutosyncService=i,this.autoMarkupPersistence=o,this.limitsManager=a,this.userSaysFilter=null,this.viewState={showTableOnFirstUserSays:!1,isFilteringUserSays:!1,isAddingNewUserSays:!1},this.paging={currentPage:0,pageSize:e.DISPLAY_COUNT,numberOfPages:function(){return Math.ceil(s.filteredUserSaysList.length/e.DISPLAY_COUNT)},getOffset:function(){return s.paging.currentPage*s.paging.pageSize},callback:function(){s.viewState.showTableOnFirstUserSays=!1,s.broadcastUpdateView()}},this.userSaysKeyDownCb=function(e){function t(t){var n=$(".user-says-editor-holder .b-user-says-editor"),i=0;return n.index($(e.target))+t<n.length&&(i=n.index($(e.target))+t),n.eq(i)}13===e.which&&(s.focusedUserSays+1===s.paging.pageSize?(s.hasNext()&&s.showNext(),s.$timeout(function(){return t(1).focus()})):s.focusedUserSays+s.paging.getOffset()+1>=s.userSaysList.length?(t(0).blur(),s.paging.currentPage=0,s.$timeout(function(){return $(".user-says-editor-holder .b-user-says-editor").eq(0).focus()})):t(1).focus())},this.onSave=function(){if(!s.emptyUserSays.isEmpty()){var t=s.getIndexByCleanUserSays(s.emptyUserSays);t>-1?s.moveUpUserSays(t):s.addUserSays(s.emptyUserSays),s.emptyUserSays=new c.a,d.a.publish("updateSingleView",{index:e.EMPTY_USERSAYS_INDEX})}},this.emptyUserSaysKeyDownCb=function(t){if(!s.viewState.isAddingNewUserSays){if(13!==t.which)return s.emptyUserSaysCheckIsTemplate();if(!s.emptyUserSays.isEmpty()){s.viewState.isAddingNewUserSays=!0;var n=document.createEvent("HTMLEvents");n.initEvent("keyup",!0,!0),t.target.dispatchEvent(n);var i=s.getIndexByCleanUserSays(s.emptyUserSays);if(i>-1)s.moveUpUserSays(i);else{s.addUserSays(s.emptyUserSays);i=s.agent.cortana.cortanaCompatible&&0===s.paging.currentPage?1:0,s.makeMarkup(s.userSaysList[s.getRealUserSaysIndex(i)])}s.emptyUserSays=new c.a,d.a.publish("updateSingleView",{index:e.EMPTY_USERSAYS_INDEX}),s.$timeout(function(){s.viewState.isAddingNewUserSays=!1,s.updateUserSaysEditState()})}}},this.emptyUserSaysBlurCb=function(){s.$timeout(function(){return s.viewState.showTableOnFirstUserSays=!1},50)},this.userSaysBlurCb=function(e){s.$timeout(function(){return s.viewState.showTableOnFirstUserSays=!1},0)},this.userSaysDeleteCb=function(e){var t=s.getRealUserSaysIndex(e);s.userSaysList.splice(t,1),s.intentParamsAutosyncService.unsubscribe(t),s.userSaysFilter&&s.filteredUserSaysList.splice(e,1),s.updateUserSaysEditState(),s.broadcastUpdateView()},this.updateTemplatesAlias=function(e,t){s.templatesAlias.setFromTemplates(t)}}return e.$inject=["$scope","$timeout","intentParamsAutosyncService","autoMarkupPersistence","limitsManager"],l()(e,[{key:"$onInit",value:function(){var e=this;this.emptyUserSays=new c.a,this.agent.cortana.cortanaCompatible&&0===this.userSaysList.length&&this.userSaysList.push(new c.a),this.filteredUserSaysList=this.userSaysList,this.$scope.$on("userSaysParamsChanged",function(t,n){e.intentParamsAutosyncService.updateUserSaysParams(e.getRealUserSaysIndex(n.index),n.changedParams),u.a.updateIntentParams(e.intentParamsList)}),this.$scope.$on("userSaysParamChanged",function(t,n){e.intentParamsAutosyncService.userSaysParamChanged(n.newName,n.newMeta,n.oldName,n.oldMeta,e.getRealUserSaysIndex(n.index)),u.a.updateIntentParams(e.intentParamsList)}),d.a.subscribe("updateAlias",this.updateTemplatesAlias),this.intentParamsAutosyncService.subscribeAll({intentParamsList:this.intentParamsList,userSaysList:this.userSaysList}),this.parentCallbacks.onSaveIntent=this.onSave,this.$timeout(function(){return $($(".b-user-says-editor")[0]).focus()}),this.updateUserSaysEditState()}},{key:"$onDestroy",value:function(){u.a.resetIntentData()}},{key:"userSaysFilterChanged",value:function(){this.viewState.isFilteringUserSays=!0,this.filterTimeoutHolder&&this.$timeout.cancel(this.filterTimeoutHolder),this.filterTimeoutHolder=this.$timeout(this.makeFilterUserSays.bind(this),e.SEARCH_TIMEOUT)}},{key:"makeFilterUserSays",value:function(){var e=this;if(this.userSaysFilter){var t=this.userSaysFilter.toLowerCase();this.filteredUserSaysList=this.userSaysList.filter(function(e){return u.a.glueClean(e).toLowerCase().replace(" "," ").indexOf(t)>=0})}else this.filteredUserSaysList=this.userSaysList;this.paging.currentPage=0,this.$timeout(function(){d.a.publish("updateView"),e.viewState.isFilteringUserSays=!1})}},{key:"broadcastUpdateView",value:function(){d.a.publish("updateView",{}),d.a.publish("updateAlias",this.userSaysList)}},{key:"showNext",value:function(){this.paging.currentPage+=1,this.broadcastUpdateView()}},{key:"hasNext",value:function(){return this.filteredUserSaysList.length>this.paging.getOffset()&&this.filteredUserSaysList.length-this.paging.getOffset()>this.paging.getOffset()}},{key:"addUserSays",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.prepareToChangeUserSaysList();var n=this.calculatePushIndex(),i=t||new c.a;this.userSaysList.splice(n,0,i),this.intentParamsAutosyncService.subscribe(n),this.intentParamsAutosyncService.bindParamsToUserSays(),d.a.publish("updateSingleView",{index:n}),this.$timeout(function(){e.viewState.showTableOnFirstUserSays=!0}),this.broadcastUpdateView()}},{key:"moveUpUserSays",value:function(e){var t=this;this.prepareToChangeUserSaysList();var n=this.calculatePushIndex();this.intentParamsAutosyncService.moveUpUserSays(e,n),this.userSaysList[e].count=null===this.userSaysList[e].count?1:this.userSaysList[e].count+1,d.a.publish("updateSingleView",{index:n}),this.$timeout(function(){t.viewState.showTableOnFirstUserSays=!0}),this.broadcastUpdateView()}},{key:"prepareToChangeUserSaysList",value:function(){var e=this;this.$timeout(function(){return e.viewState.showTableOnFirstUserSays=!1}),this.userSaysFilter&&(this.userSaysFilter=null,this.makeFilterUserSays())}},{key:"calculatePushIndex",value:function(){return this.agent.cortana.cortanaCompatible&&0===this.paging.currentPage?this.paging.getOffset()+1:this.paging.getOffset()}},{key:"getRealUserSaysIndex",value:function(e){return this.userSaysList.indexOf(this.filteredUserSaysList[e+this.paging.getOffset()])}},{key:"getRealUserSaysIndexByUserSays",value:function(e){return this.userSaysList.indexOf(e)}},{key:"getEditorIndexByUserSays",value:function(e){var t=this.filteredUserSaysList.indexOf(e);return t=t-this.paging.getOffset()<this.paging.pageSize?t-this.paging.getOffset():-1}},{key:"getIndexByCleanUserSays",value:function(e){return this.userSaysList.findIndex(function(t){return u.a.glueClean(e).toLowerCase()===u.a.glueClean(t).toLowerCase()})}},{key:"emptyUserSaysCheckIsTemplate",value:function(){}},{key:"makeMarkup",value:function(e){var t=this,n=this.intent.id?this.intent.id:null;this.autoMarkupPersistence.makeMarkup(e,this.userSaysList,n,this.intent.auto).then(function(n){var i=t.getRealUserSaysIndexByUserSays(e);if(!(i<0)){var a=t.getEditorIndexByUserSays(e);if(o()(t.userSaysList[i].data)===o()(n.data.originalTemplate.data)){if(t.userSaysList[i].data=n.data.markedUpTemplate.data,a<0)return;d.a.publish("updateSingleView",{index:a})}}})}},{key:"updateUserSaysEditState",value:function(){this.emptyUserSaysEnabled=!this.limitsManager.isLimitExceeded("userSays",this.filteredUserSaysList.length)}}]),e}();m.DISPLAY_COUNT=10,m.EMPTY_USERSAYS_INDEX=-1,m.SEARCH_TIMEOUT=350,t.a=m},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(9),h=n.n(g),p=n(5),f=n.n(p),v=n(11),b=n.n(v),y=n(12),k=n(18),A=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=b()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&h()(t,n,r),r},S=w=function(e){function t(e,n,i){r()(this,t);var a=c()(this,(t.__proto__||o()(t)).call(this,e,n));return a.limitsManager=i,a.isShowThumb=!1,a.blankButtonActiveRoll=!1,a}return t.$inject=["$scope","$timeout","limitsManager"],m()(t,e),l()(t,[{key:"$onInit",value:function(){this.updateImage()}},{key:"$onChanges",value:function(e){this.imageUrlChanged()}},{key:"imageUrlChanged",value:function(){this.content.imageUrl!==this.imageUrl&&(this.imageUrl="",this.timeoutUpdateImage&&this.$timeout.cancel(this.timeoutUpdateImage),this.timeoutUpdateImage=this.$timeout(this.updateImage.bind(this),w.UPDATEIMAGE_TIMEOUT)),this.content.imageUrl?this.isShowThumb=!0:this.isShowThumb=!1}},{key:"updateImage",value:function(){this.imageUrl=this.content.imageUrl}},{key:"keyDown",value:function(e,t,n){var i=void 0!==this.content.buttons[n+1]&&this.content.buttons[n+1],o=void 0;if(e.keyCode!=w.BACKSPACE&&e.keyCode!=w.DELETE||t.text&&0!==t.text.length||!(this.content.buttons.length>1)||(this.content.buttons.splice(n,1),e.keyCode==w.BACKSPACE?o=n-1:e.keyCode==w.DELETE&&(o=n+1<this.content.buttons.length?n:n-1),e.preventDefault()),e.keyCode==w.ENTER){var a=!1;(t.text&&t.text.length||t.postback&&t.postback.length)&&(a=!0),a&&(!1===i&&this.content.addButton(),o=n+1)}void 0!==o&&this.setFocusIndex(o)}},{key:"setFocusIndex",value:function(e){this.focusIndex=e}},{key:"blankButtonVisible",value:function(){var e=this.content.buttons.length;if(e<1||e>2)return!1;var t=this.content.buttons[e-1];return t.text&&t.text.length||t.postback&&t.postback.length}},{key:"blankButtonFocus",value:function(){this.content.addButton();var e=this.content.buttons.length-1;this.setFocusIndex(e),this.blankButtonActiveRoll=!1}}]),t}(k.a);S.UP=38,S.DOWN=40,S.ENTER=13,S.BACKSPACE=8,S.DELETE=46,S.UPDATEIMAGE_TIMEOUT=400,S=w=A([n.i(y.c)({bindings:{content:"<",intent:"=",textcompleteOptions:"="},template:n(330)})],S),t.a=S;var w},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(9),h=n.n(g),p=n(5),f=n.n(p),v=n(11),b=n.n(v),y=n(12),k=n(18),A=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=b()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&h()(t,n,r),r},S=function(e){function t(e,n){r()(this,t);var i=c()(this,(t.__proto__||o()(t)).call(this,e,n));return i.editorOptions={mode:"code",modes:["code"],autoHeight:!0},i}return t.$inject=["$scope","$timeout"],m()(t,e),l()(t,[{key:"$onInit",value:function(){}}]),t}(k.a);S=A([n.i(y.c)({bindings:{content:"=",intent:"=",textcompleteOptions:"="},template:n(331)})],S),t.a=S},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(44),m=n.n(d),g=n(3),h=n.n(g),p=n(9),f=n.n(p),v=n(5),b=n.n(v),y=n(11),k=n.n(y),A=n(12),S=n(18),w=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=k()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&f()(t,n,r),r},E=C=function(e){function t(e,n,i){r()(this,t);var a=c()(this,(t.__proto__||o()(t)).call(this,e,n));return a.limitsManager=i,a.isShowThumb=!1,a}return t.$inject=["$scope","$timeout","limitsManager"],h()(t,e),l()(t,[{key:"$onInit",value:function(){m()(t.prototype.__proto__||o()(t.prototype),"$onInit",this).call(this),this.updateImage()}},{key:"$onChanges",value:function(e){this.imageUrlChanged()}},{key:"keyDown",value:function(e){if(e.shiftKey&&e.keyCode==C.ENTER){var t=$(e.target);t.val(t.val()+"\n"),this.elasticAdjust()}}},{key:"imageUrlChanged",value:function(){this.content.image.url!==this.imageUrl&&(this.imageUrl="",this.timeoutUpdateImage&&this.$timeout.cancel(this.timeoutUpdateImage),this.timeoutUpdateImage=this.$timeout(this.updateImage.bind(this),C.UPDATE_IMAGE_DELAY)),this.isShowThumb=this.content.image.url}},{key:"updateImage",value:function(){this.imageUrl=this.content.image.url}}]),t}(S.a);E.ENTER=13,E.UPDATE_IMAGE_DELAY=400,E=C=w([n.i(A.c)({bindings:{content:"<",intent:"=",textcompleteOptions:"=",saveTouched:"<"},template:n(332)})],E),t.a=E;var C},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(44),m=n.n(d),g=n(3),h=n.n(g),p=n(9),f=n.n(p),v=n(5),b=n.n(v),y=n(11),k=n.n(y),A=n(12),S=n(18),w=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=k()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&f()(t,n,r),r},E=C=function(e){function t(e,n,i){r()(this,t);var a=c()(this,(t.__proto__||o()(t)).call(this,e,n));return a.limitsManager=i,a.separatorKeys=[13],a.isShowThumb=!1,a}return t.$inject=["$scope","$timeout","limitsManager"],h()(t,e),l()(t,[{key:"$onInit",value:function(){m()(t.prototype.__proto__||o()(t.prototype),"$onInit",this).call(this),this.updateImage()}},{key:"$onChanges",value:function(e){this.imageUrlChanged()}},{key:"imageUrlChanged",value:function(){this.content.items[0].image.url!==this.imageUrl&&(this.imageUrl="",this.timeoutUpdateImage&&this.$timeout.cancel(this.timeoutUpdateImage),this.timeoutUpdateImage=this.$timeout(this.updateImage.bind(this),C.UPDATE_IMAGE_DELAY)),this.isShowThumb=this.content.items[0].image.url}},{key:"updateImage",value:function(){this.imageUrl=this.content.items[0].image.url}}]),t}(S.a);E.UPDATE_IMAGE_DELAY=400,E=C=w([n.i(A.c)({bindings:{content:"<",intent:"=",textcompleteOptions:"=",saveTouched:"<"},template:n(333)})],E),t.a=E;var C},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(44),m=n.n(d),g=n(3),h=n.n(g),p=n(9),f=n.n(p),v=n(5),b=n.n(v),y=n(11),k=n.n(y),A=n(12),S=n(18),w=n(101),E=n(20),C=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=k()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&f()(t,n,r),r};n(368);var T=L=function(e){function t(e,n,i,a){r()(this,t);var s=c()(this,(t.__proto__||o()(t)).call(this,e,i));return s.$element=n,s.UtilsService=a,s.editorLoaded=!1,s.editorEmptyNodes=[],s.newItem=new w.a.Item,s.aceLoaded=function(e){e.setOptions({maxLines:1/0,highlightActiveLine:!1});var t=function(t){var n=$(e.container).attr("name");s.$scope.chatBubbleResponse[n].$setValidity("required",t)},n=function(){var n=!e.session.getValue().length,i=e.renderer.emptyMessageNode;!n&&i?(e.renderer.scroller.contains(i)&&e.renderer.scroller.removeChild(i),t(!0)):n&&(i||(i=e.renderer.emptyMessageNode=document.createElement("div"),i.textContent="Enter speech output...",i.className="ace_invisible ace_emptyMessage",i.style.padding="0px 5px",i.style.color=s.saveTouched?L.ERROR_COLOR:L.HINT_COLOR,s.editorEmptyNodes.push(i)),t(!1),e.renderer.scroller.appendChild(i))},i=function(){var t=!e.session.getValue().length,n=e.renderer.emptyMessageNode;t&&n&&(n.style.color=L.ERROR_COLOR)};e.on("input",n),e.on("blur",i),s.$timeout(function(){$(e.container).focus(function(){e.focus()}),n()})},s}return t.$inject=["$scope","$element","$timeout","UtilsService"],h()(t,e),l()(t,[{key:"$onInit",value:function(){var e=this;m()(t.prototype.__proto__||o()(t.prototype),"$onInit",this).call(this),E.a.handleLazyLoad(n.e(0).then(n.bind(null,83)),E.a.SOURCE.ACE_EDITOR).then(function(){e.editorLoaded=!0,e.$timeout(e.elasticAdjust.bind(e),100)}),this.$scope.$watch(function(){return e.saveTouched},function(){e.saveTouched&&e.editorEmptyNodes.forEach(function(e){e.style.color=L.ERROR_COLOR})},!0)}},{key:"$onDestroy",value:function(){this.editorEmptyNodes=[]}},{key:"removePrompt",value:function(e){var t=this;this.content.items.splice(e,1),this.$timeout(function(){var e=$(t.$element).get(0);_.remove(t.editorEmptyNodes,function(t){return!$.contains(e,t)})})}},{key:"blankInputVisible",value:function(){var e=this.content.items;if(!e.length)return!0;var t=e[e.length-1];return t.displayText||t.textToSpeech}},{key:"blankInputOnFocus",value:function(e){var t=this;this.content.items.push(this.newItem),this.newItem=new w.a.Item,this.getBlankInputWrapper().addClass("ng-hide"),this.$timeout(function(){if(t.content.customizeAudio){var n=Number(e.target.id)%2;t.getInputs().eq(-(3+n)).focus()}else t.getInputs().eq(-2).focus()})}},{key:"audioCustomMode",value:function(){return this.editorLoaded&&this.content.customizeAudio}},{key:"getBlankInputWrapper",value:function(){return this.find(".bubble-row").last()}},{key:"getInputs",value:function(){return this.find("textarea")}},{key:"find",value:function(e){return $(this.$element).find(e)}}]),t}(S.a);T.ERROR_COLOR="#f26c29",T.HINT_COLOR="#989898",T=L=C([n.i(A.c)({bindings:{content:"<",intent:"=",textcompleteOptions:"=",saveTouched:"<"},template:n(334)})],T),t.a=T;var L},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(4),l=n.n(s),u=n(3),c=n.n(u),d=n(9),m=n.n(d),g=n(5),h=n.n(g),p=n(11),f=n.n(p),v=n(12),b=n(18),y=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=f()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":h()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&m()(t,n,r),r},k=function(e){function t(e,n,i){r()(this,t);var a=l()(this,(t.__proto__||o()(t)).call(this,e,n));return a.limitsManager=i,a}return t.$inject=["$scope","$timeout","limitsManager"],c()(t,e),t}(b.a);k=y([n.i(v.c)({bindings:{content:"<",intent:"=",textcompleteOptions:"=",saveTouched:"<"},template:n(335)})],k),t.a=k},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(9),h=n.n(g),p=n(5),f=n.n(p),v=n(11),b=n.n(v),y=n(12),k=n(18),A=n(62),S=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=b()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&h()(t,n,r),r},w=function(e){function t(e,n,i){r()(this,t);var a=c()(this,(t.__proto__||o()(t)).call(this,e,n));return a.limitsManager=i,a.separatorKeys=[13],a}return t.$inject=["$scope","$timeout","limitsManager"],m()(t,e),l()(t,[{key:"$onInit",value:function(){this.checkLimits()}},{key:"addItem",value:function(){this.content.items.push(new A.a),this.checkLimits()}},{key:"removeItem",value:function(e){this.content.items.splice(e,1),this.checkLimits()}},{key:"checkLimits",value:function(){this.newItemEnabled=!this.limitsManager.isConstLimitExceeded("GAListCardItems",this.content.items.length)}}]),t}(k.a);w=S([n.i(y.c)({bindings:{content:"<",intent:"=",textcompleteOptions:"=",saveTouched:"<"},template:n(336)})],w),t.a=w},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(9),h=n.n(g),p=n(5),f=n.n(p),v=n(11),b=n.n(v),y=n(12),k=n(18),A=n(103),S=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=b()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&h()(t,n,r),r},w=E=function(e){function t(e,n,i){r()(this,t);var a=c()(this,(t.__proto__||o()(t)).call(this,e,n));return a.limitsManager=i,a}return t.$inject=["$scope","$timeout","limitsManager"],m()(t,e),l()(t,[{key:"$onInit",value:function(){this.checkLimits()}},{key:"keyDown",value:function(e,t){var n=void 0;e.keyCode===E.ENTER&&(void 0===this.content.suggestions[t+1]&&this.addItem(),n=t+1),void 0!==n&&this.setFocusIndex(n)}},{key:"setFocusIndex",value:function(e){this.focusIndex=e}},{key:"addItem",value:function(){this.newSuggestionEnabled&&(this.content.suggestions.push(new A.a.Suggestion),this.checkLimits())}},{key:"removeItem",value:function(e){this.content.suggestions.splice(e,1),this.checkLimits()}},{key:"checkLimits",value:function(){this.newSuggestionEnabled=!this.limitsManager.isConstLimitExceeded("GASuggestionChips",this.content.suggestions.length)}}]),t}(k.a);w.ENTER=13,w=E=S([n.i(y.c)({bindings:{content:"<",intent:"=",textcompleteOptions:"=",saveTouched:"<"},template:n(337)})],w),t.a=w;var E},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(9),h=n.n(g),p=n(5),f=n.n(p),v=n(11),b=n.n(v),y=n(12),k=n(18),A=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=b()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&h()(t,n,r),r},S=w=function(e){function t(e,n,i){r()(this,t);var a=c()(this,(t.__proto__||o()(t)).call(this,e,n));return a.limitsManager=i,a.isShowThumb=!1,a}return t.$inject=["$scope","$timeout","limitsManager"],m()(t,e),l()(t,[{key:"$onInit",value:function(){this.imageUrl=this.content.imageUrl}},{key:"$onChanges",value:function(e){this.imageUrlChanged()}},{key:"imageUrlChanged",value:function(){this.content.imageUrl!=this.imageUrl&&(this.imageUrl="",this.timeoutUpdateImage&&this.$timeout.cancel(this.timeoutUpdateImage),this.timeoutUpdateImage=this.$timeout(this.updateImage.bind(this),w.UPDATEIMAGE_TIMEOUT)),this.content.imageUrl?this.isShowThumb=!0:this.isShowThumb=!1}},{key:"updateImage",value:function(){this.imageUrl=this.content.imageUrl}}]),t}(k.a);S.UPDATEIMAGE_TIMEOUT=400,S=w=A([n.i(y.c)({bindings:{content:"<",intent:"=",textcompleteOptions:"="},template:n(338)})],S),t.a=S;var w},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(9),h=n.n(g),p=n(5),f=n.n(p),v=n(11),b=n.n(v),y=n(12),k=n(18),A=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=b()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":f()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&h()(t,n,r),r},S=w=function(e){function t(e,n,i){r()(this,t);var a=c()(this,(t.__proto__||o()(t)).call(this,e,n));return a.limitsManager=i,a}return t.$inject=["$scope","$timeout","limitsManager"],m()(t,e),l()(t,[{key:"keyDown",value:function(e,t,n){var i=void 0!==this.content.replies[n+1]&&this.content.replies[n+1],o=void 0;e.keyCode!=w.BACKSPACE&&e.keyCode!=w.DELETE||t&&0!==t.length||!(this.content.replies.length>1)||(this.content.replies.splice(n,1),e.keyCode==w.BACKSPACE?o=n-1:e.keyCode==w.DELETE&&(o=n+1<this.content.replies.length?n:n-1),e.preventDefault()),e.keyCode==w.ENTER&&(!1===i&&this.content.addReply(),o=n+1),void 0!==o&&this.setFocusIndex(o)}},{key:"setFocusIndex",value:function(e){this.focusIndex=e}}]),t}(k.a);S.UP=38,S.DOWN=40,S.ENTER=13,S.BACKSPACE=8,S.DELETE=46,S=w=A([n.i(y.c)({bindings:{content:"=",intent:"=",textcompleteOptions:"="},template:n(339)})],S),t.a=S;var w},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(196),r=n(340);n(369);var s=function e(){o()(this,e),this.bindings={content:"=",intent:"=",template:"=",textcompleteOptions:"=",saveTouched:"<"},this.template=r,this.controller=a.a,this.controllerAs="vm"};t.a=s},function(e,t,n){"use strict";var i=n(5),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(34),c=function(){function e(){r()(this,e),this.responseType=u.b}return l()(e,[{key:"getResponseType",value:function(e){for(var t in u.b){var n=u.b[t];if("object"===(void 0===n?"undefined":o()(n))){if("number"==typeof e&&n.type===e)return n;if("string"==typeof e&&n.name===e)return n}}return null}}]),e}();t.a=c},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(44),m=n.n(d),g=n(3),h=n.n(g),p=n(9),f=n.n(p),v=n(5),b=n.n(v),y=n(11),k=n.n(y),A=n(12),S=n(18),w=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=k()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":b()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&f()(t,n,r),r},E=function(e){function t(e,n,i){r()(this,t);var a=c()(this,(t.__proto__||o()(t)).call(this,e,n));return a.limitsManager=i,a}return t.$inject=["$scope","$timeout","limitsManager"],h()(t,e),l()(t,[{key:"$onInit",value:function(){m()(t.prototype.__proto__||o()(t.prototype),"$onInit",this).call(this)}}]),t}(S.a);E=w([n.i(A.c)({bindings:{content:"=",intent:"=",textcompleteOptions:"="},template:n(341)})],E),t.a=E},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(199),r=n(342);n(370);var s=function e(){o()(this,e),this.bindings={intent:"=",textcompleteOptions:"=",parentCallbacks:"=",isEdit:"<",saveTouched:"<"},this.template=r,this.controller=a.a,this.controllerAs="vm"};t.a=s},function(e,t,n){"use strict";var i=n(5),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(27),c=n(100),d=n(34),m=n(213),g=function(){function e(t,n,i,o){var a=this;r()(this,e),this.CurrentUser=i,this.$timeout=o,this.contents=[],this.filteredContents=[],this.platforms=[],this.activePlatforms=[],this.platformChosen=d.a.DEFAULT,this.platform=d.a,this.responseType=d.b,this.DEFAULT_TYPES=[d.b.MESSAGE,d.b.CUSTOM_PAYLOAD],this.BASE_TYPES=[d.b.MESSAGE,d.b.CARD,d.b.QUICK_REPLY,d.b.IMAGE,d.b.CUSTOM_PAYLOAD],this.GOOGLE_TYPES=[d.b.CHAT_BUBBLE,d.b.BASIC_CARD,d.b.LIST_CARD,d.b.SUGGESTION_CHIPS,d.b.CAROUSEL_CARD,d.b.CUSTOM_PAYLOAD,d.b.LINK_OUT_CHIP],this.FIXED_INDEX_TYPES=[d.b.CHAT_BUBBLE,d.b.BASIC_CARD,d.b.SUGGESTION_CHIPS,d.b.LINK_OUT_CHIP,d.b.CUSTOM_PAYLOAD],this.CAROUSEL_COMPATIBLE_TYPES=[d.b.CHAT_BUBBLE,d.b.SUGGESTION_CHIPS,d.b.CAROUSEL_CARD],this.ALEXA_TYPES=[d.b.CARD,d.b.MESSAGE,d.b.CUSTOM_PAYLOAD],this.platformTypes={},this.googleState=new e.GoogleState,this.contentListText=[d.b.CHAT_BUBBLE,d.b.BASIC_CARD,d.b.LIST_CARD,d.b.SUGGESTION_CHIPS,d.b.CAROUSEL_CARD,d.b.LINK_OUT_CHIP,d.b.MESSAGE,d.b.IMAGE,d.b.CARD,d.b.QUICK_REPLY,d.b.CUSTOM_PAYLOAD],this.sortableConfig={handle:".drag-handle",items:".rich_response__content","ui-floating":!0,update:function(e,t){var n=t.item.sortable;if(a.platformChosen===d.a.GOOGLE&&!n.received){var i=n.droptargetModel,o=function(e){return a.getResponseType(i[e].type)},r=n.index,s=n.dropindex,l=o(r),u=o(s),c=function(e,t){return l===e&&u===t};if(l!==u)if(c(d.b.BASIC_CARD,d.b.CHAT_BUBBLE)&&s>0);else if(c(d.b.CHAT_BUBBLE,d.b.BASIC_CARD))if(0===r&&1===s)n.cancel();else{var m=_.take(i,s);m.length&&angular.isDefined(_.find(m,function(e){return a.getResponseType(e.type)!==d.b.CHAT_BUBBLE}))&&n.cancel()}else _.find(a.FIXED_INDEX_TYPES,function(e){return e===l||e===u})&&n.cancel();else 0===r&&l===d.b.CHAT_BUBBLE&&o(1)===d.b.BASIC_CARD&&n.cancel()}}},this.onSave=function(){var e=a.removeDefaultResponseOnEdit(a.pushFilteredContent(a.contents.slice())),t=a.serializableMessages(e);a.concatCarouselCards(t);var n=a.intent.responses[0];n.messages=t,n.defaultResponsePlatforms=a.defaultResponsePlatforms.serializable()},this.serializableMessages=function(e){return e.map(function(e){return e.serializable()})},this.externalizableMessages=function(e){var t=[];return e.forEach(function(e){var n=a.getResponseType(e.type);n&&(n===d.b.CAROUSEL_CARD?a.breakCarouselCard(t,e):t.push(new n.model(e)))}),t},this.addContent=function(t){if(!(a.platformChosen!==d.a.GOOGLE&&a.filteredContents.length>=e.MAX_CONTENT_NUMBER)){var n=new t.model({type:t.type,platform:a.platformChosen.name});a.platformChosen===d.a.GOOGLE?a.addGoogleContent(t,n):a.filteredContents.push(n)}},this.addGoogleContent=function(e,t){var n=function(e){var n=_.findLastIndex(a.filteredContents,function(t){return a.getResponseType(t.type)===e});n>-1?a.filteredContents.splice(n+1,0,t):a.filteredContents.unshift(t)},i=function(e){var n=_.findIndex(a.filteredContents,function(t){return e.indexOf(a.getResponseType(t.type))>-1});n>-1?a.filteredContents.splice(n,0,t):a.filteredContents.push(t)};e===d.b.CHAT_BUBBLE?n(d.b.CHAT_BUBBLE):e===d.b.BASIC_CARD?n(d.b.CHAT_BUBBLE):e===d.b.SUGGESTION_CHIPS?i([d.b.LINK_OUT_CHIP,d.b.CUSTOM_PAYLOAD]):e===d.b.LINK_OUT_CHIP?i([d.b.CUSTOM_PAYLOAD]):e===d.b.CUSTOM_PAYLOAD?a.filteredContents.push(t):i([d.b.SUGGESTION_CHIPS,d.b.LINK_OUT_CHIP,d.b.CUSTOM_PAYLOAD]),a.updateGoogleCardsState()},this.removeContent=function(e){a.filteredContents.length&&(a.filteredContents.splice(e,1),a.updateGoogleCardsState())},this.checkPossibilityAdding=function(e){if(a.platformChosen===d.a.GOOGLE)if(e===d.b.CAROUSEL_CARD){if(!a.googleState.newCarouselCardsEnabled)return!1}else{if(a.googleState.carouselCardsCount>0&&-1===a.CAROUSEL_COMPATIBLE_TYPES.indexOf(e))return!1;if(e===d.b.BASIC_CARD&&a.googleState.listCardsCount>0)return!1;if(e===d.b.LIST_CARD&&a.googleState.basicCardsCount>0)return!1;if(e===d.b.CUSTOM_PAYLOAD&&a.limitsManager.isConstLimitExceeded("GACustomPayloads",a.googleState.customPayloadsCount))return!1}return a.isNotMax(e)},this.onPlatformChoosen=function(e){a.platformChosen=e,a.pushFilteredContent(a.contents),a.filterContent(),a.defaultResponseEnabled=a.defaultResponsePlatforms.getEnabled(e)};var s=t.getCurrentAgent();s instanceof u.a?this.agent=s:(this.agent=new u.a(t.getCurrentAgent()),t.updateCurrentAgent(this.agent)),this.limitsManager=n,this.platformTypes[d.a.DEFAULT.name]=this.DEFAULT_TYPES,this.platformTypes[d.a.GOOGLE.name]=this.GOOGLE_TYPES,this.platformTypes[d.a.FACEBOOK.name]=this.BASE_TYPES,this.platformTypes[d.a.SLACK.name]=this.BASE_TYPES,this.platformTypes[d.a.TELEGRAM.name]=this.BASE_TYPES,this.platformTypes[d.a.KIK.name]=this.BASE_TYPES,this.platformTypes[d.a.VIBER.name]=this.BASE_TYPES,this.platformTypes[d.a.SKYPE.name]=this.BASE_TYPES,this.platformTypes[d.a.LINE.name]=this.BASE_TYPES,this.platformTypes[d.a.ALEXA.name]=this.ALEXA_TYPES}return e.$inject=["CurrentAgentService","limitsManager","CurrentUser","$timeout"],l()(e,[{key:"$onInit",value:function(){var e=this.intent.responses[0];this.contents=this.externalizableMessages(e.messages||[]),this.defaultResponsePlatforms=new m.a(e.defaultResponsePlatforms),this.filterContent(),this.parentCallbacks.onSaveIntent=this.onSave,this.fillPlatformTabs(),this.contents.length||this.filteredContents.length||(this.addContent(d.b.MESSAGE),this.defaultResponseAdded=!0)}},{key:"fillPlatformTabs",value:function(){var e=this,t=function(t){return e.defaultResponsePlatforms.getEnabled(t)||e.agent[t.agentAttr]&&e.agent[t.agentAttr].getEnabled()};this.iteratePlatforms(function(n){n===d.a.DEFAULT||t(n)||angular.isDefined(_.find(e.contents,function(e){return e.platform===n.name}))?e.activePlatforms.push(n):e.platforms.push(n)})}},{key:"iteratePlatforms",value:function(e){var t=this.CurrentUser.getProfile();for(var n in d.a){var i=d.a[n];if("object"===(void 0===i?"undefined":o()(i))){if(i===d.a.LINE&&!t.isLineAvailable||i===d.a.ALEXA&&!t.isAlexaIntegrationAvailable)continue;e(i)}}}},{key:"removeDefaultResponseOnEdit",value:function(e){var t=this;if(this.isEdit&&this.defaultResponseAdded){var n=_.findIndex(e,function(e){return e.platform===d.a.DEFAULT.name&&t.getResponseType(e.type)===d.b.MESSAGE&&!d.b.MESSAGE.model.validate(e)});n>-1&&e.splice(n,1)}return e}},{key:"breakCarouselCard",value:function(e,t){t.items.length>1?t.items.forEach(function(n){var i=new c.a({items:[n],type:t.type,platform:t.platform});e.push(i)}):e.push(new c.a(t))}},{key:"concatCarouselCards",value:function(e){var t=this,n=[],i=[];if(e.forEach(function(e,o){t.getResponseType(e.type)===d.b.CAROUSEL_CARD&&(n.push(o),i.push(e))}),i.length>1){n.reverse().forEach(function(t,i){i<n.length-1&&e.splice(t,1)});var o=i[0];i.forEach(function(e,t){t>0&&(o.items=o.items.concat(e.items))})}}},{key:"isShowMenu",value:function(){return this.platformChosen===d.a.GOOGLE?this.googleState.hasEnabledCards:!(this.filteredContents.length>=e.MAX_CONTENT_NUMBER)}},{key:"isShowItem",value:function(e){var t=this.platformTypes[this.platformChosen.name];return void 0===t||t.indexOf(e)>-1}},{key:"updateGoogleCardsState",value:function(){var e=this;this.platformChosen===d.a.GOOGLE&&(this.googleState.reset(),this.filteredContents.forEach(function(t){switch(e.getResponseType(t.type)){case d.b.CAROUSEL_CARD:e.googleState.carouselCardsCount++;break;case d.b.BASIC_CARD:e.googleState.basicCardsCount++;break;case d.b.LIST_CARD:e.googleState.listCardsCount++;break;case d.b.CUSTOM_PAYLOAD:e.googleState.customPayloadsCount++}}),this.googleState.newCarouselCardsEnabled=angular.isUndefined(_.find(this.filteredContents,this.searchTypeFn(function(t){return-1===e.CAROUSEL_COMPATIBLE_TYPES.indexOf(t)}))),this.$timeout(function(){var t=$("button[name='add-card']:enabled");e.googleState.hasEnabledCards=t.length>0}))}},{key:"searchTypeFn",value:function(e){var t=this;return function(n){var i=t.getResponseType(n.type);return e(i)}}},{key:"isNotMax",value:function(e){var t=this;if(e.maxCount>0){var n=0;if(this.filteredContents.forEach(function(i){t.getResponseType(i.type)===e&&n++}),n>=e.maxCount)return!1}return!0}},{key:"addPlatform",value:function(e,t){var n=this;this.activePlatforms.push(e),this.$timeout(function(){return n.platforms.splice(t,1)},this.platforms.length>1?400:0),this.defaultResponsePlatforms.setEnabled(e,!0),this.onPlatformChoosen(e)}},{key:"filterContent",value:function(){var e=this;this.filteredContents=[];var t=function(t){return e.platformChosen.name===t.platform},n=[];this.contents.forEach(function(i,o){t(i)&&(e.filteredContents.push(i),n.push(o))}),this.filteredContentsIndex=n[0],n.reverse().forEach(function(t){e.contents.splice(t,1)}),this.updateGoogleCardsState()}},{key:"pushFilteredContent",value:function(e){return this.filteredContents.length&&e.splice.apply(e,[this.filteredContentsIndex,0].concat(this.filteredContents)),e}},{key:"getResponseType",value:function(e){for(var t in d.b){var n=d.b[t];if("object"===(void 0===n?"undefined":o()(n))){if("number"==typeof e&&n.type===e)return n;if("string"==typeof e&&n.name===e)return n}}return null}}]),e}();g.MAX_CONTENT_NUMBER=10,function(e){var t=function(){function e(){r()(this,e)}return l()(e,[{key:"reset",value:function(){this.carouselCardsCount=0,this.basicCardsCount=0,this.listCardsCount=0,this.customPayloadsCount=0,this.hasEnabledCards=!0,this.newCarouselCardsEnabled=!0}}]),e}();e.GoogleState=t}(g||(g={})),t.a=g},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=function(){function e(){o()(this,e),this.webhookShown=!1}return r()(e,[{key:"$onInit",value:function(){this.webhookUsed&&(this.webhookShown=!0)}},{key:"onChangeWebhookUsed",value:function(){this.webhookUsed||(this.webhookForSlotFilling=!1)}}]),e}(),l={bindings:{webhookUsed:"=",webhookForSlotFilling:"="},template:n(343),controller:s,controllerAs:"vm"};t.a=l},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(202),r=n(344),s=function e(){o()(this,e),this.bindings={intent:"<",layer:"<",parentName:"<",refreshIntentsCb:"=",listFollowUpIntents:"=",batchSelected:"=",isBatch:"=",switchBatchCb:"=",simple:"<",pathExpandIntents:"<",isAgentReadOnly:"<"},this.template=r,this.controller=a.a,this.controllerAs="vm"};t.a=s},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(8),l=n(78),u=function(){function e(t,n,i,a,r,s,l,u,c,d){o()(this,e),this.$scope=t,this.$state=n,this.IntentSharedService=i,this.$timeout=a,this.urls=r,this.CurrentUser=s,this.CurrentAgentService=l,this.AnalyticsService=u,this.Confirm=c,this.IntentData=d,this.isFollowUpIntent=!1,this.isExistFollowUpIntents=!1,this.isShownFollowUpIntents=!1,this.disableFollowup=!1,this.agent=l.getCurrentAgent(),this.agentId=this.agent&&this.agent.id}return e.$inject=["$scope","$state","IntentSharedService","$timeout","urls","CurrentUser","CurrentAgentService","AnalyticsService","Confirm","IntentData"],r()(e,[{key:"$onInit",value:function(){this.refresh();var t=this.layer>=0?this.layer:0;this.intentNameStyle={"padding-left":t*e.PADDING_FOLLOWUP_INTENT}}},{key:"$onChanges",value:function(e){e.intent&&this.$timeout(this.refresh.bind(this))}},{key:"createFollowUpIntent",value:function(e){var t=this;this.IntentData.addFollowupIntent(this.intent.id,e.id,this.CurrentAgentService.getCurrentLanguage()).then(function(n){t.AnalyticsService.track("INTENT_INTENT_CREATED",{agent_name:t.agent.name,intent_name:e.name,expressions_num:e.userSays.length,lang:t.agent.language});var i=t.AnalyticsService.getTraits();t.AnalyticsService.identify({intents_created:i.intents_created?++i.intents_created:1}),s.a.notify("Follow-up intent saved",s.a.Status.SUCCESS),t.refreshIntentsCb(t.intent.id)})}},{key:"goDownloadIntent",value:function(e){this.AnalyticsService.track("INTENT_INTENT_DOWNLOADED",{agent_name:this.agent.name,intent_name:this.intent.name,file_type:e,lang:this.agent.language}),this.IntentData.downloadIntent(this.intent.id,this.intent.name,e,this.CurrentAgentService.getCurrentLanguage()).catch(function(e){s.a.stdErrorNoReject(e)})}},{key:"getPriorityLabel",value:function(){return this.IntentSharedService.getPriorityLabel(this.intent.priority)}},{key:"deleteIntent",value:function(){var e=this,t=l.a.checkAndGetError(this.agent,this.intent),n={message:t+'Are you sure you would like to delete intent "'+this.intent.name+'"?',title:"Delete Intent",okLabel:"Delete",cancelLabel:"Cancel"};this.Confirm.confirmation(n).then(function(){var n=t?{force:!0}:void 0;e.IntentData.deleteIntent(e.intent.id,n).then(function(t){l.a.remove(e.agent,e.intent),e.AnalyticsService.track("INTENT_INTENT_DELETED",{agent_name:e.agent.name,intent_name:e.intent.name,lang:e.agent.language}),e.refreshIntentsCb(e.intent.parentId)})},null)}},{key:"goSref",value:function(e,t){var n=this.$state.current.name===e;this.$state.go(e,t,{reload:n})}},{key:"refresh",value:function(){this.isExistFollowUpIntents=this.intent.followUpIntents&&!!this.intent.followUpIntents.length,this.isFollowUpIntent=!!this.intent.parentId,this.fullnameIntent=this.intent.name,this.pathExpandIntents&&this.pathExpandIntents.length&&!this.isShownFollowUpIntents&&this.pathExpandIntents.includes(this.intent.id)&&(this.isShownFollowUpIntents=!0)}},{key:"mergeCommonContextName",value:function(e){return e.replace(/\s/g,"")+"-followup"}}]),e}();t.a=u,u.PADDING_FOLLOWUP_INTENT=24},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(9),l=n.n(s),u=n(5),c=n.n(u),d=n(11),m=n.n(d),g=n(12),h=n(20),p=this&&this.__decorate||function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=m()(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":c()(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&l()(t,n,r),r};n(371);var f=function(){function e(t,i){o()(this,e),this.$timeout=t,this.$element=i,this.editor=null,this.internalTrigger=!1,this.jsoneditorLoaded=!1;var a=this;h.a.handleLazyLoad(n.e(0).then(n.bind(null,83)),h.a.SOURCE.ACE_EDITOR).then(function(){n.e(8).then(n.bind(null,392)).then(function(e){t(function(){a.jsoneditorLoaded=!0,a.initJsonEditor(e,a.$element.find(".jsoneditor__container")[0])})})})}return e.$inject=["$timeout","$element"],r()(e,[{key:"$onInit",value:function(){}},{key:"$onDestroy",value:function(){}},{key:"initJsonEditor",value:function(e,t){var n,i=this,o={mode:"code",ace:ace},a=angular.extend({},o,i.options),r=angular.extend({},a,{theme:"ace/theme/clouds",onChange:function(){void 0!==n&&i.$timeout.cancel(n),n=i.$timeout(function(){if(i.editor){i.internalTrigger=!0;var e=void 0;try{i.json=i.editor.get()}catch(t){e=t}a&&a.hasOwnProperty("change")&&a.change(e)}},a.timeout||100)}});delete r.autoHeight,delete r.readOnly,i.editor=new e(t,r),i.options.autoHeight&&i.editor.aceEditor.setOptions({maxLines:1/0}),i.options.readOnly&&i.editor.aceEditor.setReadOnly(!0),i.updateJsonEditor(i.json)}},{key:"updateJsonEditor",value:function(e){if(this.editor){if(this.internalTrigger)return void(this.internalTrigger=!1);this.editor.set(e?angular.copy(e):"{}")}}},{key:"json",set:function(e){this._json=e,this.updateJsonEditor(e)},get:function(){return this._json}}]),e}();f=p([n.i(g.c)({bindings:{options:"=",json:"="},template:n(347)})],f),t.a=f},function(e,t,n){"use strict";var i=n(5),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(34),c=n(20),d=function(){function e(t,i){var o=this;r()(this,e),this.responseType=null,this.responseTypeEnum=u.b,this.componentsInitialized=!1,this.samplesDataItems=[],this.responseForSelectedPlatform=[],t.$watch(function(){return o.responseType},function(e,t){e!==t&&(o.responseForSelectedPlatform=o.validateResponses(o.response.getResponseByPlatform(o.responseType.name)),o.speech=o.getSpeech())}),c.a.handleComponentLazyLoad(n.e(4).then(n.bind(null,390)),c.a.COMPONENT.CUSTOM_RESPONSE,null,i).then(function(){o.componentsInitialized=!0})}return e.$inject=["$scope","$compileProvider"],l()(e,[{key:"$onInit",value:function(){this.parentCallback.responseUpdated=this.responseUpdated.bind(this),this.parentCallback.defaultPlatform=this.getDefaultPlatform.bind(this)}},{key:"getDefaultPlatform",value:function(){return this.responseType}},{key:"responseUpdated",value:function(){this.samplesDataItems=this.response.getResponsePlatform(this.responseType),this.responseType=this.responseType||this.samplesDataItems[0],this.responseForSelectedPlatform=this.validateResponses(this.response.getResponseByPlatform(this.responseType.name)),this.speech=this.getSpeech()}},{key:"getSpeech",value:function(){var e=this;return this.responseForSelectedPlatform.filter(function(t){return e.getResponseType(t.type)===e.responseTypeEnum.MESSAGE||e.getResponseType(t.type)===e.responseTypeEnum.CHAT_BUBBLE}).map(function(e){return e.speech||e.displayText||e.textToSpeech}).join(". ")}},{key:"validateResponses",value:function(e){var t=this;return e?e.filter(function(e){var n=t.getResponseType(e.type);return e.platform===u.a.GOOGLE.name&&n!==u.b.CHAT_BUBBLE||n.model.validate(e)}):[]}},{key:"getResponseType",value:function(e){for(var t in u.b){var n=u.b[t];if("object"===(void 0===n?"undefined":o()(n))){if("number"==typeof e&&n.type===e)return n;if("string"==typeof e&&n.name===e)return n}}return null}}]),e}();t.a=d},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(8);n(378);var l=function(){function e(t,n,i){o()(this,e),this.$scope=t,this.$timeout=n,this.WhitelistData=i,this.emails=[""],this.uploading=!1}return e.$inject=["$scope","$timeout","WhitelistData"],r()(e,[{key:"$onInit",value:function(){var e=this;$("#file").change(function(t){var n=t.target.files[0];n&&n.name.endsWith(".json")&&e.getReader().readAsText(n),$(e).val("")})}},{key:"addEmail",value:function(){this.emails.push("")}},{key:"removeEmail",value:function(e){this.emails.splice(e,1)}},{key:"uploadingEnabled",value:function(){return this.emails.some(function(e){return void 0!==e&&null!==e&&""!==e})}},{key:"updateEmails",value:function(){var e=this;this.uploading=!0,this.WhitelistData.updateEmails(this.emails).then(function(t){e.uploading=!1,s.a.success("Emails are added!")},function(t){e.uploading=!1;var n=void 0;n="string"==typeof t?t:_.has(t,"data.status.errorDetails")?t.data.status.errorDetails:"Some errors occurred..",s.a.error(n)})}},{key:"getReader",value:function(){var e=this;return this.reader||(this.reader=new FileReader,this.reader.onload=function(t){var n=JSON.parse(t.target.result);Array.isArray(n)&&e.$timeout(function(){e.emails=e.emails.concat(n.filter(function(e){return"string"==typeof e&&e.indexOf("@")>-1}))})}),this.reader}}]),e}(),u={template:n(355),controller:l,controllerAs:"vm"};t.a=u},function(e,t,n){"use strict";function i(e,t){return{name:"projects/"+e+"/locations/"+u+"/functions/"+c,entryPoint:d,sourceArchiveUrl:"gs://"+t+"/dialogflow-fulfillment-function-source.zip",triggerUrl:"https://"+u+"-"+e+".cloudfunctions.net/"+c}}function o(e,t,n){var o=i(t,n);return e.name===o.name&&e.entryPoint===o.entryPoint&&e.sourceArchiveUrl===o.sourceArchiveUrl}var a=n(236),r=n.n(a);n.d(t,"a",function(){return s}),n.d(t,"d",function(){return l}),n.d(t,"c",function(){return h}),t.e=i,t.b=o;var s="index.js",l="package.json",u="us-central1",c="dialogflowFirebaseFulfillment",d="dialogflowFirebaseFulfillment",m="'use strict';\n\nconst functions = require('firebase-functions'); // Cloud Functions for Firebase library\nconst DialogflowApp = require('actions-on-google').DialogflowApp; // Google Assistant helper library\n\nconst googleAssistantRequest = 'google'; // Constant to identify Google Assistant requests\n\nexports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) => {\n  console.log('Request headers: ' + JSON.stringify(request.headers));\n  console.log('Request body: ' + JSON.stringify(request.body));\n\n  // An action is a string used to identify what needs to be done in fulfillment\n  let action = request.body.result.action; // https://dialogflow.com/docs/actions-and-parameters\n\n  // Parameters are any entites that Dialogflow has extracted from the request.\n  const parameters = request.body.result.parameters; // https://dialogflow.com/docs/actions-and-parameters\n\n  // Contexts are objects used to track and store conversation state\n  const inputContexts = request.body.result.contexts; // https://dialogflow.com/docs/contexts\n\n  // Get the request source (Google Assistant, Slack, API, etc) and initialize DialogflowApp\n  const requestSource = (request.body.originalRequest) ? request.body.originalRequest.source : undefined;\n  const app = new DialogflowApp({request: request, response: response});\n\n  // Create handlers for Dialogflow actions as well as a 'default' handler\n  const actionHandlers = {\n    // The default welcome intent has been matched, welcome the user (https://dialogflow.com/docs/events#default_welcome_intent)\n    'input.welcome': () => {\n      // Use the Actions on Google lib to respond to Google requests; for other requests use JSON\n      if (requestSource === googleAssistantRequest) {\n        sendGoogleResponse('Hello, Welcome to my Dialogflow agent!'); // Send simple response to user\n      } else {\n        sendResponse('Hello, Welcome to my Dialogflow agent!'); // Send simple response to user\n      }\n    },\n    // The default fallback intent has been matched, try to recover (https://dialogflow.com/docs/intents#fallback_intents)\n    'input.unknown': () => {\n      // Use the Actions on Google lib to respond to Google requests; for other requests use JSON\n      if (requestSource === googleAssistantRequest) {\n        sendGoogleResponse('I\\'m having trouble, can you try that again?'); // Send simple response to user\n      } else {\n        sendResponse('I\\'m having trouble, can you try that again?'); // Send simple response to user\n      }\n    },\n    // Default handler for unknown or undefined actions\n    'default': () => {\n      // Use the Actions on Google lib to respond to Google requests; for other requests use JSON\n      if (requestSource === googleAssistantRequest) {\n        let responseToUser = {\n          //googleRichResponse: googleRichResponse, // Optional, uncomment to enable\n          //googleOutputContexts: ['weather', 2, { ['city']: 'rome' }], // Optional, uncomment to enable\n          speech: 'This message is from Dialogflow\\'s Cloud Functions for Firebase editor!', // spoken response\n          displayText: 'This is from Dialogflow\\'s Cloud Functions for Firebase editor! :-)' // displayed response\n        };\n        sendGoogleResponse(responseToUser);\n      } else {\n        let responseToUser = {\n          //richResponses: richResponses, // Optional, uncomment to enable\n          //outputContexts: [{'name': 'weather', 'lifespan': 2, 'parameters': {'city': 'Rome'}}], // Optional, uncomment to enable\n          speech: 'This message is from Dialogflow\\'s Cloud Functions for Firebase editor!', // spoken response\n          displayText: 'This is from Dialogflow\\'s Cloud Functions for Firebase editor! :-)' // displayed response\n        };\n        sendResponse(responseToUser);\n      }\n    }\n  };\n\n  // If undefined or unknown action use the default handler\n  if (!actionHandlers[action]) {\n    action = 'default';\n  }\n\n  // Run the proper handler function to handle the request from Dialogflow\n  actionHandlers[action]();\n\n  // Function to send correctly formatted Google Assistant responses to Dialogflow which are then sent to the user\n  function sendGoogleResponse (responseToUser) {\n    if (typeof responseToUser === 'string') {\n      app.ask(responseToUser); // Google Assistant response\n    } else {\n      // If speech or displayText is defined use it to respond\n      let googleResponse = app.buildRichResponse().addSimpleResponse({\n        speech: responseToUser.speech || responseToUser.displayText,\n        displayText: responseToUser.displayText || responseToUser.speech\n      });\n\n      // Optional: Overwrite previous response with rich response\n      if (responseToUser.googleRichResponse) {\n        googleResponse = responseToUser.googleRichResponse;\n      }\n\n      // Optional: add contexts (https://dialogflow.com/docs/contexts)\n      if (responseToUser.googleOutputContexts) {\n        app.setContext(...responseToUser.googleOutputContexts);\n      }\n\n      app.ask(googleResponse); // Send response to Dialogflow and Google Assistant\n    }\n  }\n\n  // Function to send correctly formatted responses to Dialogflow which are then sent to the user\n  function sendResponse (responseToUser) {\n    // if the response is a string send it as a response to the user\n    if (typeof responseToUser === 'string') {\n      let responseJson = {};\n      responseJson.speech = responseToUser; // spoken response\n      responseJson.displayText = responseToUser; // displayed response\n      response.json(responseJson); // Send response to Dialogflow\n    } else {\n      // If the response to the user includes rich responses or contexts send them to Dialogflow\n      let responseJson = {};\n\n      // If speech or displayText is defined, use it to respond (if one isn't defined use the other's value)\n      responseJson.speech = responseToUser.speech || responseToUser.displayText;\n      responseJson.displayText = responseToUser.displayText || responseToUser.speech;\n\n      // Optional: add rich messages for integrations (https://dialogflow.com/docs/rich-messages)\n      responseJson.data = responseToUser.richResponses;\n\n      // Optional: add contexts (https://dialogflow.com/docs/contexts)\n      responseJson.contextOut = responseToUser.outputContexts;\n\n      response.json(responseJson); // Send response to Dialogflow\n    }\n  }\n});\n\n// Construct rich response for Google Assistant\nconst app = new DialogflowApp();\nconst googleRichResponse = app.buildRichResponse()\n  .addSimpleResponse('This is the first simple response for Google Assistant')\n  .addSuggestions(\n    ['Suggestion Chip', 'Another Suggestion Chip'])\n    // Create a basic card and add it to the rich response\n  .addBasicCard(app.buildBasicCard(`This is a basic card.  Text in a\n basic card can include \"quotes\" and most other unicode characters\n including emoji 📱.  Basic cards also support some markdown\n formatting like *emphasis* or _italics_, **strong** or __bold__,\n and ***bold itallic*** or ___strong emphasis___ as well as other things\n like line  \\nbreaks`) // Note the two spaces before '\\n' required for a\n                        // line break to be rendered in the card\n    .setSubtitle('This is a subtitle')\n    .setTitle('Title: this is a title')\n    .addButton('This is a button', 'https://assistant.google.com/')\n    .setImage('https://developers.google.com/actions/images/badges/XPM_BADGING_GoogleAssistant_VER.png',\n      'Image alternate text'))\n  .addSimpleResponse({ speech: 'This is another simple response',\n    displayText: 'This is the another simple response 💁' });\n\n// Rich responses for both Slack and Facebook\nconst richResponses = {\n  'slack': {\n    'text': 'This is a text response for Slack.',\n    'attachments': [\n      {\n        'title': 'Title: this is a title',\n        'title_link': 'https://assistant.google.com/',\n        'text': 'This is an attachment.  Text in attachments can include \\'quotes\\' and most other unicode characters including emoji 📱.  Attachments also upport line\\nbreaks.',\n        'image_url': 'https://developers.google.com/actions/images/badges/XPM_BADGING_GoogleAssistant_VER.png',\n        'fallback': 'This is a fallback.'\n      }\n    ]\n  },\n  'facebook': {\n    'attachment': {\n      'type': 'template',\n      'payload': {\n        'template_type': 'generic',\n        'elements': [\n          {\n            'title': 'Title: this is a title',\n            'image_url': 'https://developers.google.com/actions/images/badges/XPM_BADGING_GoogleAssistant_VER.png',\n            'subtitle': 'This is a subtitle',\n            'default_action': {\n              'type': 'web_url',\n              'url': 'https://assistant.google.com/'\n            },\n            'buttons': [\n              {\n                'type': 'web_url',\n                'url': 'https://assistant.google.com/',\n                'title': 'This is a button'\n              }\n            ]\n          }\n        ]\n      }\n    }\n  }\n};",g='{\n  "name": "dialogflowFirebaseFulfillment",\n  "description": "This is the default fulfillment for a Dialogflow agents using Cloud Functions for Firebase",\n  "version": "0.0.1",\n  "private": true,\n  "license": "Apache Version 2.0",\n  "author": "Google Inc.",\n  "engines": {\n    "node": "~6.0"\n  },\n  "scripts": {\n    "start": "firebase serve --only functions:dialogflowFirebaseFulfillment",\n    "deploy": "firebase deploy --only functions:dialogflowFirebaseFulfillment"\n  },\n  "dependencies": {\n    "actions-on-google": "^1.5.x",\n    "firebase-admin": "^4.2.1",\n    "firebase-functions": "^0.5.7",\n    "apiai": "^4.0.3"\n  }\n}',h=r()({indexJsFile:{fileName:s,sourceCode:m},packageJsonFile:{fileName:l,sourceCode:g}})},,function(e,t,n){"use strict";var i=n(0),o=n.n(i);n.d(t,"a",function(){return a});var a=function e(t){o()(this,e),this.name=t.name,this.agentId=t.agentId,this.comment=t.comment,this.agentVersion=t.agentVersion,this.state=t.state};!function(e){!function(e){e[e.READY="READY"]="READY"}(e.State||(e.State={}))}(a||(a={}))},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=function(){function e(){o()(this,e)}return r()(e,null,[{key:"defaultLimits",value:function(){var t=new e;return t.enableProfileLimits=!0,t.enableAgentLimits=!0,t.agentsNumber=e.MAX_AGENTS_NUMBER,t.userSaysNumber=e.MAX_USER_SAYS_NUMBER,t.intentsNumber=e.MAX_INTENTS_NUMBER,t.entitiesNumber=e.MAX_ENTITIES_NUMBER,t.entityEntriesNumber=e.MAX_ENTITY_ENTRIES_NUMBER,t.entrySynonymsNumber=e.MAX_ENTRY_SYNONYMS_NUMBER,t.intentParamsNumber=e.MAX_INTENT_PARAMS_NUMBER,t.inputContextsNumber=e.MAX_INPUT_CONTEXTS_NUMBER,t.outputContextsNumber=e.MAX_OUTPUT_CONTEXTS_NUMBER,t.textResponsesNumber=e.MAX_TEXT_RESPONSES_NUMBER,t.paramPromptsNumber=e.MAX_PARAM_PROMPTS_NUMBER,t.userSaysTextLength=e.MAX_USER_SAYS_TEXT_LENGTH,t.intentNameLength=e.MAX_INTENT_NAME_LENGTH,t.entityNameLength=e.MAX_ENTITY_NAME_LENGTH,t.actionNameLength=e.MAX_ACTION_NAME_LENGTH,t.contextNameLength=e.MAX_CONTEXT_NAME_LENGTH,t.entryValueLength=e.MAX_ENTRY_VALUE_TEXT_LENGTH,t.paramNameLength=e.MAX_PARAM_NAME_LENGTH,t.textResponseLength=e.MAX_TEXT_RESPONSE_LENGTH,t.agentDescriptionLength=e.MAX_AGENT_DESCRIPTION_LENGTH,t.maxShowPromptsLength=e.MAX_SHOW_PROMPTS_LENGTH,t.maxSelectorItemLength=e.MAX_SELECTOR_ITEM_LENGTH,t.googleIntentsNumber=e.MAX_GOOGLE_ASSISTANT_INTENTS_NUMBER,t.googleSuggestionTextLength=e.MAX_GOOGLE_SUGGESTION_TEXT_LENGTH,t.googleSuggestionChipsNumber=e.MAX_GOOGLE_SUGGESTION_CHIPS_NUMBER,t.googleListCardItemsNumber=e.MAX_GOOGLE_LIST_CARD_ITEMS_NUMBER,t.googleCustomPayloadsNumber=e.MAX_GOOGLE_CUSTOM_PAYLOADS_NUMBER,t.urlLength=e.MAX_URL_LENGTH,t.quickReplyLength=e.MAX_QUICK_REPLY_LENGTH,t}}]),e}();s.MAX_AGENTS_NUMBER=50,s.MAX_USER_SAYS_NUMBER=2e3,s.MAX_INTENTS_NUMBER=2e3,s.MAX_ENTITIES_NUMBER=250,s.MAX_ENTITY_ENTRIES_NUMBER=3e4,s.MAX_ENTRY_SYNONYMS_NUMBER=100,s.MAX_INTENT_PARAMS_NUMBER=20,s.MAX_INPUT_CONTEXTS_NUMBER=5,s.MAX_OUTPUT_CONTEXTS_NUMBER=10,s.MAX_TEXT_RESPONSES_NUMBER=30,s.MAX_PARAM_PROMPTS_NUMBER=30,s.MAX_USER_SAYS_TEXT_LENGTH=768,s.MAX_ENTRY_VALUE_TEXT_LENGTH=512,s.MAX_INTENT_NAME_LENGTH=100,s.MAX_ENTITY_NAME_LENGTH=30,s.MAX_ACTION_NAME_LENGTH=250,s.MAX_CONTEXT_NAME_LENGTH=250,s.MAX_PARAM_NAME_LENGTH=30,s.MAX_TEXT_RESPONSE_LENGTH=4e3,s.MAX_AGENT_DESCRIPTION_LENGTH=1e3,s.MAX_SHOW_PROMPTS_LENGTH=15,s.MAX_SELECTOR_ITEM_LENGTH=30,s.MAX_GOOGLE_ASSISTANT_INTENTS_NUMBER=10,s.MAX_GOOGLE_SUGGESTION_TEXT_LENGTH=25,s.MAX_GOOGLE_SUGGESTION_CHIPS_NUMBER=8,s.MAX_GOOGLE_LIST_CARD_ITEMS_NUMBER=30,s.MAX_GOOGLE_CUSTOM_PAYLOADS_NUMBER=1,s.MAX_URL_LENGTH=2e3,s.MAX_QUICK_REPLY_LENGTH=20,t.a=s},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(211);n.d(t,"a",function(){return r});var r=function e(t){o()(this,e),this.agentId=t.agentId,this.version=t.version,this.creationTime=new a.a(t.creationTime),this.comment=t.comment}},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(41);n.d(t,"a",function(){return l});var l=function(){function e(t){o()(this,e),this.seconds=t.seconds,this.nanos=t.nanos}return r()(e,[{key:"getAsAgo",value:function(){return s.a.relativeTime(1e3*this.seconds,s.a.RelativeTimeMode.MODE_FULL,!0)}}]),e}()},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=function e(t){o()(this,e),angular.extend(this,t)};!function(e){var t=function e(){o()(this,e)};t.DAILY="1",t.MONTHLY="30",t.WEEKLY="7",e.Period=t;var n=function e(){o()(this,e)};e.ValueFormatter=n}(a||(a={})),t.a=a},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=function(){function e(t){o()(this,e),t&&(this.platforms=t),this.platforms||(this.platforms={})}return r()(e,[{key:"contains",value:function(e){return this.platforms.hasOwnProperty(e.name)}},{key:"getEnabled",value:function(e){return!!this.platforms[e.name]}},{key:"setEnabled",value:function(e,t){this.platforms[e.name]=t}},{key:"serializable",value:function(){return this.platforms}}]),e}();t.a=s},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=function e(){o()(this,e)};t.a=a},,,,function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(27);n.d(t,"a",function(){return l});var l=function(){function e(t,n,i){o()(this,e),this.$http=t,this.$q=n,this.urls=i,this.cachePromise=null,this.agentsAr=[],this.publishArtifactsList={},this.publicAgentListPromises={},this.agentUrl=i.apiUrls.agent,this.agentPrivateUrl=i.apiUrls.agentPrivate,this.agentBackendUrl=i.apiUrls.agentBackend,this.listAgents()}return e.$inject=["$http","$q","urls"],r()(e,[{key:"startAgentTraining",value:function(){return this.$http.post(this.urls.apiUrls.train,null)}},{key:"addAgent",value:function(e){var t=this,n=e.cloudProjectId?this.agentUrl+"?cloudProjectId="+e.cloudProjectId:this.agentUrl;return this.$http.post(n,e).then(function(e){var n=e.data;return t._isSuccessData(n)?t.getAgent(n.id).then(function(n){var i=n.data;return t._isSuccessData(i)&&t.agentsAr.push(i.agent),e}):t.$q.reject(e)})}},{key:"listAgents",value:function(){var e=this;return this.cachePromise=this.$http.get(this.agentUrl).then(function(t){return t.data&&(e.agentsAr=t.data.agents),t}),this.cachePromise}},{key:"cacheAgents",value:function(){return this.cachePromise||this.listAgents()}},{key:"clearCacheAgentsAr",value:function(){return this.agentsAr=[],this.cachePromise=null,this.listAgents()}},{key:"cacheAgentsAr",value:function(){return this.agentsAr}},{key:"getAgent",value:function(e){return this.$http.get(this.agentUrl+"/"+e)}},{key:"updateAgent",value:function(e){var t=this;return this.cachePromise=null,this.$http.put(this.agentPrivateUrl+"/"+e.id,e).then(function(n){var i=n.data;return t._isSuccessData(i)&&(t.agentsAr=t.agentsAr.map(function(t){return t.id===e.id?e:t})),n})}},{key:"deleteAgent",value:function(e){var t=this;return this.cachePromise=null,this.$http.delete(this.agentPrivateUrl+"/"+e).then(function(n){var i=n.data;t._isSuccessData(i)&&(t.agentsAr=t.agentsAr.filter(function(t){return t.id!==e}))})}},{key:"createClassifierAlias",value:function(e){return this.$http.post("/api/classifierAlias?originalId="+encodeURIComponent(e),null)}},{key:"checkExistEntryUpload",value:function(e,t){return this.$http.get(e+"/check_name?name="+t)}},{key:"refreshPrimaryKey",value:function(e){var t=this,n=e.id;return this.$http.put(this.agentUrl+"/"+n+"/refresh-primary-key",e).then(function(e){var i=e.data;return t._isSuccessData(i)?t.getAgent(n).then(function(e){var i=e.data;if(t._isSuccessData(i)){var o=i.agent.primaryKey;t.agentsAr.some(function(e){return e.id===n&&(e.primaryKey=o,!0)})}return e},function(n){return t.$q.reject(e)}):t.$q.reject(e)})}},{key:"startCheckAgentTrainingStatus",value:function(){return this.$http.get(this.urls.apiUrls.isAgentInTraining)}},{key:"refreshSecondaryKey",value:function(e){var t=this,n=e.id;return this.$http.put(this.agentUrl+"/"+n+"/refresh-secondary-key",e).then(function(e){var i=e.data;return t._isSuccessData(i)?t.getAgent(n).then(function(e){var i=e.data;if(t._isSuccessData(i)){var o=i.agent.secondaryKey;t.agentsAr.some(function(e){return e.id===n&&(e.secondaryKey=o,!0)})}return e},function(n){return t.$q.reject(e)}):t.$q.reject(e)})}},{key:"setEnableCceIntegration",value:function(e){var t=this,n=e.id;return this.$http.put(this.agentUrl+"/"+n+"/enableCceIntegration/"+e.enableCceIntegration,null).then(function(e){var i=e.data;return t._isSuccessData(i)?t.getAgent(n).then(function(e){var i=e.data;if(t._isSuccessData(i)){var o=i.agent.enableCceIntegration;return t.agentsAr.some(function(e){return e.id===n&&(e.enableCceIntegration=o,!0)}),i.agent}return t.$q.reject(e)},function(n){return t.$q.reject(e)}):t.$q.reject(e)})}},{key:"refreshServiceAccountKey",value:function(e){var t=this,n=e.id;return this.$http.put(this.agentUrl+"/"+n+"/refresh-cce-service-account",null).then(function(e){var i=e.data;return t._isSuccessData(i)?t.getAgent(n).then(function(e){var i=e.data;if(t._isSuccessData(i)){var o=i.agent.cloudServiceAccountName,a=i.agent.cloudServiceAccountKeyName,r=i.agent.cloudServiceAccountKeyData;return t.agentsAr.some(function(e){return e.id===n&&(e.cloudServiceAccountName=o,e.cloudServiceAccountKeyName=a,e.cloudServiceAccountKeyData=r,!0)}),i.agent}return t.$q.reject(e)},function(n){return t.$q.reject(e)}):t.$q.reject(e)})}},{key:"_isSuccessData",value:function(e){var t=void 0,n=void 0;return e&&(t=e.status)&&(n=t.code)&&n>199&&n<300}},{key:"publishAgent",value:function(e){return delete this.publishArtifactsList[e.id],this.$http.get(this.urls.apiUrls.publishAgent)}},{key:"getPublishArtifactsList",value:function(e){var t=this;return this.publishArtifactsList[e.id]?this.$q.resolve(this.publishArtifactsList[e.id]):this.$http.get(this.urls.apiUrls.publishArtifacts).then(function(n){return t.publishArtifactsList[e.id]=n.data,t.$q.resolve(t.publishArtifactsList[e.id])})}},{key:"downloadPublishedArifact",value:function(e){if(void 0===(window.URL||window.webkitURL).createObjectURL)return this.$q.reject();var t=this.urls.apiUrls.publishArtifacts+"/"+e;return this.$http({url:t,method:"GET",responseType:"arraybuffer"}).then(this.resolveDownloadPromise.bind(this,e)).catch(this.rejectDownloadPromise.bind(this))}},{key:"getSamplesData",value:function(e){return this.$http.get(this.urls.apiUrls.presetAgentNames,e?{params:{lang:e}}:null)}},{key:"loadPresetAgent",value:function(e){return this.$http.post(this.urls.apiUrls.loadPresetAgent+"?agentName="+e,null)}},{key:"loadPublicAgent",value:function(e,t){return this.$http.post(this.urls.apiUrls.loadPublicAgent+"?agentName="+e+"&lang="+t,null)}},{key:"getPublicAgentsList",value:function(e){return this.publicAgentListPromises[e]||(this.publicAgentListPromises[e]=this.$http.get("/api/agent/publicAgentsList?lang="+e).then(function(e){return e&&e.data&&e.data.length?e.data.map(function(e){return new s.a(e)}):[]}).catch(function(){return[]})),this.publicAgentListPromises[e]}},{key:"downloadAgent",value:function(e,t){t=void 0===t?{}:t;var n=t.forAlexa||!1,i=t.legacyExport||!1;if(void 0===(window.URL||window.webkitURL).createObjectURL)return this.$q.reject();var o=n?this.urls.apiUrls.downloadAlexaAgent:this.urls.apiUrls.downloadAgent,a=e?o+"/?name="+encodeURIComponent(e):this.urls.apiUrls.downloadAgent;return i&&(a+=(e?"&":"/?")+"legacyExport="+i),this.$http({url:a,method:"GET",responseType:"arraybuffer"}).then(this.resolveDownloadPromise.bind(this,e,a)).catch(this.rejectDownloadPromise.bind(this))}},{key:"getPermissions",value:function(e){return this.$http.get(this.agentBackendUrl+"/"+e+"/permissions").then(function(e){return e.data})}},{key:"setPermissions",value:function(e,t){return this.$http.post(this.agentBackendUrl+"/"+e+"/permissions",t)}},{key:"getSecuritySettings",value:function(){return this.$http.get(this.agentBackendUrl+"/securitySettings").then(function(e){return e.data})}},{key:"resolveDownloadPromise",value:function(e,t,n){var i=null;try{i=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(n.headers("content-disposition"))[1],n.headers("content-type")}catch(t){"application/zip",i=e+".zip"}if(-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Safari")){var o=null;try{o=n.config.headers.Authorization.split(" ")[1]}catch(e){}if(!o)throw new Error("Error downloading agent");t=t+"&access_token="+o,window.location.href=t}else{var a=new Blob([n.data],{type:"application/zip"});saveAs(a,i)}}},{key:"rejectDownloadPromise",value:function(e){if(e&&e.data&&e.data instanceof ArrayBuffer)try{e.data=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e.data)))}catch(t){e.data=null}return this.$q.reject(e)}}]),e}()},function(e,t,n){"use strict";var i=n(39),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(209),c=n(32),d=function(){function e(t){r()(this,e),this.apiLimits=null,this.clientConfig={},this.initConfigWithData(t)}return e.$inject=["preloadServerConfig"],l()(e,[{key:"getSupportEmail",value:function(){return e.SUPPORT_EMAIL}},{key:"getLimits",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!this.apiLimits){var e=this.getProfileLimits();this.apiLimits=u.a.defaultLimits(),e&&_.assign(this.apiLimits,e)}return this.apiLimits}},{key:"getProfileLimits",value:function(){if(this.apiLimits){var e=new u.a;return e.enableProfileLimits=this.apiLimits.enableProfileLimits,e.agentsNumber=this.apiLimits.agentsNumber,e}return null}},{key:"getClientConfig",value:function(){return this.clientConfig}},{key:"getConfigRecord",value:function(e,t){return _.get(this.clientConfig,e,t)}},{key:"hasCapability",value:function(e){return this.capabilities[e]}},{key:"initConfigWithData",value:function(e){var t=this;angular.extend(this.clientConfig,e);var n={mlClassifierType:"http",aogV1SimulatorUrl:"https://developers.google.com/actions/tools/web-simulator",aogV2BaseUrl:"aogV2BaseUrl",webhookMigrationGuideUrl:"https://developers.google.com/actions/reference/webhook-migration"};o()(n).forEach(function(e){t.clientConfig[e]||(t.clientConfig[e]=n[e])})}},{key:"setCapabilities",value:function(e){this.capabilities=e}},{key:"isUsingSmalltalk",value:function(t){return t&&t.activeAssistantAgents&&t.activeAssistantAgents.length&&(_.contains(t.activeAssistantAgents,e.SMALLTALK_DOMAIN_ON)||_.contains(t.activeAssistantAgents,e.SMALLTALK_FULFILLMENT_ON))}},{key:"isPublicAgentsAvailable",value:function(e){return!0}},{key:"isSmallTalkAvailable",value:function(e){return[c.a.SupportedLanguages.EN,c.a.SupportedLanguages.EN_AU,c.a.SupportedLanguages.EN_CA,c.a.SupportedLanguages.EN_GB,c.a.SupportedLanguages.EN_US,c.a.SupportedLanguages.FR,c.a.SupportedLanguages.FR_CA,c.a.SupportedLanguages.FR_FR,c.a.SupportedLanguages.RU,c.a.SupportedLanguages.IT].indexOf(e)>-1}},{key:"enableSmallTalk",value:function(t){t.activeAssistantAgents||(t.activeAssistantAgents=[]),_.contains(t.activeAssistantAgents,e.SMALLTALK_DOMAIN_ON)||t.activeAssistantAgents.push(e.SMALLTALK_DOMAIN_ON),_.contains(t.activeAssistantAgents,e.SMALLTALK_FULFILLMENT_ON)||t.activeAssistantAgents.push(e.SMALLTALK_FULFILLMENT_ON)}},{key:"disableSmallTalk",value:function(t){_.pull(t.activeAssistantAgents,e.SMALLTALK_FULFILLMENT_ON),_.pull(t.activeAssistantAgents,e.SMALLTALK_DOMAIN_ON)}}]),e}();t.a=d,d.SUPPORT_EMAIL="support@dialogflow.com",d.SMALLTALK_DOMAIN_ON="smalltalk-domain-on",d.SMALLTALK_FULFILLMENT_ON="smalltalk-fulfillment-on"},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(17);n.d(t,"a",function(){return l});var l=function(){function e(t,n,i,a){o()(this,e),this.$q=t,this.CurrentAgentService=n,this.IntentSharedService=i,this.IntentData=a}return e.$inject=["$q","CurrentAgentService","IntentSharedService","IntentData"],r()(e,[{key:"makeMarkup",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this.CurrentAgentService.useCustomClassifier())return this.$q.reject();if(!0===t.isTemplate)return this.$q.reject();if(s.a.templateHasMetas(t))return this.$q.reject();if(this.IntentSharedService.autoMarkupDisabled())return this.$q.reject();if(!o)return this.$q.reject();if(""===s.a.glueClean(t))return this.$q.reject();var r={template:t,markedUpTemplates:n.slice(0,e.MARKED_UP_TEMPLATES_FOR_MARKUP_COUNT).filter(function(e){return e!==t&&""!==s.a.glueClean(e)})};return i&&(r.intentId=i),a&&(r.limitEntities=a),this.IntentData.intentMarkup(r,this.CurrentAgentService.getCurrentLanguage())}}]),e}();l.MARKED_UP_TEMPLATES_FOR_MARKUP_COUNT=50},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(t,n,i,a,r){o()(this,e),this.$http=t,this.$q=n,this.urls=i,this.IntentData=a,this.CurrentAgentService=r}return e.$inject=["$http","$q","urls","IntentData","CurrentAgentService"],r()(e,[{key:"moveCopyBatchRequest",value:function(e,t,n,i,o){var a=this;if(!e||!e.length)return this.$q.reject({status:{errorDetails:"No items selected"}});if(!t)return this.$q.reject({status:{errorDetails:"No destination agent selected"}});if("move"!==n.toString()&&"copy"!==n.toString())return this.$q.reject({status:{errorDetails:"Unsupported operation"}});if("intent"!==i.toString()&&"entity"!==i.toString())return this.$q.reject({status:{errorDetails:"Unsupported subject"}});var r=this.urls.apiUrls[i]+"/batch/"+n+"?toAgentId="+t;return o&&(r+=o.copyEntities?"&copyEntities=true":"",r+=o.overwriteEntities?"&overwriteEntities=true":"",r+=o.overwriteIntents?"&overwriteIntents=true":""),r+="&lang="+this.CurrentAgentService.getCurrentLanguage().toString(),this.$http.post(r,e).then(function(){return"intent"===i&&a.IntentData.invalidateIntentsCache(),{}})}}]),e}()},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(t,n){o()(this,e),this.$http=t,this.urls=n}return e.$inject=["$http","urls"],r()(e,[{key:"enableFunctionsAsync",value:function(e){var t=this.urls.cloudFunctions.enableAsync+"/"+e;return this.$http.get(t).then(function(e){return e.data})}},{key:"checkServiceManagerOperation",value:function(e){var t=this.urls.cloudFunctions.checkServiceManagerOperation+"/"+e;return this.$http.get(t).then(function(e){return e.data})}},{key:"getFunction",value:function(e){var t=this.urls.cloudFunctions.get+"/"+e;return this.$http.get(t).then(function(e){return e.data})}},{key:"deployFunction",value:function(e){return this.$http.post(this.urls.cloudFunctions.deploy,e).then(function(e){return e.data})}},{key:"checkOperation",value:function(e){var t=this.urls.cloudFunctions.checkOperation+"/"+e;return this.$http.get(t).then(function(e){return e.data})}},{key:"getFirebaseBillingPlan",value:function(e){var t=this.urls.cloudFunctions.getFirebaseBillingPlan+"/"+e;return this.$http.get(t).then(function(e){return e.data.billingPlan})}},{key:"getLogs",value:function(e){var t=this.urls.cloudFunctions.getLogs+"/"+e;return this.$http.get(t).then(function(e){return e.data})}},{key:"downloadFunctionUrl",value:function(e){return this.urls.cloudFunctions.downloadFunction+"/"+e}}]),e}()},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(13),l=n(61);n.d(t,"a",function(){return u});var u=function(){function e(t,n,i,a){o()(this,e),this.$http=t,this.$q=n,this.urls=i,this.CurrentAgentService=a,this.loadedQuestions={},this.loadedAnswers={},this.loadedDomainsConfig={},s.a.subscribe(s.a.DEFINED_EVENTS.AGENT_UPLOAD_SUCCESS,this.clearDomainPersistenceCache.bind(this))}return e.$inject=["$http","$q","urls","CurrentAgentService"],r()(e,[{key:"loadQuestions",value:function(e){var t=this;if(this.loadedQuestions[e.toString()])return this.$q.resolve(this.loadedQuestions[e.toString()]);var n=this.urls.domainsQuestion+"?lang="+e.toString();return this.$http.get(n).then(function(n){return t.loadedQuestions[e.toString()]=n.data&&n.data[0]?n.data[0]:null,t.$q.resolve(t.loadedQuestions[e.toString()])})}},{key:"loadAnswers",value:function(e){var t=this,n=this.loadedAnswers,i=this.getAnswersCacheKey(e);return n[i]?this.$q.resolve(n[i]):this.$http.get(this.getAnswersUrl(e)).then(function(e){return n[i]=e,t.$q.resolve(e)})}},{key:"saveAnswers",value:function(e,t){var n=this,i=this.loadedAnswers;return this.$http.put(this.getAnswersUrl(t),e).then(function(o){return i[n.getAnswersCacheKey(t)]={data:e},n.$q.resolve(o)})}},{key:"loadDomainsConfig",value:function(e){var t=this;return this.loadedDomainsConfig[e]?this.$q.resolve(this.loadedDomainsConfig[e]):this.$http.get(this.urls.domainsList+"?lang="+e).then(function(n){return n&&n.data?(t.loadedDomainsConfig[e]=n.data.map(function(e){return e.sampleRequests=e.translatedSampleRequests.join("\n"),delete e.translatedSampleRequests,new l.a(e)}),t.$q.resolve(t.loadedDomainsConfig[e])):(t.loadedDomainsConfig[e]=[],t.loadedDomainsConfig[e])})}},{key:"getSmalltalkV1V2Map",value:function(){return this.$http.get(this.urls.smalltalkV1V2Map)}},{key:"clearDomainPersistenceCache",value:function(){this.loadedQuestions={},this.loadedAnswers={},this.loadedDomainsConfig={}}},{key:"getAnswersCacheKey",value:function(e){return this.CurrentAgentService.getId()+"#"+e.toString()}},{key:"getAnswersUrl",value:function(e){return this.urls.apiUrls.customDomainResponses+"?lang="+e.toString()}}]),e}()},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(13),l=n(93);n.d(t,"a",function(){return u});var u=function(){function e(t,n){o()(this,e),this.$http=t,this.urls=n}return e.$inject=["$http","urls"],r()(e,[{key:"saveEntity",value:function(e,t){return this.$http.post(this.constructApiUrl({lang:t}),e).then(function(e){return s.a.publish(s.a.DEFINED_EVENTS.AGENT_DATA_UPDATE,{subject:"entity",event:"created"}),e})}},{key:"listEntities",value:function(){return this.$http.get(this.constructApiUrl({}))}},{key:"getEntity",value:function(e,t){return this.$http.get(this.constructApiUrl({id:e,lang:t}))}},{key:"updateEntity",value:function(e,t){return this.$http.put(this.constructApiUrl({id:e.id,lang:t}),e)}},{key:"deleteEntity",value:function(e){return this.$http.delete(this.constructApiUrl({id:e})).then(function(e){return s.a.publish(s.a.DEFINED_EVENTS.AGENT_DATA_UPDATE,{subject:"entity",event:"removed"}),e})}},{key:"deleteEntities",value:function(e){return this.$http.delete(this.constructApiUrl({}),{data:e}).then(function(t){return s.a.publish(s.a.DEFINED_EVENTS.AGENT_DATA_UPDATE,{subject:"entity",event:"removed",count:e.length}),t})}},{key:"downloadEntity",value:function(e,t,n,i){return this.$http({method:"GET",url:this.constructApiUrl({id:e,lang:i,customGET:"dl=1&format="+n})}).then(l.a.resolveDownloadPromise.bind(this,t,n))}},{key:"constructApiUrl",value:function(e){var t=this.urls.apiUrls.entity;return e?(e.id&&(t+="/"+e.id),e.custom&&(t+="/"+e.custom),e.customGET?(t+="?"+e.customGET,e.lang&&(t+="&lang="+e.lang)):e.lang&&(t+="?lang="+e.lang),t):t}}]),e}()},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(t){var n=this;o()(this,e),this.$http=t,this.incrementalAuthCallback=function(e){return n.$http.post("/api-client/increment_auth_google",e)}}return e.$inject=["$http"],r()(e,[{key:"checkGCPOauthTokenScope",value:function(){return this.$http.get("/api-client/checkGCPScope")}},{key:"checkOauthTokenScope",value:function(){return this.$http.get("/api-client/checkAssistantScope")}},{key:"enableSharing",value:function(e,t){var n="/api-client/agent/"+e+"/sharing";return t&&(n+="?cloudProjectId="+t),this.$http.post(n,null)}},{key:"disableSharing",value:function(e){return this.$http.delete("/api-client/agent/"+e+"/sharing",null)}},{key:"retrieveActionPackage",value:function(){return this.$http.get(e.API_BASE_URL)}},{key:"actionPackagePreview",value:function(){var t=e.API_BASE_URL+"/preview";return this.$http.post(t,{})}},{key:"actionPackageSubmit",value:function(){var t=e.API_BASE_URL+"/submit";return this.$http.post(t,{})}},{key:"updateWelcomeIntent",value:function(t){var n=e.API_BASE_URL+"/updateWelcomeIntent";return this.$http.post(n,t)}},{key:"isProjectCompatible",value:function(){var t=e.APIV2_BASE_URL+"/isProjectCompatible";return this.$http.get(t).then(function(e){return e.data})}},{key:"createAssistantProject",value:function(){var t=e.APIV2_BASE_URL+"/create";return this.$http.post(t,{})}},{key:"v2UpdateAgent",value:function(){var t=e.APIV2_BASE_URL+"/update";return this.$http.post(t,{}).then(function(e){return e.data})}},{key:"v2TestAgent",value:function(){var t=e.APIV2_BASE_URL+"/preview";return this.$http.post(t,{}).then(function(e){return e.data})}},{key:"checkTermsIsAccepted",value:function(){return this.$http.get("/api-client/checkTerms").then(function(e){return e.data})}},{key:"acceptTerms",value:function(){return this.$http.post("/api-client/acceptTerms",{})}},{key:"listUnAssignedProjects",value:function(){return this.$http.get("/api-client/getUnassignedProjects").then(function(e){return e.data.projectLinks})}}]),e}();s.API_BASE_URL="/api/agent/googleassistant",s.APIV2_BASE_URL="/api/agent/googleassistantv2"},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(13),l=n(93);n.d(t,"a",function(){return u});var u=function(){function e(t,n,i){o()(this,e),this.$http=t,this.$q=n,this.intentsListCache=null,this.intentsListCacheInvalid=!0,this.followUpIntentsListCache={},this.intentUrl=null,this.intentFollowUpUrl=null,this.headers={},this.intentUrl=i.apiUrls.intent,this.intentFollowUpUrl=i.apiUrls.intentFollowUp}return e.$inject=["$http","$q","urls"],r()(e,[{key:"autoSaveIntent",value:function(e,t){var n=this,i=void 0;return this.headers={"X-INTENT-AUTOSAVE":!0},i=e.id.length?this.updateIntent(e,t):this.saveIntent(e,t),i.finally(function(){return delete n.headers["X-INTENT-AUTOSAVE"]}),i}},{key:"saveIntent",value:function(e,t){return this.intentsListCacheInvalid=!0,this.$http({method:"POST",url:this.constructApiUrl({lang:t}),data:e,headers:this.headers}).then(function(e){return s.a.publish(s.a.DEFINED_EVENTS.AGENT_DATA_UPDATE,{subject:"intent",event:"created"}),e})}},{key:"addFollowupIntent",value:function(e,t,n){return this.intentsListCacheInvalid=!0,this.$http({method:"POST",url:this.constructApiUrl({id:e,custom:"followup/"+t,lang:n}),headers:this.headers}).then(function(e){return s.a.publish(s.a.DEFINED_EVENTS.AGENT_DATA_UPDATE,{subject:"intent",event:"created"}),e})}},{key:"listIntents",value:function(){var e=this;return!this.intentsListCacheInvalid&&this.intentsListCache?this.$q(function(t){t(e.intentsListCache)}):this.$http.get(this.constructApiUrl({})).then(function(t){return e.intentsListCache=t.data,e.intentsListCacheInvalid=!1,e.$q.resolve(e.intentsListCache)}).catch(function(t){return console.log("AutocompleteData.listIntents() -> error",t),e.$q.resolve([])})}},{key:"getTypesFollowUpIntents",value:function(e){var t=this;return this.followUpIntentsListCache[e]?this.$q(function(n){n(t.followUpIntentsListCache[e])}):this.$http.get(this.intentFollowUpUrl+"/"+e).then(function(n){return t.followUpIntentsListCache[e]=n.data,t.$q.resolve(t.followUpIntentsListCache[e])})}},{key:"structureTreeFollowUpIntents",value:function(e){var t=[],n=[];return _.forEach(e,function(e){n[e.id]=e,e.followUpIntents=[]}),_.forEach(e,function(e){null!=e.parentId?n[e.parentId]&&n[e.parentId].followUpIntents.push(e):t.push(e)}),t}},{key:"sortTypesFollowUpIntents",value:function(e){for(var t=["custom","fallback","yes","no","later","cancel","more","next","previous","repeat","select.number"],n=[],i=0;i<t.length;i++){var o=_.find(e,{name:t[i]});o&&n.push(o)}return n}},{key:"listNonFallbackIntents",value:function(){return this.listIntents().then(function(e){return e.filter(function(e){return!e.fallbackIntent})})}},{key:"getIntent",value:function(e,t){return this.$http.get(this.constructApiUrl({id:e,lang:t}))}},{key:"downloadIntent",value:function(e,t,n,i){return this.$http({method:"GET",url:this.constructApiUrl({id:e,lang:i,customGET:"dl=1&format="+n})}).then(l.a.resolveDownloadPromise.bind(this,t,n))}},{key:"getIntentFields",value:function(e,t){return this.$http.get(this.constructApiUrl({id:e}),{params:{fields:t.join(",")}})}},{key:"updateIntent",value:function(e,t){return this.checkIntentsListCacheValidityOnUpdateIntent(e),this.$http({method:"PUT",url:this.constructApiUrl({id:e.id,lang:t}),data:e,headers:this.headers})}},{key:"deleteIntent",value:function(e,t){return this.intentsListCacheInvalid=!0,this.$http({method:"DELETE",url:this.constructApiUrl({id:e}),params:t}).then(function(e){return s.a.publish(s.a.DEFINED_EVENTS.AGENT_DATA_UPDATE,{subject:"intent",event:"removed"}),e})}},{key:"deleteIntents",value:function(e){var t=this,n={data:e,headers:{"Content-type":"application/json;charset=utf-8"}};return this.$http.delete(this.intentUrl,n).then(function(n){return t.intentsListCacheInvalid=!0,s.a.publish(s.a.DEFINED_EVENTS.AGENT_DATA_UPDATE,{subject:"intent",event:"removed",count:e.length}),n})}},{key:"pushContext",value:function(e,t){return this.intentsListCacheInvalid=!0,this.$http({method:"PUT",url:this.intentUrl+"/"+e+"/context",params:t,headers:this.headers})}},{key:"deleteContext",value:function(e,t){return this.intentsListCacheInvalid=!0,this.$http({method:"DELETE",url:this.intentUrl+"/"+e+"/context",params:t,headers:this.headers})}},{key:"intentMarkup",value:function(e,t){return this.$http({method:"POST",url:this.constructApiUrl({custom:"markup",lang:t}),data:e})}},{key:"intentTesting",value:function(e){return this.$http.get(this.constructApiUrl({id:e,custom:"testing"}))}},{key:"invalidateIntentsCache",value:function(){this.intentsListCacheInvalid=!0}},{key:"checkIntentsListCacheValidityOnUpdateIntent",value:function(e){var t=_.find(this.intentsListCache,function(t){return t.name===e.name});t||(this.intentsListCacheInvalid=!0);var n=void 0;!this.intentsListCacheInvalid&&e.responses.length&&e.responses[0].affectedContexts?(n=_.clone(e.responses[0].affectedContexts),n=n.map(function(e){return delete e.label,delete e.value,e})):n=[],!t||t.priority===e.priority&&_.isEqual(t.contextIn,e.contexts)&&_.isEqual(t.contextOut,n)||(this.intentsListCacheInvalid=!0),this.intentsListCacheInvalid||_.isEqual(t.events,e.events)||(this.intentsListCacheInvalid=!0)}},{key:"constructApiUrl",value:function(e){var t=this.intentUrl;return e?(e.id&&(t+="/"+e.id),e.custom&&(t+="/"+e.custom),e.customGET?(t+="?"+e.customGET,e.lang&&(t+="&lang="+e.lang)):e.lang&&(t+="?lang="+e.lang),t):t}}]),e}()},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(t,n){o()(this,e),this.$http=t,e.interactionsUrl=n.apiUrls.interactions,e.interactionConversationsUrl=n.apiUrls.interactionConversations,e.interactionIntentsUrl=n.apiUrls.interactionIntents,e.interactionAnalyticsUrl=n.apiUrls.interactionAnalytics}return e.$inject=["$http","urls"],r()(e,[{key:"getInteractions",value:function(){return this.$http.get(e.interactionsUrl)}},{key:"getInteractionConversations",value:function(t,n,i){return this.$http.get(e.interactionConversationsUrl+"?page="+t+"&perPage="+n+"&lang="+i.toString())}},{key:"batchClassify",value:function(t,n){return this.$http.post(e.interactionsUrl+"/classify?lang="+n.toString(),t)}},{key:"batchUpdateInteractionStatus",value:function(t){return this.$http.put(e.interactionsUrl,t)}},{key:"removeInteraction",value:function(t){return this.$http.delete(e.interactionsUrl+"/"+t.id).then(angular.noop)}},{key:"getInteractionIntents",value:function(){return this.$http.get(e.interactionIntentsUrl)}},{key:"getInteractionAnalytics",value:function(t,n){return this.$http({method:"GET",url:e.interactionAnalyticsUrl,params:{timeInterval:t,platform:n}})}},{key:"getInteractionAnalyticsTable",value:function(t,n,i){return this.$http({method:"GET",url:e.interactionAnalyticsUrl+"/messages",params:{timeInterval:t,platform:n,cursor:i}})}},{key:"getInteractionAnalyticsFlow",value:function(t,n){return this.$http.get(e.interactionAnalyticsUrl+"/sankey?timeInterval="+t+"&platform="+n)}}]),e}()},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a),s=n(208),l=n(210);n.d(t,"a",function(){return u});var u=function(){function e(t){o()(this,e),this.$http=t}return e.$inject=["$http"],r()(e,[{key:"createVersion",value:function(e,t){return this.$http.post(this.constructVersionsUrl({agentId:t}),{comment:e}).then(this.processSingleVersionResponse)}},{key:"removeVersion",value:function(e,t){return this.$http.delete(this.constructVersionsUrl({agentId:e,versionNumber:t})).then(angular.noop)}},{key:"listVersions",value:function(e){return this.$http.get(this.constructVersionsUrl({agentId:e})).then(this.processListVersionResponse)}},{key:"getVersion",value:function(e,t){return this.$http.get(this.constructVersionsUrl({agentId:e,versionNumber:t})).then(this.processSingleVersionResponse)}},{key:"createRuntime",value:function(e,t,n){return this.$http.post(this.constructRuntimesUrl({agentId:e}),{comment:n,name:t}).then(this.processSingleRuntimeResponse)}},{key:"listRuntimes",value:function(e){return this.$http.get(this.constructRuntimesUrl({agentId:e})).then(this.processListRuntimeResponse)}},{key:"getRuntime",value:function(e,t){return this.$http.get(this.constructRuntimesUrl({agentId:e,runtimeName:t})).then(this.processSingleRuntimeResponse)}},{key:"updateRuntime",value:function(e){return this.$http.patch(this.constructRuntimesUrl({agentId:e.agentId,runtimeName:e.name,updateMask:"agent_version"}),e).then(this.processSingleRuntimeResponse)}},{key:"removeRuntime",value:function(e){return this.$http.delete(this.constructRuntimesUrl({agentId:e.agentId,runtimeName:e.name})).then(angular.noop)}},{key:"getRuntimeHistory",value:function(e){return this.$http.get(this.constructRuntimesUrl({agentId:e.agentId,runtimeName:e.name,history:!0})).then(this.processListRuntimeResponse)}},{key:"processListVersionResponse",value:function(e){return e&&e.data&&e.data.elements&&e.data.elements.map?e.data.elements.map(function(e){return new l.a(e)}):[]}},{key:"processSingleVersionResponse",value:function(e){return e&&e.data?new l.a(e.data):null}},{key:"processListRuntimeResponse",value:function(e){return e&&e.data&&e.data.elements&&e.data.elements.map?e.data.elements.map(function(e){return new s.a(e)}):[]}},{key:"processSingleRuntimeResponse",value:function(e){return e&&e.data?new s.a(e.data):null}},{key:"constructVersionsUrl",value:function(e){var t="/api/agents/"+e.agentId+"/versions";return e.versionNumber&&(t+="/"+e.versionNumber),e.pageSize&&e.pageToken&&(t+="?pageSize="+e.pageSize+"&pageToke="+e.pageToken),t}},{key:"constructRuntimesUrl",value:function(e){var t="/api/agents/"+e.agentId+"/runtimes";return e.runtimeName&&(t+="/"+e.runtimeName),e.history&&(t+="/history"),(e.pageToken||e.pageSize||e.updateMask)&&(t+="?1"),e.pageSize&&(t+="&pageSize="+e.pageSize),e.pageToken&&(t+="&pageToke="+e.pageToken),e.updateMask&&(t+="&updateMask="+e.updateMask),t}}]),e}()},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(t,n){o()(this,e),this.$http=t,this.urls=n}return e.$inject=["$http","urls"],r()(e,[{key:"getAvailablePlansServices",value:function(){return e.AVAILABLE_PLAN_SERVICES}},{key:"signup",value:function(e){return this.$http.post(this.urls.usersUrls.signup,e)}},{key:"getProfile",value:function(){return this.$http.get(this.urls.usersUrls.profile)}},{key:"updateProfile",value:function(e){return this.$http.put(this.urls.usersUrls.profile,e)}},{key:"changePassword",value:function(e){return this.$http.put(this.urls.usersUrls.changePassword,e)}},{key:"resetPassword",value:function(e,t){return this.$http.post(this.urls.usersUrls.forgotPassword,{email:e,captcha:t})}},{key:"getAccount",value:function(){return this.$http.get(this.urls.usersUrls.account)}},{key:"getSubscriptionPlans",value:function(){return this.$http.get(this.urls.usersUrls.subscriptionPlans)}},{key:"subscribe",value:function(e){return this.$http.post(this.urls.usersUrls.subscribe,e)}},{key:"changeCard",value:function(e){return this.$http.put(this.urls.usersUrls.customer,e)}},{key:"checkCoupon",value:function(e,t){return this.$http.get(this.urls.usersUrls.checkCoupon+e+"?planId="+t)}},{key:"changeSubscriptionPlan",value:function(e){return this.$http.put(this.urls.usersUrls.subscription,{plan:e})}},{key:"deleteAccount",value:function(){return this.$http.delete(this.urls.usersUrls.deleteAccount)}},{key:"enableGoogler",value:function(e){return this.$http.get(this.urls.usersUrls.enableGoogler+"?enable="+e)}}]),e}();s.AVAILABLE_PLAN_SERVICES={free:{queries:"Unlimited",privateAgents:"All agents are public",domains:"For testing from the Dialogflow console",support:"Community"},startup:{queries:"160,000",privateAgents:"Unlimited",domains:"Unlimited",speech:"Included",support:"Email, Chat"},standard:{queries:"750,000",privateAgents:"Unlimited",domains:"Unlimited",speech:"Included + custom models",support:"Email, Chat",sla:"99.99% guaranteed uptime SLA"},premium:{queries:"2,400,000",privateAgents:"Unlimited",domains:"Unlimited",speech:"Included + custom models",support:"Email, Chat",sla:"99.99% guaranteed uptime SLA",consulting:"Included"},preferred:{queries:"Unlimited",privateAgents:"Unlimited",domains:"Unlimited",speech:"Included + custom models",support:"Email, Chat, Phone, Donuts provided",sla:"99.99% guaranteed uptime SLA",consulting:"Included",onpremise:"Included",embedded:"Included"}}},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(t,n){o()(this,e),this.$http=t,this.urls=n}return e.$inject=["$http","urls"],r()(e,[{key:"updateEmails",value:function(e){return e=e.filter(function(e){return e}),this.$http.post(this.urls.usersUrls.whitelist,e)}}]),e}()},function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(1),r=n.n(a);n.d(t,"a",function(){return s});var s=function(){function e(t,n,i,a,r,s){o()(this,e),this.$interval=t,this.$timeout=n,this.AgentData=i,this.AnalyticsService=a,this.CurrentAgentService=r,this.CurrentUser=s,this.trainingStatus=!1,this.onInit()}return r()(e,[{key:"getTrainingStatus",value:function(){return this.trainingStatus}},{key:"setTrainingStatus",value:function(e){var t=this;this.$timeout(function(){return t.trainingStatus=!!e})}},{key:"checkTrainingStatus",value:function(){var t=this;this.CurrentAgentService.getId()&&this.$timeout(function(){t.AgentData.startCheckAgentTrainingStatus().then(function(e){_.has(e,"data")&&!0===e.data&&t.setTrainingStatus(!0)})},e.IN_TRAINING_TIMEOUT_BEFORE_START_POLLING)}},{key:"startIsAgentInTrainingPolling",value:function(e){throw new Error("Not implemented")}},{key:"stopIsAgentInTrainingPolling",value:function(){throw new Error("Not implemented")}},{key:"onInit",value:function(){}}]),e}();s.IN_TRAINING_TIMEOUT_BEFORE_START_POLLING=3e3},function(e,t,n){"use strict";var i=n(2),o=n.n(i),a=n(0),r=n.n(a),s=n(1),l=n.n(s),u=n(4),c=n.n(u),d=n(3),m=n.n(d),g=n(8),h=n(13),p=n(231);n.d(t,"a",function(){return f});var f=function(e){function t(){r()(this,t);var e=c()(this,(t.__proto__||o()(t)).apply(this,arguments));return e.trainingStatusInterval=null,e.trainingStatusPollsCount=0,e.trainingPollsThrottling=1,e}return m()(t,e),l()(t,[{key:"checkTrainingStatus",value:function(){return this.startIsAgentInTrainingPolling(!1)}},{key:"startIsAgentInTrainingPolling",value:function(e){var t=this;this.CurrentAgentService.getId()&&(e&&this._startIsAgentInTrainingPolling(),this.$timeout(function(){t.AgentData.startCheckAgentTrainingStatus().then(function(e){_.has(e,"data")&&!0===e.data&&t._startIsAgentInTrainingPolling()})},p.a.IN_TRAINING_TIMEOUT_BEFORE_START_POLLING))}},{key:"_startIsAgentInTrainingPolling",value:function(){var e=this;g.a.info("Agent training started"),this.trainingStatus=!0,this.trainingStatusInterval&&this.$interval.cancel(this.trainingStatusInterval),this.trainingStatusInterval=this.$interval(function(){e.AgentData.startCheckAgentTrainingStatus().then(function(t){if(_.has(t,"data")&&!1===t.data){e.trainingStatus=!1;var n=e.CurrentAgentService.getCurrentAgent();e.AnalyticsService.track("TRAINING_CONVERSATION_TRAINED",{agent_name:n.name,lang:n.language}),g.a.info("Agent training completed"),e.$interval.cancel(e.trainingStatusInterval),e.trainingStatusPollsCount=0,e.trainingPollsThrottling=1}else++e.trainingStatusPollsCount>5&&(e.trainingPollsThrottling++,e.trainingStatusPollsCount=0,e._startIsAgentInTrainingPolling())})},t.IN_TRAINING_POLL_DEFAULT_THROTTLE_VALUE*this.trainingPollsThrottling)}},{key:"stopIsAgentInTrainingPolling",value:function(){this.trainingStatus=!1,this.trainingStatusInterval&&this.$interval.cancel(this.trainingStatusInterval)}},{key:"onInit",value:function(){h.a.subscribe(h.a.DEFINED_EVENTS.AGENT_UPLOAD_SUCCESS,this.checkTrainingStatus.bind(this))}}]),t}(p.a);f.IN_TRAINING_POLL_DEFAULT_THROTTLE_VALUE=1e4},function(e,t,n){e.exports={default:n(241),__esModule:!0}},function(e,t,n){e.exports={default:n(242),__esModule:!0}},,function(e,t,n){e.exports={default:n(245),__esModule:!0}},,,,function(e,t,n){n(49),n(48),e.exports=n(270)},function(e,t,n){n(49),n(48),e.exports=n(271)},function(e,t,n){n(273),e.exports=n(10).Object.assign},,,function(e,t,n){n(276),e.exports=n(10).Object.freeze},,,function(e,t,n){n(279),e.exports=n(10).Object.keys},,function(e,t,n){n(88),n(48),n(49),n(281),e.exports=n(10).Promise},,,,,,function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var i=n(35),o=n(14)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[o]===e)}},function(e,t,n){var i=n(22);e.exports=function(e,t,n,o){try{return o?t(i(n)[0],n[1]):t(n)}catch(t){var a=e.return;throw void 0!==a&&i(a.call(e)),t}}},,function(e,t,n){var i=n(14)("iterator"),o=!1;try{var a=[7][i]();a.return=function(){o=!0},Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var a=[7],r=a[i]();r.next=function(){return{done:n=!0}},a[i]=function(){return r},e(a)}catch(e){}return n}},,function(e,t,n){var i=n(16),o=n(111).set,a=i.MutationObserver||i.WebKitMutationObserver,r=i.process,s=i.Promise,l="process"==n(42)(r);e.exports=function(){var e,t,n,u=function(){var i,o;for(l&&(i=r.domain)&&i.exit();e;){o=e.fn,e=e.next;try{o()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(l)n=function(){r.nextTick(u)};else if(a){var c=!0,d=document.createTextNode("");new a(u).observe(d,{characterData:!0}),n=function(){d.data=c=!c}}else if(s&&s.resolve){var m=s.resolve();n=function(){m.then(u)}}else n=function(){o.call(i,u)};return function(i){var o={fn:i,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t,n){"use strict";var i=n(36),o=n(69),a=n(51),r=n(47),s=n(85),l=Object.assign;e.exports=!l||n(33)(function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(e){t[e]=e}),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=i})?function(e,t){for(var n=r(e),l=arguments.length,u=1,c=o.f,d=a.f;l>u;)for(var m,g=s(arguments[u++]),h=c?i(g).concat(c(g)):i(g),p=h.length,f=0;p>f;)d.call(g,m=h[f++])&&(n[m]=g[m]);return n}:l},,,,function(e,t,n){var i=n(22),o=n(65),a=n(14)("species");e.exports=function(e,t){var n,r=i(e).constructor;return void 0===r||void 0==(n=i(r)[a])?t:o(n)}},,,function(e,t,n){var i=n(22),o=n(112);e.exports=n(10).getIterator=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return i(t.call(e))}},function(e,t,n){var i=n(58),o=n(14)("iterator"),a=n(35);e.exports=n(10).isIterable=function(e){var t=Object(e);return void 0!==t[o]||"@@iterator"in t||a.hasOwnProperty(i(t))}},,function(e,t,n){var i=n(24);i(i.S+i.F,"Object",{assign:n(263)})},,,function(e,t,n){var i=n(29),o=n(82).onFreeze;n(52)("freeze",function(e){return function(t){return e&&i(t)?e(o(t)):t}})},,,function(e,t,n){var i=n(47),o=n(36);n(52)("keys",function(){return function(e){return o(i(e))}})},,function(e,t,n){"use strict";var i,o,a,r=n(50),s=n(16),l=n(40),u=n(58),c=n(24),d=n(29),m=n(65),g=n(158),h=n(156),p=n(267),f=n(111).set,v=n(262)(),b="Promise",y=s.TypeError,k=s.process,A=s[b],k=s.process,S="process"==u(k),w=function(){},E=!!function(){try{var e=A.resolve(1),t=(e.constructor={})[n(14)("species")]=function(e){e(w,w)};return(S||"function"==typeof PromiseRejectionEvent)&&e.then(w)instanceof t}catch(e){}}(),C=function(e,t){return e===t||e===A&&t===a},_=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},T=function(e){return C(A,e)?new L(e):new o(e)},L=o=function(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw y("Bad Promise constructor");t=e,n=i}),this.resolve=m(t),this.reject=m(n)},I=function(e){try{e()}catch(e){return{error:e}}},x=function(e,t){if(!e._n){e._n=!0;var n=e._c;v(function(){for(var i=e._v,o=1==e._s,a=0,r=function(t){var n,a,r=o?t.ok:t.fail,s=t.resolve,l=t.reject,u=t.domain;try{r?(o||(2==e._h&&P(e),e._h=1),!0===r?n=i:(u&&u.enter(),n=r(i),u&&u.exit()),n===t.promise?l(y("Promise-chain cycle")):(a=_(n))?a.call(n,s,l):s(n)):l(i)}catch(e){l(e)}};n.length>a;)r(n[a++]);e._c=[],e._n=!1,t&&!e._h&&R(e)})}},R=function(e){f.call(s,function(){var t,n,i,o=e._v;if(U(e)&&(t=I(function(){S?k.emit("unhandledRejection",o,e):(n=s.onunhandledrejection)?n({promise:e,reason:o}):(i=s.console)&&i.error&&i.error("Unhandled promise rejection",o)}),e._h=S||U(e)?2:1),e._a=void 0,t)throw t.error})},U=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,i=0;n.length>i;)if(t=n[i++],t.fail||!U(t.promise))return!1;return!0},P=function(e){f.call(s,function(){var t;S?k.emit("rejectionHandled",e):(t=s.onrejectionhandled)&&t({promise:e,reason:e._v})})},O=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),x(t,!0))},$=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw y("Promise can't be resolved itself");(t=_(e))?v(function(){var i={_w:n,_d:!1};try{t.call(e,l($,i,1),l(O,i,1))}catch(e){O.call(i,e)}}):(n._v=e,n._s=1,x(n,!1))}catch(e){O.call({_w:n,_d:!1},e)}}};E||(A=function(e){g(this,A,b,"_h"),m(e),i.call(this);try{e(l($,this,1),l(O,this,1))}catch(e){O.call(this,e)}},i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n(159)(A.prototype,{then:function(e,t){var n=T(p(this,A));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=S?k.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&x(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),L=function(){var e=new i;this.promise=e,this.resolve=l($,e,1),this.reject=l(O,e,1)}),c(c.G+c.W+c.F*!E,{Promise:A}),n(46)(A,b),n(163)(b),a=n(10)[b],c(c.S+c.F*!E,b,{reject:function(e){var t=T(this);return(0,t.reject)(e),t.promise}}),c(c.S+c.F*(r||!E),b,{resolve:function(e){if(e instanceof A&&C(e.constructor,this))return e;var t=T(this);return(0,t.resolve)(e),t.promise}}),c(c.S+c.F*!(E&&n(260)(function(e){A.all(e).catch(w)})),b,{all:function(e){var t=this,n=T(t),i=n.resolve,o=n.reject,a=I(function(){var n=[],a=0,r=1;h(e,!1,function(e){var s=a++,l=!1;n.push(void 0),r++,t.resolve(e).then(function(e){l||(l=!0,n[s]=e,--r||i(n))},o)}),--r||i(n)});return a&&o(a.error),n.promise},race:function(e){var t=this,n=T(t),i=n.reject,o=I(function(){h(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return o&&i(o.error),n.promise}})},,,,function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\nagent-avatar {\n  display: block;\n  width: 200px;\n  height: 200px;\n  float: left;\n  background-color: #f4f5f5;\n  position: relative;\n  text-align: center;\n  vertical-align: middle;\n}\nagent-avatar img {\n  max-height: 100%;\n  max-width: 100%;\n  width: auto;\n  height: auto;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n}\nagent-avatar .b_agent_avatar_default_icon {\n  position: absolute;\n  height: 80px;\n  width: 80px;\n  left: 60px;\n  top: 30px;\n}\nagent-avatar .b_agent_avatar_default_icon span {\n  vertical-align: middle;\n  line-height: 80px;\n  color: white;\n  font-size: 30px;\n}\nagent-avatar .b_agent_avatar {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\nagent-avatar .b_agent_avatar:hover .b_agent_avatar-add_button,\nagent-avatar .b_agent_avatar:hover .b_agent_avatar-update_button {\n  display: block;\n}\nagent-avatar md-progress-circular {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  margin-left: -37px;\n  margin-top: -37px;\n}\nagent-avatar .b_agent_avatar-update_button {\n  cursor: pointer;\n  color: #66afe9;\n  text-decoration: underline;\n  text-transform: uppercase;\n  text-align: center;\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 20px;\n  display: none;\n}\nagent-avatar .b_agent_avatar-update_button span {\n  background-color: #f4f5f5;\n  padding: 5px;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\nagent-langs {\n  display: block;\n  margin-top: -25px;\n}\nagent-langs md-list-item.primary-lang {\n  font-weight: 400;\n}\nagent-langs md-list-item.locale-lang {\n  padding-left: 30px;\n}\nagent-langs md-list-item .md-list-item-inner .md-secondary-container,\nagent-langs md-list-item .md-secondary-container {\n  display: none;\n}\nagent-langs md-list-item:hover .md-secondary-container {\n  display: block;\n}\nagent-langs md-list-item .remove-lang {\n  font-weight: normal;\n  color: #b7bbc4;\n}\nagent-langs md-list-item.default .md-list-item-inner .md-secondary-container,\nagent-langs md-list-item.default .md-secondary-container {\n  display: block;\n}\nagent-langs md-list-item.default md-menu {\n  display: none;\n}\nagent-langs md-list-item.default:hover md-menu {\n  display: inline-block;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\nagent-runtimes md-list-item.list-item-low {\n  height: auto;\n  min-height: 0;\n}\nagent-runtimes md-list-item.list-item-low::before {\n  min-height: 0;\n}\nagent-runtimes md-list-item.list-item-high {\n  height: auto;\n  min-height: 64px;\n}\nagent-runtimes md-list-item.list-item-high::before {\n  min-height: 64px;\n}\nagent-runtimes md-list-item.list-item-high .md-list-item-inner::before {\n  min-height: 64px;\n}\nagent-runtimes .b_card__icon.b_integration_icon {\n  margin-right: 5px;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"agent-share md-list-item.md-no-proxy {\n  padding: 0;\n}\nagent-share md-select.b_agent-share-role-selector {\n  margin: 0;\n}\nagent-share .b_agent-share-email-selector {\n  margin: 0;\n  padding-right: 20px;\n}\nagent-share md-list-item .md-secondary-container .b_agent-share-remove-button {\n  margin: 0;\n  padding-right: 0;\n  width: 32px;\n}\nagent-share md-list-item .md-secondary-container .b_agent-share-remove-button md-icon {\n  margin: 0;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\ncontrol-panel-lang-switcher {\n  padding: 3px 30px 0 35px;\n  margin-right: -1px;\n  display: block;\n}\ncontrol-panel-lang-switcher .icon-right {\n  color: #b7bbc4;\n  font-size: 20px;\n}\ncontrol-panel-lang-switcher .current-lang,\ncontrol-panel-lang-switcher .switch-lang {\n  border-radius: 10px;\n  color: white;\n  padding: 2px 10px;\n  background-color: #66afe9;\n  margin-right: 5px;\n}\ncontrol-panel-lang-switcher .switch-lang {\n  background-color: #b7bbc4;\n  transition: color 0.2s;\n}\ncontrol-panel-lang-switcher .switch-lang.show-more i {\n  color: white;\n  top: 5px;\n}\ncontrol-panel-lang-switcher .switch-lang:hover {\n  background-color: #66afe9;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\n/**\n  Shared styles to be loaded by webpack\n  @todo: find better place\n */\n.no-left-margin {\n  margin-left: 0 !important;\n}\n.b-material-custom-popup-close {\n  position: absolute;\n  color: white;\n  top: -30px;\n  right: 0;\n  text-transform: uppercase;\n  font-weight: 400;\n}\nmd-checkbox.list-batch {\n  margin-left: -16px !important;\n  margin-right: -2px !important;\n}\nmd-checkbox.list-batch-all {\n  margin-left: 9px !important;\n}\n.list-batch-actions {\n  margin-top: 3px;\n}\n.list-batch-actions button {\n  font-size: 12px;\n}\n.entity-list__entity-prefix {\n  margin-left: -10px;\n  width: 22px;\n  display: inline-block;\n  text-align: right;\n}\na .fa.fa-external-link {\n  font-size: 80%;\n  color: gray;\n}\n.disclaimer {\n  font-size: 12px;\n  font-style: italic;\n  color: lightslategray;\n}\n.highlight-error {\n  color: #f76949;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\n.cloud-functions-container .editor-container {\n  background-color: #f6f6f6;\n  margin-bottom: 12px;\n}\n.cloud-functions-container .editor-container .tab-control {\n  border: 1px solid #ccc;\n  border-bottom: none;\n  margin-top: 16px;\n  padding-bottom: 12px;\n  margin-bottom: 0;\n}\n.cloud-functions-container .editor-container .tab-control ul {\n  padding-left: 16px;\n}\n.cloud-functions-container .editor-container .tab-control li {\n  padding-top: 16px;\n  padding-bottom: 12px;\n}\n.cloud-functions-container .editor-container .tab-control .download-button {\n  float: right;\n  margin-top: 8px;\n  padding-top: 0px;\n  padding-bottom: 0px;\n}\n.cloud-functions-container .editor-container .tab-control .download-icon {\n  color: black;\n  font-size: 18px;\n}\n.cloud-functions-container .editor-container .tab-control .download-icon-disabled {\n  color: silver;\n  font-size: 18px;\n}\n.cloud-functions-container .editor-button {\n  min-width: 110px;\n}\n.cloud-functions-container .editor-container-disabled {\n  opacity: 0.3;\n}\n.cloud-functions-container .failure-callout {\n  margin-top: 12px;\n  color: #f76949;\n}\n.cloud-functions-container .failure-callout .deployment-failure-message {\n  white-space: pre-line;\n}\n.cloud-functions-container .loading-indicator {\n  margin-top: 12px;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\n.fulfillment-header h3 {\n  margin-top: 14px;\n}\n.fulfillment-header h3 .fulfillment-subheader {\n  margin-left: 14px;\n  font-size: 16px;\n  vertical-align: middle;\n}\n.fulfillment-header label {\n  margin-top: 14px;\n  margin-bottom: 14px;\n  margin-right: 20px;\n  line-height: 28px;\n}\n.fulfillment-header .enabled {\n  color: #0488da;\n}\n.fulfillment-editor {\n  padding-bottom: 30px;\n}\n.fulfillment-editor .layout-row {\n  padding: 0;\n}\n.fulfillment-editor .layout-row [flex] {\n  padding-right: 0;\n  padding-left: 16px;\n}\n.fulfillment-editor .layout-row .title {\n  padding-left: 0;\n}\n.fulfillment-editor label {\n  color: #9399a9;\n  text-transform: uppercase;\n}\n.fulfillment-editor md-input-container .md-input.ng-valid:not(:focus) {\n  border-color: rgba(0, 0, 0, 0.12);\n}\n.fulfillment-editor .fulfillment__remove-button {\n  font-size: 20px;\n  opacity: 0.3;\n  margin: 3px 0;\n}\n.fulfillment-editor .fulfillment__remove-button .icon {\n  vertical-align: middle;\n  display: inline-block;\n}\n.fulfillment-editor .fulfillment__add-button .icon {\n  font-size: 20px;\n  vertical-align: middle;\n  display: inline-block;\n  margin-right: 5px;\n}\n.fulfillment-guidelines {\n  padding: 20px 0;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\nintent-contexts .md-chips md-chip .md-chip-content {\n  overflow: visible;\n}\nintent-contexts .lifespan-container {\n  float: left;\n  margin-left: -12px;\n  margin-right: 8px;\n  margin-top: -1px;\n}\nintent-contexts .lifespan-container input,\nintent-contexts .lifespan-container textarea {\n  text-align: center;\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  background: #c4c4c4;\n  border: 0;\n  resize: none;\n  white-space: nowrap;\n  overflow: none;\n  line-height: 32px;\n  padding: 0;\n}\nintent-contexts .lifespan-container input::-webkit-outer-spin-button {\n  /* display: none; <- Crashes Chrome on hover */\n  -webkit-appearance: none;\n  margin: 0;\n}\nintent-contexts .reset-contexts {\n  font-size: 20px;\n  color: #E0E0E0;\n  margin-top: 9px;\n}\nintent-contexts .reset-contexts:hover,\nintent-contexts .reset-contexts.active {\n  color: #66afe9;\n}\nintent-contexts .context-info {\n  display: inline-block;\n  margin-top: 8px;\n}\n.intent-show-hide {\n  color: #b7bbc4;\n  font-size: 1.5em;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,".chat-bubble {\n  width: 100%;\n}\n.chat-bubble .bubble-row:not(:first-child) {\n  border-top: #ebebeb 1px solid;\n}\n.chat-bubble .bubble-row:hover .visible-on-hover {\n  display: inline-block;\n}\n.chat-bubble .bubble-row .bubble-cell {\n  padding: 6px 0px 6px 0px;\n}\n.chat-bubble .bubble-row .numeric-cell {\n  width: 40px;\n  min-width: 40px;\n  text-align: center;\n  resize: none;\n  background-color: #F8F8F8;\n}\n.chat-bubble .bubble-row .input-cell {\n  width: 100%;\n  padding-left: 15px;\n}\n.chat-bubble .bubble-row .input-cell.secondary {\n  border-left: #ebebeb 1px solid;\n}\n.chat-bubble .bubble-row .input-cell textarea {\n  width: 100%;\n  height: 22px;\n  resize: none;\n  overflow: hidden !important;\n}\n.chat-bubble .bubble-row .input-cell textarea.has-error {\n  /* Firefox 19+ */\n  /* Firefox 18- */\n}\n.chat-bubble .bubble-row .input-cell textarea.has-error::-webkit-input-placeholder {\n  color: #f26c29;\n}\n.chat-bubble .bubble-row .input-cell textarea.has-error::-moz-placeholder {\n  color: #f26c29;\n}\n.chat-bubble .bubble-row .input-cell textarea.has-error:-moz-placeholder {\n  color: #f26c29;\n}\n.chat-bubble .bubble-row .input-cell textarea.has-error:-ms-input-placeholder {\n  color: #f26c29;\n}\n.chat-bubble .bubble-row .input-cell textarea.empty_speech {\n  margin-left: 1px;\n  margin-top: -4px;\n}\n.chat-bubble .bubble-row .ace_editor {\n  min-height: 22px;\n  line-height: 1.3;\n}\n.chat-bubble .bubble-row .ace_editor .ace_text-input {\n  position: fixed;\n}\n.chat-bubble .bubble-row .ace_editor .ace_hidden-cursors .ace_cursor {\n  opacity: 0;\n}\n.chat-bubble .bubble-row .visible-on-hover {\n  display: none;\n}\n.chat-bubble .bubble-row .action-cell {\n  width: 40px;\n  min-width: 40px;\n}\n.chat-bubble .bubble-row .action-cell a {\n  color: #b7bbc4;\n  padding-left: 10px;\n}\n.chat-bubble .bubble-row .action-cell a:hover {\n  display: block;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\n.rich_response .alert {\n  margin: 15px 0px 8px;\n  padding: 12px 23px 13px;\n}\n.rich_response .alert .alert-icon {\n  color: green;\n}\n.rich_response .alert .info {\n  margin-bottom: 10px;\n}\n.rich_response .alert .info p {\n  color: green;\n}\n.rich_response .alert md-switch {\n  margin: 0px 0px;\n}\n.rich_response md-card .md-actions,\n.rich_response md-card md-card-actions {\n  margin: 0px 0px 0px 8px;\n}\n.rich_response md-card .md-actions:not(.layout-column) .md-button.md-icon-button:first-of-type,\n.rich_response md-card md-card-actions:not(.layout-column) .md-button.md-icon-button:first-of-type,\n.rich_response md-card .md-actions:not(.layout-column) .md-button.md-icon-button:last-of-type,\n.rich_response md-card md-card-actions:not(.layout-column) .md-button.md-icon-button:last-of-type {\n  margin-left: 0px;\n  margin-right: 0px;\n}\n.rich_response md-card .md-actions:not(.layout-column) .md-button:not(.md-icon-button):first-of-type,\n.rich_response md-card md-card-actions:not(.layout-column) .md-button:not(.md-icon-button):first-of-type,\n.rich_response md-card .md-actions:not(.layout-column) .md-button:not(.md-icon-button):last-of-type,\n.rich_response md-card md-card-actions:not(.layout-column) .md-button:not(.md-icon-button):last-of-type {\n  margin-left: 7px;\n  margin-right: 7px;\n}\n.rich_response md-card .md-actions .md-button,\n.rich_response md-card md-card-actions .md-button {\n  text-transform: none;\n}\n.rich_response md-card .md-actions .md-button.active,\n.rich_response md-card md-card-actions .md-button.active {\n  background-color: rgba(158, 158, 158, 0.2);\n}\n.rich_response .solid-input .md-chips {\n  box-shadow: 0 0px !important;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,".jsoneditor__preloader {\n  padding: 60px 0;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"retrieve-access {\n  position: relative;\n  display: block;\n}\nretrieve-access h1,\nretrieve-access h2,\nretrieve-access h3,\nretrieve-access h4,\nretrieve-access h5 {\n  text-align: center;\n}\nretrieve-access .md-button.md-btn-login {\n  margin-left: 0;\n  margin-right: 0;\n  margin-bottom: 10px;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,".b_static_info p {\n  margin-bottom: 0;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"custom-toolbar-notice,\ncustom-toolbar-notice-manual {\n  position: fixed;\n  z-index: 100;\n  width: 100%;\n}\ncustom-toolbar-notice .md-toolbar-tools p,\ncustom-toolbar-notice-manual .md-toolbar-tools p {\n  font-weight: 500;\n  font-size: 14px;\n  margin: 0;\n}\ncustom-toolbar-notice .md-toolbar-tools p a,\ncustom-toolbar-notice-manual .md-toolbar-tools p a {\n  text-decoration: underline;\n}\ncustom-toolbar-notice .md-toolbar-tools .md-icon-button,\ncustom-toolbar-notice-manual .md-toolbar-tools .md-icon-button {\n  font-size: 22px;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\ntoolbar-notice,\ntoolbar-notice-manual {\n  position: fixed;\n  z-index: 100;\n  width: 100%;\n}\ntoolbar-notice p,\ntoolbar-notice-manual p {\n  margin: 0;\n  padding: 0;\n  font-size: 12px;\n  font-weight: 300;\n}\ntoolbar-notice md-toolbar,\ntoolbar-notice-manual md-toolbar {\n  background: white !important;\n  border-bottom: 1px #e7e7e7 solid;\n  height: 65px;\n}\ntoolbar-notice md-toolbar .md-toolbar-tools a,\ntoolbar-notice-manual md-toolbar .md-toolbar-tools a {\n  color: #0488da;\n}\ntoolbar-notice md-toolbar .md-toolbar-tools a:active,\ntoolbar-notice-manual md-toolbar .md-toolbar-tools a:active,\ntoolbar-notice md-toolbar .md-toolbar-tools a:hover,\ntoolbar-notice-manual md-toolbar .md-toolbar-tools a:hover {\n  color: #03598f;\n}\ntoolbar-notice support-notice-bar .md-toolbar-tools,\ntoolbar-notice-manual support-notice-bar .md-toolbar-tools {\n  background-color: #fbfbc8;\n}\ntoolbar-notice support-notice-bar .md-toolbar-tools p,\ntoolbar-notice-manual support-notice-bar .md-toolbar-tools p {\n  font-weight: 500;\n  font-size: 14px;\n}\ntoolbar-notice support-notice-bar .md-toolbar-tools p a,\ntoolbar-notice-manual support-notice-bar .md-toolbar-tools p a {\n  text-decoration: underline;\n}\ntoolbar-notice support-notice-bar .md-toolbar-tools .md-icon-button,\ntoolbar-notice-manual support-notice-bar .md-toolbar-tools .md-icon-button {\n  font-size: 22px;\n}\nheader.is-top-notice {\n  padding-top: 65px;\n}\n.is-top-notice .workplace {\n  margin-top: 65px;\n}\n.is-top-notice .left-panel,\n.is-top-notice .right-panel,\n.is-top-notice .dashboard,\n.is-top-notice .top-panel {\n  top: 65px;\n}\n.is-top-notice .top-panel.agents-top-panel,\n.is-top-notice #agent-form .top-panel.agents-top-panel {\n  top: 145px;\n}\n.is-top-notice .control-panel .bottom {\n  bottom: 65px;\n}\n@media screen and (max-width: 1020px) {\n  toolbar-notice {\n    position: initial;\n  }\n  .is-top-notice .workplace {\n    margin-top: 0;\n  }\n  .wrapper-columns.is-top-notice .top-panel {\n    position: absolute;\n    top: 0;\n  }\n  .is-top-notice #agent-form .top-panel.agents-top-panel {\n    top: 80px;\n  }\n  .is-top-notice training .top-panel.agents-top-panel {\n    top: 145px;\n  }\n}\n",""])},,function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"/* Mixin */\n.td-test-console-fulfillment-parameter-value-failed {\n  color: #f76949;\n}\n.td-test-console-fulfillment-parameter-value {\n  word-break: break-all;\n  text-align: right;\n}\n.test-console-fulfillment-parameters-key {\n  display: inline-block;\n  width: 150px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(6)(),t.push([e.i,".whitelist-form {\n  margin: 20px;\n}\n.whitelist-form .input-group {\n  background: #fff;\n  border: 1px solid #dfe0e2;\n  width: 100%;\n  margin-top: -1px;\n}\n.whitelist-form .input-group .form-control {\n  border: none;\n  -webkit-box-shadow: none;\n  -moz-box-shadow: none;\n  box-shadow: none;\n  height: 49px;\n  padding: 6px 22px;\n}\n.whitelist-form .top-button {\n  bottom: 10px;\n  position: relative;\n}\n.whitelist-form .bottom-button {\n  top: 10px;\n  position: relative;\n}\n.whitelist-form .mic-ico {\n  font-size: 20px;\n  width: 60px;\n}\n",""])},,,function(e,t){e.exports='<div class="b_agent_avatar" nv-file-drop uploader="vm.uploader">\n\n    <div ng-show="vm.uploader.isUploading">\n        <md-progress-circular  md-mode=\'indeterminate\' md-diameter="40"></md-progress-circular>\n    </div>\n\n    <div ng-hide="vm.uploader.isUploading">\n        <img ng-if="vm.agent.avatarId"\n             ng-srcset="{{vm.agent.avatarId}} 2x, {{vm.getAvatarIdForSize(\'l\')}} 1x"/>\n\n        <div ng-if="!vm.agent.avatarId" class="b_agent_avatar_default_icon">\n            \x3c!--span class="flaticon stroke lightning-bolt"></span--\x3e\n        </div>\n\n        <label class="b_agent_avatar-update_button" ng-hide="vm.disabled || vm.uploader.queue.length > 0">\n            <span>Update Avatar</span>\n            <input type="file" nv-file-select uploader="vm.uploader" style="display: none" ng-disabled="vm.uploader.queue > 0">\n        </label>\n\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="api-box agent-form-header" ng-if="!vm.isLoading()">\n  <h5>Google Project</h5>\n\n  <ul ng-if="vm.isEdit && vm.agent.cloudProjectId" class="api-tools list-group">\n    <li>\n      <div class="title">Project ID</div>\n      <div class="param">\n        <span ng-if="!vm.isAssistantCompatible" ng-bind-html="vm.getLinkToGCP(vm.agent.cloudProjectId)"></span>\n        <span ng-if="vm.isAssistantCompatible">\n          <strong ng-bind="vm.agent.cloudProjectId"></strong>\n          (<a target="_blank" ng-href="{{vm.getHrefToGCP(vm.agent.cloudProjectId)}}">Google Cloud <i class="fa fa-external-link" aria-hidden="true"></i></a> | <a target="_blank" ng-href="{{vm.getOverviewHrefToAOGConsole(vm.agent.cloudProjectId)}}">Actions on Google <i class="fa fa-external-link" aria-hidden="true"></i>\n          </a>)\n        </span>\n      </div>\n    </li>\n    <li ng-if="vm.agent.enableCceIntegration">\n      <div class="title">Service Account</div>\n      <div class="param">\n        <span ng-if="vm.agent.cloudServiceAccountName" ng-bind-html="vm.getLinkToGcpServiceAccount(vm.agent.cloudProjectId, vm.agent.cloudServiceAccountName)"></span>\n        <span ng-if="!vm.agent.cloudServiceAccountName">&nbsp;</span>\n      </div>\n      <div class="tools-link" ng-if="!vm.agent.cloudServiceAccountName">\n        <a ng-click="vm.refreshServiceAccountKey()" class="link" title="Create service account and key"><span class="flaticon stroke plus-2"></span></a>\n      </div>\n    </li>\n    <li ng-if="vm.agent.cloudServiceAccountName && vm.agent.enableCceIntegration">\n      <div class="title">Service Account Key</div>\n      <div class="param">{{vm.getServiceAccountKeyIdFromName(vm.agent.cloudServiceAccountKeyName)}}\n        <div class="tools-link">\n          <a ng-click="vm.refreshServiceAccountKey()" class="link" title="Refresh key"><span class="flaticon stroke repeat-4"></span></a>\n        </div>\n      </div>\n    </li>\n  </ul>\n\n  <p ng-if="vm.isEdit && !vm.agent.cloudProjectId"><br/>\n    <a ng-click="vm.linkAgent()" >Create or link existing Google project id</a>\n  </p>\n\n  <md-checkbox class="md-primary" ng-model="vm.agent.enableCceIntegration"\n    ng-if="vm.isEdit && vm.agent.cloudProjectId && vm.hasCapability(\'isAssistantTestingAvailable\')"\n    ng-change="vm.setEnableCceIntegration()">\n    <span>Enable CCE</span>\n  </md-checkbox>\n\n  <agent-deep-link-selector agent="vm.agent" is-project-id-given="vm.isProjectIdGiven" ng-if="!vm.isEdit"></agent-deep-link-selector>\n\n</div>\n\n<div class="api-box agent-form-header" ng-if="vm.isLoading()">\n  <h5>Google Project</h5>\n  <br/>\n  <md-progress-linear md-mode="indeterminate"></md-progress-linear>\n</div>\n'},function(e,t){e.exports='<md-dialog-content>\n  <div class="md-dialog-content" ng-if="!vm.viewState.isLoading && vm.viewState.isLinked">\n    Agent was successfully linked to Google Project <span ng-bind-html="vm.getLinkToGCP(vm.agent.cloudProjectId)"></span>\n  </div>\n  <div class="md-dialog-content" ng-if="!vm.viewState.isLoading && !vm.viewState.isLinked">\n    <h1>Link to Google Project</h1>\n    <p>To use sharing and the Google Assistant integration, please link to Google Project or create a new one</p>\n    <agent-deep-link-selector agent="vm.fakeAgent" is-project-id-given="false"></agent-deep-link-selector>\n  </div>\n  <div class="md-dialog-content" ng-if="vm.viewState.isLoading" layout="row" layout-align="center center">\n    <md-progress-circular md-mode=\'indeterminate\' md-diameter="40"></md-progress-circular>\n  </div>\n</md-dialog-content>\n<md-dialog-actions ng-if="!vm.viewState.isLoading">\n  <md-button ng-if="!vm.viewState.isLinked" ng-click="vm.cancelDialog()">Cancel</md-button>\n  <div flex></div>\n  <md-button ng-if="!vm.viewState.isLinked" ng-click="vm.linkToGCP()" ng-bind="(vm.fakeAgent.cloudProjectId) ? \'Link\' : \'Create\'"></md-button>\n  <md-button ng-if="vm.viewState.isLinked" ng-click="vm.closeDialog()">Ok</md-button>\n</md-dialog-actions>\n'},function(e,t){e.exports='<div layout="row" layout-align="center center" ng-if="vm.viewState.isLoading">\n    <div layout="row" layout-align="center center">\n        <md-progress-circular  md-mode=\'indeterminate\' md-diameter="40"></md-progress-circular>\n    </div>\n</div>\n\n<md-select ng-model="vm.agent.cloudProjectId" placeholder="Create a new Google project" ng-if="!vm.viewState.isLoading && vm.projectLinks && !vm.isProjectIdGiven">\n    <md-option ng-value="\'\'">Create a new Google project</md-option>\n    <md-optgroup label="Or import an existing project">\n        <md-option ng-repeat="(key, value) in vm.projectLinks" ng-value="key" >\n            {{key}}\n        </md-option>\n    </md-optgroup>\n</md-select>\n\n<div ng-if="!vm.viewState.isLoading && vm.projectLinks && vm.isProjectIdGiven && vm.agent.cloudProjectId">\n    <p>\n    <br/>\n    Agent will be linked with\n    <span ng-bind-html="vm.getOverviewLinkToAOGConsole(vm.agent.cloudProjectId)"></span>\n    Google Project\n    </p>\n</div>\n\n<p ng-if="!vm.viewState.isLoading && !vm.projectLinks">\n    <br/>\n    New GCP project will be automatically linked to the agent after saving\n</p>\n'},function(e,t){e.exports='<md-list>\n\n  <md-list-item class="primary-lang default">\n    <span ng-bind="vm.getLangName(vm.agent.language) + \'&nbsp;&mdash;&nbsp;\' + vm.formatLocale(vm.agent.language)"></span>\n    <md-menu class="md-secondary" ng-if="vm.availableLocalesMaps[vm.agent.language]">\n      <a  ng-click="$mdMenu.open($event)">+ Add locale&nbsp;&nbsp;&nbsp;</a>\n      <md-menu-content>\n        <md-menu-item  ng-repeat="(localeCode, localeValue) in vm.availableLocalesMaps[vm.agent.language]">\n          <md-button ng-click="vm.addLocale(localeCode)" aria-label="{{localeValue}}">{{localeValue}}</md-button>\n        </md-menu-item>\n      </md-menu-content>\n    </md-menu>\n    <span class="md-secondary">DEFAULT</span>\n  </md-list-item>\n\n  <md-list-item class="locale-lang" ng-repeat="(localeCode, locale) in vm.activeLocalesMaps[vm.agent.language]">\n    <span ng-bind="locale + \'&nbsp;&mdash;&nbsp;\' + vm.formatLocale(localeCode)"></span>\n    <md-icon class="md-secondary" ng-click="vm.removeLocale(localeCode)" aria-label="remove locale from agent" ng-disabled="vm.isAgentReadOnly"><i class="remove-lang flaticon stroke trash"></i></md-icon>\n  </md-list-item>\n\n  <md-divider></md-divider>\n\n  <div ng-repeat="langCode in vm.getAgentSupportedLanguages()">\n    <md-list-item class="primary-lang">\n      <span ng-bind="vm.getLangName(langCode) + \'&nbsp;&mdash;&nbsp;\' + vm.formatLocale(langCode)"></span>\n      <md-menu class="md-secondary" ng-if="vm.availableLocalesMaps[langCode]">\n        <a ng-click="$mdMenu.open($event)">+ Add locale</a>\n        <md-menu-content>\n          <md-menu-item  ng-repeat="(localeCode, localeValue) in vm.availableLocalesMaps[langCode]">\n            <md-button ng-click="vm.addLocale(localeCode)" aria-label="{{localeValue}}">{{localeValue}}</md-button>\n          </md-menu-item>\n        </md-menu-content>\n      </md-menu>\n      <md-icon class="md-secondary" ng-click="vm.removeLang(langCode)" aria-label="remove language from agent" ng-disabled="vm.isAgentReadOnly"><i class="remove-lang flaticon stroke trash"></i></md-icon>\n\n    </md-list-item>\n    <md-list-item class="locale-lang" ng-repeat="(localeCode, locale) in vm.activeLocalesMaps[langCode]">\n      <span ng-bind="locale + \'&nbsp;&mdash;&nbsp;\' + vm.formatLocale(localeCode)"></span>\n      <md-icon class="md-secondary" ng-click="vm.removeLocale(localeCode)" aria-label="remove locale from agent" ng-disabled="vm.isAgentReadOnly"><i class="remove-lang flaticon stroke trash"></i></md-icon>\n    </md-list-item>\n    <md-divider></md-divider>\n  </div>\n\n\n  <md-list-item ng-if="(vm.agent.getSupportedLanguages().length - vm.activeLocalesCount) < vm.langsCount">\n    <md-select ng-model="vm.selectedLang" placeholder="Select Additional Language" ng-change="vm.onAddLangChange()">\n      <md-option ng-repeat="langCode in vm.sortedKeys" ng-value="::langCode" ng-bind="vm.langItems[langCode] + \' &mdash; \' + langCode" ng-if="vm.agent.getSupportedLanguages().indexOf(langCode) < 0"></md-option>\n    </md-select>\n  </md-list-item>\n</md-list>\n'},function(e,t){e.exports='<md-dialog-content>\n  <div class="md-dialog-content" >\n    <h1>Create new version</h1>\n    <md-input-container class="md-block">\n      <label>Comment (optional)</label>\n      <input ng-model="vm.newVersion.comment"/>\n    </md-input-container>\n  </div>\n</md-dialog-content>\n<md-dialog-actions ng-if="!vm.isLoading()">\n  <md-button ng-click="vm.cancelDialog()">Cancel</md-button>\n  <div flex></div>\n  <md-button ng-click="vm.publishVersion()">Create</md-button>\n</md-dialog-actions>\n'},function(e,t){e.exports='<md-toolbar class="md-accent">\n  <div class="md-toolbar-tools">\n    <h1>Runtime history</h1>\n  </div>\n</md-toolbar>\n<md-divider></md-divider>\n<md-dialog-content>\n  <div class="md-dialog-content" ng-if="vm.isLoading()">\n    <div layout="row" layout-align="center center">\n      <md-progress-circular  md-mode=\'indeterminate\' md-diameter="40"></md-progress-circular>\n    </div>\n  </div>\n  <div class="md-dialog-content" ng-if="!vm.isLoading()">\n    <p ng-if="!vm.runtimeVersions.length" class="description">No versions listed</p>\n    <md-list ng-if="vm.runtimeVersions.length">\n      <md-list-item ng-repeat="version in vm.runtimeVersions track by $index">\n        <div flex>\n          <h5 >Version <span ng-bind="version.version"></span></h5>\n          <p class="small-description" ng-bind="version.creationTime.getAsAgo()"></p>\n        </div>\n        <span ng-bind="version.comment" flex="75"></span>\n        <span flex="5">\n          <md-menu>\n            <md-icon class="pull-right" ng-click="$mdMenu.open($event)"><i class="fa-ellipsis-v fa pull-right"></i></md-icon>\n            <md-menu-content>\n              <md-menu-item>\n                <md-button ng-disabled="$index === 0" ng-click="vm.revertRuntime(version)">Revert to this version</md-button>\n              </md-menu-item>\n              <md-menu-item>\n                <md-button disabled>Restore to sandbox</md-button>\n              </md-menu-item>\n            </md-menu-content>\n          </md-menu>\n      </span>\n        <md-divider ng-if="!$last"></md-divider>\n      </md-list-item>\n    </md-list>\n  </div>\n</md-dialog-content>\n<md-dialog-actions ng-if="!vm.isLoading()">\n  <md-button ng-click="vm.closeDialog()">Close</md-button>\n</md-dialog-actions>\n'},function(e,t){e.exports='<div class="api-box agent-form-header" ng-if="vm.isLoading()">\n  <md-progress-linear md-mode="indeterminate"></md-progress-linear>\n</div>\n\n<div class="" ng-if="!vm.isLoading()">\n\n  <md-list>\n    <md-divider></md-divider>\n\n    <md-list-item class="list-item-low" layout="row">\n        <div flex>Runtime</div>\n        <div flex="40">Integrations</div>\n        <div flex="15">Version</div>\n        <div flex="15"><a ng-click="vm.showVersionsPopup()" class="pull-right">All versions</a></div>\n    </md-list-item>\n    <md-divider></md-divider>\n    <md-list-item class="list-item-high">\n      <span flex>Sandbox</span>\n      <div flex="40">\n        <span ng-repeat="integrationName in vm.enabledIntegrations" class="b_card__icon b_integration_icon" id="b_integration_icon_{{integrationName}}"></span>\n      </div>\n      <div flex="15">Latest</div>\n      <span flex="15">\n          <md-menu class="pull-right">\n            <md-button class="md-raised md-primary" ng-click="$mdMenu.open($event)">Publish</md-button>\n            <md-menu-content>\n              <md-menu-item>\n                <md-button ng-click="vm.publishAsNew()">New runtime</md-button>\n              </md-menu-item>\n              <md-menu-item>\n                <md-button ng-click="vm.publishAsExisting()" ng-disabled="!vm.runtimeList.length" >Existing runtime</md-button>\n              </md-menu-item>\n            </md-menu-content>\n          </md-menu>\n      </span>\n      <md-divider></md-divider>\n    </md-list-item>\n    <md-list-item ng-repeat="runtime in vm.runtimeList" class="list-item-high">\n      <span ng-bind="runtime.name" flex></span>\n      <div flex="40"></div>\n      <div flex="15">\n        <span>Version <span ng-bind="runtime.agentVersion"></span></span>\n        <span ng-if="var = vm.getVersionComment(runtime.agentVersion)">\n          <br/>\n          <p class="small-description" ng-bind="var"></p>\n        </span>\n      </div>\n      <span flex="15">\n          <md-menu>\n            <md-button ng-click="$mdMenu.open($event)" class="pull-right md-icon-button">\n              <md-icon ><i class="fa-ellipsis-v fa"></i></md-icon>\n            </md-button>\n            <md-menu-content>\n              <md-menu-item>\n                <md-button disabled>Edit in sandbox</md-button>\n              </md-menu-item>\n              <md-menu-item>\n                <md-button ng-click="vm.showRuntimeHistory(runtime)">Runtime history</md-button>\n              </md-menu-item>\n              <md-divider></md-divider>\n              <md-menu-item>\n                <md-button ng-click="vm.deleteRuntime(runtime)">Delete runtime</md-button>\n              </md-menu-item>\n            </md-menu-content>\n          </md-menu>\n      </span>\n      <md-divider></md-divider>\n    </md-list-item>\n  </md-list>\n</div>\n'},function(e,t){e.exports='<md-toolbar class="md-accent">\n  <div class="md-toolbar-tools">\n    <h1>Version history</h1>\n  </div>\n</md-toolbar>\n<md-divider></md-divider>\n<md-dialog-content>\n  <div class="md-dialog-content" ng-if="!vm.isLoading()">\n    <p ng-if="!vm.versionList.length" class="description">No versions listed</p>\n    <md-list ng-if="vm.versionList.length">\n      <md-list-item ng-repeat="version in vm.versionList">\n        <div flex>\n          <h5 >Version <span ng-bind="version.version"></span></h5>\n          <p class="small-description" ng-bind="version.creationTime.getAsAgo()"></p>\n        </div>\n        <span ng-bind="version.comment" flex="75"></span>\n        <span flex="5">\n          <md-menu>\n            <md-icon class="pull-right" ng-click="$mdMenu.open($event)"><i class="fa-ellipsis-v fa pull-right"></i></md-icon>\n            <md-menu-content>\n              <md-menu-item>\n                <md-button ng-click="vm.publishAsExisting(version)">Publish to a runtime</md-button>\n              </md-menu-item>\n              <md-menu-item>\n                <md-button disabled>Restore to sandbox</md-button>\n              </md-menu-item>\n            </md-menu-content>\n          </md-menu>\n      </span>\n      <md-divider ng-if="!$last"></md-divider>\n      </md-list-item>\n    </md-list>\n  </div>\n</md-dialog-content>\n<md-dialog-actions ng-if="!vm.isLoading()">\n  <md-button ng-click="vm.cancelDialog()">Close</md-button>\n  <div flex></div>\n  <md-button ng-click="vm.showCreateVersionPopup()">Create version</md-button>\n</md-dialog-actions>\n'},function(e,t){e.exports='<div>\n    <fieldset id="agent-sample-switcher">\n        <h5>Add sample data</h5>\n        <md-input-container class="md-block" md-no-float>\n            <md-select ng-model="vm.agent.sampleData"\n                       placeholder="Select sample data to be loaded into new agent or leave unselected for empty agent">\n                <md-option (click)="vm.agent.sampleData.reset()">\n                    -- select value --\n                </md-option>\n                <md-option ng-repeat="value in vm.samplesDataItems"\n                           ng-value="value">\n                    {{ value }}\n                </md-option>\n            </md-select>\n        </md-input-container>\n    </fieldset>\n</div>'},function(e,t){e.exports='<div ng-if="vm.areConditionsOk()">\n\n  <md-content flex layout-padding>\n    <p>After you grant or revoke access to your agent, it may take some time for the change to be effected.</p>\n  </md-content>\n\n  <md-list >\n    <md-list-item><h5>Who has access</h5></md-list-item>\n    <div ng-if="vm.adminList.length">\n      <md-list-item ng-repeat="email in vm.adminList">\n        <p> {{ email }} </p>\n        <span class="md-secondary">\n          <span>ADMIN</span>\n        </span>\n      </md-list-item>\n    </div>\n\n    <md-list-item ng-repeat="(email, role) in vm.permissionList" ng-if="role !== null">\n      <p ng-bind="email"></p>\n      <div class="md-secondary-container">\n        <md-select class="b_agent-share-role-selector  md-primary md-raised" ng-model="vm.permissionList[email]" placeholder="Role" required>\n          \x3c!--md-option value="NONE">NONE</md-option--\x3e\n          <md-option value="DEVELOPER">DEVELOPER</md-option>\n          <md-option value="REVIEWER">REVIEWER</md-option>\n        </md-select>\n        <md-button class="md-secondary md-icon-button b_agent-share-remove-button" ng-click="vm.removeUser(email)">\n          <md-icon class="" aria-label="remove user permissions"><i class="material-icons">clear</i></md-icon>\n        </md-button>\n      </div>\n    </md-list-item>\n\n    <md-list-item>\n      <h5>Invite new people</h5>\n    </md-list-item>\n\n    <md-list-item>\n      \x3c!--md-chips\n          md-add-on-blur="true"\n          ng-enter="vm.addUser()" flex ng-model="vm.selectedEmails" md-enable-chip-edit="true"\n          class="b_agent-share-email-selector"\n          placeholder="Enter an email" secondary-placeholder="Add more people..."\n          md-on-add="vm.validateChip($chip)"\n      ></md-chips--\x3e\n      <md-input-container ng-form="newEmail" class="b_agent-share-email-selector" md-no-float flex>\n        <input name="email" ng-enter="vm.addUser()" ng-model="vm.selectedEmail" placeholder="Enter email..." type="email"/>\n        <div ng-messages="newEmail.email.$error">\n          <div ng-message="email">This field must be a valid email address.</div>\n        </div>\n      </md-input-container>\n      <md-select class="b_agent-share-role-selector md-secondary md-primary md-raised" ng-model="vm.selectedRole" placeholder="Role" required>\n        <md-option value="DEVELOPER">DEVELOPER</md-option>\n        <md-option value="REVIEWER">REVIEWER</md-option>\n      </md-select>\n    </md-list-item>\n\n    <md-list-item>\n        <md-button class="md-secondary" ng-disabled="!vm.selectedEmail || !newEmail.$valid" ng-click="vm.addUser()">Add</md-button>\n    </md-list-item>\n  </md-list>\n</div>\n\n<div ng-if="vm.isLoading()">\n  <br/><br/>\n  <div layout="row" layout-align="center center">\n    <md-progress-circular  md-mode=\'indeterminate\' md-diameter="40"></md-progress-circular>\n  </div>\n  <div layout="row" layout-align="center center">\n    <p>Checking status</p>\n  </div>\n</div>\n\n<div ng-if="!vm.isLoading() && vm.viewState.isError">\n  <h2>Something went wrong</h2>\n  <p>Can not retrieve permissions for agent.</p>\n</div>'},function(e,t){e.exports='<div layout="row" ng-if="!vm.isLoading()">\n  <div flex>\n    <span class="current-lang" ng-bind="vm.formatLocale(vm.getCurrentLanguage())"></span>\n    <span class="switch-lang" ng-repeat="lang in vm.getRecent()" ng-bind="vm.formatLocale(lang)" ng-click="vm.switchLang(lang)"></span>\n    <span class="switch-lang show-more" ng-if="vm.getTail().length">\n      <md-menu>\n        <i class="glyphicon glyphicon-option-horizontal icon-right" ng-click="$mdMenu.open($event)"></i>\n        <md-menu-content>\n          <md-menu-item  ng-repeat="lang in vm.getTail()">\n            <md-button ng-click="vm.switchLang(lang)" ng-bind="vm.formatLocale(lang)" aria-label="Switch agent to \'{{vm.formatLocale(lang)}}\' language"></md-button>\n          </md-menu-item>\n        </md-menu-content>\n      </md-menu>\n    </span>\n  </div>\n  <div flex="10">\n    <span id="link-create-lang" md-ink-ripple ui-sref="auth.workPlace.agent_edit({agentId: vm.getCurrentAgentLocal().id, tab: \'languages\'})" class="flaticon stroke plus icon-right"></span>\n  </div>\n</div>\n<div ng-if="vm.isLoading()">\n  <md-progress-linear></md-progress-linear>\n</div>\n'},function(e,t){e.exports='<div class="cloud-functions-container">\n    <header-with-toggle header="Inline Editor"\n                        sub-header="(Powered by Cloud Functions for Firebase)"\n                        toggle-model="vm.cloudFunctionsEnabled"\n                        toggle-disabled="vm.isAgentReadOnly"\n                        toggle-changed="vm.enableAndInitializeCloudFunctions()"></header-with-toggle>\n\n    Build and manage fulfillment directly in Dialogflow via Cloud Functions for Firebase.\n    <a href="https://dialogflow.com/docs/how-tos/getting-started-fulfillment" target="_blank">Docs</a>\n\n    <div ng-show="!vm.isLoading()">\n        <div ng-show="vm.isCloudFunctionOfCanonicalForm">\n            <div class="editor-container" ng-class="{\'editor-container-disabled\': !vm.agent.webhook.cloudFunctionsEnabled}">\n                <div class="tab-control">\n                    <ul class="wrap">\n                        <li ng-class="{active: vm.isCurrentFile(\'index.js\')}">\n                            <a ng-click="vm.setCurrentFile(\'index.js\')"\n                               ng-class="{disabled: !vm.agent.webhook.cloudFunctionsEnabled}">index.js</a>\n                        </li>\n                        <li ng-class="{active: vm.isCurrentFile(\'package.json\')}">\n                            <a ng-click="vm.setCurrentFile(\'package.json\')"\n                               ng-class="{disabled: !vm.agent.webhook.cloudFunctionsEnabled}">package.json</a>\n                        </li>\n                        <li class="download-button">\n                            <md-button\n                                ng-disabled="vm.disableDownload()"\n                                ng-click="vm.download()"\n                                type="button"\n                                class="md-icon-button md-accent">\n                                <i class="fa fa-download"\n                                   ng-class="vm.disableDownload() ? \'download-icon-disabled\' : \'download-icon\'"></i>\n                            </md-button>\n                        </li>\n                    </ul>\n                </div>\n\n                <div ng-show="vm.isCurrentFile(\'index.js\')">\n                    <textarea id="indexJsTextarea"></textarea>\n                </div>\n\n                <div ng-show="vm.isCurrentFile(\'package.json\')">\n                    <textarea id="packageJsonTextarea"></textarea>\n                </div>\n            </div>\n\n            <div class="failure-callout" ng-show="!!vm.deploymentFailureMessage && vm.agent.webhook.cloudFunctionsEnabled">\n                <span class="deployment-failure-message">{{vm.deploymentFailureMessage}}</span>\n            </div>\n\n            <firebase-billing-warning cloud-functions-enabled="vm.agent.webhook.cloudFunctionsEnabled"\n                                      cloud-project-id="vm.agent.cloudProjectId"\n                                      lookback-minutes="1440"></firebase-billing-warning>\n\n            <div layout="row" layout-align="space-between center" ng-show="vm.agent.webhook.cloudFunctionsEnabled">\n                <div>\n                    <a ng-href="{{::vm.getLinkToFirebaseConsole()}}" ng-show="vm.showLastDeployed"\n                       target="_blank" rel="noopener">View execution logs in the Firebase console</a>\n                </div>\n\n                <div>\n                    <span ng-show="vm.showLastDeployed">Last deployed on {{vm.lastDeployed | date:\'MM/dd/yyyy HH:mm\'}}</span>\n                </div>\n\n                <md-button\n                    md-ink-ripple\n                    progress-button="vm.deployProgressPromise"\n                    ng-disabled="vm.isAgentReadOnly || vm.isDeploying"\n                    ng-click="vm.saveAndDeploy()"\n                    type="button" class="md-primary md-raised editor-button"\n                    progress-button-conf="vm.deployProgressConf">\n                    Deploy\n                </md-button>\n            </div>\n        </div>\n\n        <div ng-show="!vm.isCloudFunctionOfCanonicalForm && vm.agent.webhook.cloudFunctionsEnabled">\n            <fb-callout fb-type="warning" fb-mode="callout"\n                        fb-message="Your Cloud Function has been modified outside of the Dialogflow editor which is not supported.\n                                    Please continue using your external tools."></fb-callout>\n        </div>\n    </div>\n\n    <div ng-show="vm.isLoading()" class="loading-indicator">\n        <md-progress-linear md-mode="indeterminate"></md-progress-linear>\n    </div>\n</div>\n'},function(e,t){e.exports='\x3c!-- fake fields are a workaround for chrome autofill getting the wrong fields --\x3e\n<input class="stealthy" type="text" name="fakeusernameremembered" tabindex="-1"/>\n<input class="stealthy" type="password" name="fakepasswordremembered" tabindex="-1"/>\n\n<header-with-toggle header="Webhook"\n                    toggle-model="vm.customWebhookEnabled"\n                    toggle-disabled="vm.isAgentReadOnly"\n                    toggle-changed="vm.webhookToggleChanged()"></header-with-toggle>\n\n<div>\n    <p>\n        Your web service will receive a POST request from Dialogflow in the <a href="https://dialogflow.com/docs/reference/agent/query#response" target="_blank">form of the response</a> to a user query matched by intents with webhook enabled. Be sure that your web service meets all the <a href="https://docs.dialogflow.com/docs/webhook" target="_blank">webhook requirements</a>.\n    </p>\n    <a href="https://dialogflow.com/docs/fulfillment#webhook-example" target="_blank">Webhook example</a>\n</div>\n\n<div id="fulfillment-form" class="fulfillment-editor" ng-form="fulfillmentForm">\n\n    <div ng-show="vm.customWebhookEnabled">\n        <div layout="row">\n            <div flex="15" class="title">\n                <label class="md-no-float">URL*</label>\n            </div>\n            <div flex="85">\n                <md-input-container md-no-float class="md-block md-no-float">\n                    <input ng-model="vm.agent.webhook.url" placeholder="Enter URL"\n                           name="webhookUrl"\n                           focus-on="webhookFocus=vm.customWebhookEnabled" ng-blur="webhookFocus=false"\n                           ng-required="vm.customWebhookEnabled"\n                           ng-disabled="vm.isAgentReadOnly"\n                    >\n                     <div ng-messages="fulfillmentForm.webhookUrl.$error" role="alert">\n                        <div ng-message-exp="[\'required\']">\n                            This url will receive a POST request from Dialogflow every time the webhook is triggered by an intent.\n                        </div>\n                    </div>\n                </md-input-container>\n            </div>\n        </div>\n\n        <div layout="row">\n            <div flex="15" class="title">\n                <label class="md-no-float">Basic Auth</label>\n            </div>\n            <div flex="30">\n                <md-input-container md-no-float class="md-block md-no-float">\n                    <input ng-model="vm.agent.webhook.username" placeholder="Enter username" autocomplete="off" ng-disabled="vm.isAgentReadOnly">\n                </md-input-container>\n            </div>\n            <div flex="55">\n                <md-input-container md-no-float class="md-block md-no-float">\n                    <input ng-model="vm.agent.webhook.password" type="password" placeholder="Enter password" autocomplete="off" ng-disabled="vm.isAgentReadOnly">\n                </md-input-container>\n            </div>\n        </div>\n\n        <div layout="row" ng-repeat="header in vm.headers track by $index" ng-mouseenter="hover = true" ng-mouseleave="hover = false">\n            <div flex="15" class="title">\n                <label class="md-no-float" ng-if="$index===0">Headers</label>\n            </div>\n            <div flex="30">\n                <md-input-container md-no-float class="md-block md-no-float">\n                    <input ng-model="header.key" placeholder="Enter key" ng-blur="vm.prepareToSaveHeaders()" ng-disabled="vm.isAgentReadOnly">\n                </md-input-container>\n            </div>\n            <div flex="45">\n                <md-input-container md-no-float class="md-block md-no-float">\n                    <input ng-model="header.value" placeholder="Enter value" ng-blur="vm.prepareToSaveHeaders()" ng-disabled="vm.isAgentReadOnly">\n                </md-input-container>\n            </div>\n            <div flex="10">\n                <md-button class="md-icon-button fulfillment__remove-button" aria-label="Remove headers"\n                           ng-click="vm.removeHeader($index)"\n                           ng-show="hover && (vm.headers.length > 1)"\n                           ng-disabled="vm.isAgentReadOnly"\n                >\n                    <span class="flaticon stroke x-2 icon"></span>\n                </md-button>\n            </div>\n        </div>\n        <div layout="row">\n            <div flex="15"></div>\n            <div flex="85">\n                <a ng-click="vm.addHeader()" class="fulfillment__add-button" a-disabled="vm.isAgentReadOnly"><span class="flaticon stroke plus-2 icon"></span> Add header</a>\n            </div>\n        </div>\n        <div layout="row">\n            <div flex="15" class="title">\n                <label class="md-no-float">Domains</label>\n            </div>\n            <div flex="85">\n                {{useForDomains}}\n                <md-input-container md-no-float class="md-block md-no-float">\n                    <md-select ng-model="vm.agent.webhook.useForDomains"\n                               aria-label="Webhook for all domains"\n                               ng-disabled="vm.isAgentReadOnly"\n                    >\n                        <md-option ng-repeat="option in vm.optionsUseForDomains" ng-value="option.value">\n                            {{ option.label }}\n                        </md-option>\n                    </md-select>\n                </md-input-container>\n            </div>\n        </div>\n    </div>\n\n    <cloud-functions-fulfillment ng-show="vm.userProfile.isFirebaseFunctionsIntegrationAvailable"\n                                 agent="vm.agent" is-agent-read-only="vm.isAgentReadOnly"\n                                 functions-toggle-changed="vm.cloudFunctionsToggleChanged()"></cloud-functions-fulfillment>\n\n    <div layout="row" layout-align="end center">\n        <button\n            md-ink-ripple\n            progress-button="vm.saveProgressPromise"\n            ng-disabled="vm.isAgentReadOnly"\n            type="button" class="md-button md-primary md-raised"\n            ng-click="vm.saveFulfillment()"\n            ng-hide="vm.agent.webhook.cloudFunctionsEnabled"\n            progress-button-conf="$scope.saveProgressConf">\n            Save\n        </button>\n    </div>\n</div>'},function(e,t){e.exports='<div layout="row" layout-align="space-between center" class="fulfillment-header">\n    <h3>{{vm.header}}<span class="fulfillment-subheader">{{vm.subHeader}}</span></h3>\n\n    <div layout="row" layout-align="space-between center">\n        <div class="title">\n            <label class="md-no-float" ng-class="{enabled: vm.toggleModel}">\n                {{vm.toggleModel ? "Enabled" : "Disabled"}}</label>\n        </div>\n        <div>\n            <md-switch  class="md-primary"\n                        ng-model="vm.toggleModel"\n                        ng-change="vm.toggleChanged()"\n                        aria-label="Allow user service request (Webhook) for the agent."\n                        ng-disabled="vm.toggleDisabled"\n            ></md-switch>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="comment-box">\n\n    <div class="head" ng-click="vm.shown = !vm.shown">\n        <span class="title">Google Assistant</span>\n        <i class="fa fa-angle-down pull-right intent-show-hide" aria-hidden="true" ng-if="!vm.shown"></i>\n        <i class="fa fa-angle-up pull-right  intent-show-hide" aria-hidden="true" ng-if="vm.shown"></i>\n    </div>\n\n    <md-checkbox ng-show="vm.shown" class="animate-show md-primary" ng-model="vm.isEndIntent">End conversation</md-checkbox>\n</div>'},function(e,t){e.exports='<div class="comment-box">\n    <div class="head" ng-click="vm.contextsShown = !vm.contextsShown">\n        <span class="title">Contexts</span>\n        <i class="fa fa-angle-down pull-right intent-show-hide" aria-hidden="true" ng-if="!vm.contextsShown"></i>\n        <i class="fa fa-angle-up pull-right  intent-show-hide" aria-hidden="true" ng-if="vm.contextsShown"></i>\n    </div>\n\n    <div ng-show="vm.contextsShown" class="animate-show">\n\n        <static-info message="{{vm.getLimitText()}}" ng-if="vm.isLimitExceeded()"></static-info>\n\n        <md-chips ng-model="vm.inputContexts"\n                  name="input-contexts"\n                  placeholder="Add input context"\n                  md-separator-keys="vm.separatorKeys"\n                  md-autocomplete-snap\n                  md-add-on-blur="true"\n                  md-chips-input\n                  md-chips-input-maxlength="vm.limitsManager.getTextLength(\'context\')"\n                  md-chips-input-show="!vm.isInputContextsLimitExceeded()"\n                  md-chips-input-illegal-regex="vm.UtilsService.getLatinAlphaNumericRe()">\n\n            <md-autocomplete\n                    md-no-cache="true"\n                    md-min-length="1"\n                    md-search-text="searchText"\n                    md-items="item in vm.querySearchInput(searchText)"\n                    placeholder="Add input context"\n                    md-item-text="item">\n                <span md-highlight-text="searchText">{{item}}</span>\n            </md-autocomplete>\n        </md-chips>\n\n        <div class="pull-right reset-contexts" ng-click="vm.resetContexts = !vm.resetContexts" ng-class="vm.resetContexts ? \'active\' : \'\'"><i class="fa fa-remove"></i></div>\n\n        <div ng-if="vm.resetContexts" class="context-info">\n            <span class="flaticon stroke about-2"></span>Contexts will be reset\n        </div>\n\n        <md-chips ng-model="vm.outputContexts"\n                  name="output-contexts"\n                  placeholder="Add output context"\n                  md-autocomplete-snap\n                  md-transform-chip="vm.newOutputContext($chip)"\n                  ng-if="!vm.resetContexts"\n                  md-separator-keys="vm.separatorKeys"\n                  md-add-on-blur="true"\n                  md-chips-input\n                  md-chips-input-maxlength="vm.limitsManager.getTextLength(\'context\')"\n                  md-chips-input-show="!vm.isOutputContextsLimitExceeded()"\n                  md-chips-input-illegal-regex="vm.UtilsService.getLatinAlphaNumericRe()">\n\n            <md-chip-template>\n                <div class="lifespan-container">\n                    <md-tooltip>Lifespan</md-tooltip>\n                    \x3c!-- textarea here is a hack to allow md-autocomplete work - by default md-chips adding chips from first input --\x3e\n                    <textarea rows="1" type="number" ng-focus="vm.preventInput($event)" ng-blur="vm.checkLifespan($chip)" ng-click="vm.preventInput($event)" ng-model="$chip.lifespan"></textarea>\n                </div>\n                <s ng-if="!$chip.lifespan">{{$chip.name}}</s>\n                <span ng-if="$chip.lifespan">{{$chip.name}}</span>\n            </md-chip-template>\n            <md-autocomplete\n                    placeholder="Add output context"\n                    md-no-cache="true"\n                    md-min-length="1"\n                    md-search-text="searchText"\n                    md-items="item in vm.querySearchOutput(searchText)"\n                    md-item-text="item">\n                <span md-highlight-text="searchText">{{item}}</span>\n            </md-autocomplete>\n        </md-chips>\n    </div>\n</div>'},function(e,t){e.exports='<div class="comment-box">\n    <div class="head" ng-click="vm.eventsShown = !vm.eventsShown">\n        <span class="title">Events\n            <span class="fa fa-question-circle">\n                <md-tooltip md-direction="top" md-delay="100">Intents can be triggered by event names instead of user queries. Welcome events are automatically supported for some one-click integrations.</md-tooltip>\n            </span>\n\n        </span>\n\n\n        <i class="fa fa-angle-down pull-right intent-show-hide" aria-hidden="true" ng-if="!vm.eventsShown"></i>\n        <i class="fa fa-angle-up pull-right intent-show-hide" aria-hidden="true" ng-if="vm.eventsShown"></i>\n    </div>\n    <md-chips class="animate-show"\n              ng-show="vm.eventsShown"\n              ng-model="vm.events"\n              name="events"\n              md-transform-chip="vm.newEvent($chip)"\n              placeholder="Enter event name"\n              md-autocomplete-snap\n              md-separator-keys="vm.separatorKeys"\n              md-add-on-blur="true"\n              md-on-add="vm.onAdd($chip)"\n              md-on-remove="vm.onRemove($chip)"\n              md-chips-input\n              md-chips-input-illegal-regex="vm.UtilsService.getLatinAlphaNumericRe()">\n        <md-autocomplete\n                md-selected-item="selectedItem"\n                md-search-text="searchText"\n                md-no-cache="true"\n                md-min-length="1"\n                md-items="item in vm.querySearch(searchText)"\n                md-item-text="item"\n                placeholder="Add event">\n            <span md-highlight-text="searchText">{{item}}</span>\n        </md-autocomplete>\n        <md-chip-template>\n            {{$chip.name}}\n        </md-chip-template>\n    </md-chips>\n</div>'},function(e,t){e.exports='<div class="intents">\n  <ul class="list-group follow-up-intents">\n    <li ng-repeat="followUpIntent in vm.followUpIntents">\n      <intents-list-item intent="followUpIntent"\n                         layer="-1"\n                         parent-name="vm.parentIntent.name"\n                         simple="true"\n      ></intents-list-item>\n    </li>\n  </ul>\n</div>'},function(e,t){e.exports='<div class="head" layout="row" layout-align="space-between center">\n    <div flex="70">\n        <span class="title">User says</span>\n    </div>\n    <md-input-container ng-show="!userSaysHidden" md-no-float class="md-icon-right md-block usersays-search-form animate-show" ng-class="{\'is-filtering\': vm.viewState.isFilteringUserSays}">\n        <input  ng-model="vm.userSaysFilter" type="text" spellcheck="false" ng-change="vm.userSaysFilterChanged()" placeholder="Search in user says">\n        <md-icon class="mic-ico material-icons">\n            <span class="glyphicon glyphicon-search" ng-if="!vm.userSaysFilter"></span>\n            <span class="glyphicon glyphicon-remove" ng-click="vm.userSaysFilter=\'\';vm.makeFilterUserSays();" ng-if="vm.userSaysFilter"></span>\n            <span class="fa fa-spin fa-circle-o-notch"></span>\n        </md-icon>\n\n    </md-input-container>\n\n    <i class="fa fa-angle-down pull-right intent-show-hide" ng-show="userSaysHidden" ng-click="userSaysHidden = !userSaysHidden"></i>\n    <i class="fa fa-angle-up pull-right intent-show-hide" ng-show="!userSaysHidden" ng-click="userSaysHidden = !userSaysHidden"></i>\n\n</div>\n<static-info message="{{vm.limitsManager.getText(\'userSays\')}}" ng-show="!vm.emptyUserSaysEnabled"></static-info>\n\n<div ng-show="!userSaysHidden"  class="animate-show">\n    <div class="empty-user-says-holder" >\n        <user-says-editor\n                class="user-says-editor"\n                user-says="vm.emptyUserSays"\n                user-says-editor-index="-1"\n                user-says-editor-focused-index="vm.focusedUserSays"\n                uses-pure-templates="true"\n                key-down-cb="vm.emptyUserSaysKeyDownCb"\n                blur-cb="vm.emptyUserSaysBlurCb"\n                user-says-disabled="!vm.emptyUserSaysEnabled || vm.isAgentReadOnly"\n                auto-sync-disabled="true"\n                auto-complete-config="vm.autoCompleteConfig"\n                placeholder="Add user expression"\n                max-input-length="vm.limitsManager.getTextLength(\'userSays\')"\n        ></user-says-editor>\n    </div>\n\n    <div class="user-says-editor-holder" ng-if="vm.agent.cortana.cortanaCompatible">\n        <user-says-editor\n                class="user-says-editor"\n                ng-repeat="userSays in vm.filteredUserSaysList | limitTo:vm.paging.pageSize:vm.paging.currentPage*vm.paging.pageSize track by $index"\n                user-says="userSays"\n                user-says-editor-index="$index"\n                user-says-editor-focused-index="vm.focusedUserSays"\n                uses-pure-templates="$index === 0 && vm.scrollBegin === 0 ? false : true"\n                markup-disabled="$index === 0 && vm.scrollBegin === 0 ? true : false"\n                delete-cb="($index === 0 && vm.scrollBegin === 0) || vm.isAgentReadOnly ? null : vm.userSaysDeleteCb"\n                placeholder="{{$index === 0 && vm.scrollBegin === 0 ? \'Add user expression. This expression will also be used as Cortana example\' : \'Add user expression\'}}"\n                blur-cb="vm.userSaysBlurCb"\n                key-down-cb="vm.userSaysKeyDownCb"\n                auto-complete-config="vm.autoCompleteConfig"\n                show-table="vm.viewState.showTableOnFirstUserSays && $index === 0"\n                max-input-length="vm.limitsManager.getTextLength(\'userSays\')"\n        ></user-says-editor>\n    </div>\n    <div class="user-says-editor-holder" ng-if="!vm.agent.cortana.cortanaCompatible">\n        <user-says-editor\n                class="user-says-editor"\n                ng-repeat="userSays in vm.filteredUserSaysList | limitTo:vm.paging.pageSize:vm.paging.currentPage*vm.paging.pageSize track by $index"\n                user-says="userSays"\n                user-says-editor-index="$index"\n                user-says-editor-focused-index="vm.focusedUserSays"\n                uses-pure-templates="true"\n                delete-cb="vm.isAgentReadOnly ? null : vm.userSaysDeleteCb"\n                blur-cb="vm.userSaysBlurCb"\n                key-down-cb="vm.userSaysKeyDownCb"\n                auto-complete-config="vm.autoCompleteConfig"\n                placeholder="Add user expression"\n                user-says-disabled="vm.isAgentReadOnly"\n                show-table="vm.viewState.showTableOnFirstUserSays && $index === 0"\n                max-input-length="vm.limitsManager.getTextLength(\'userSays\')"\n        ></user-says-editor>\n    </div>\n\n    <div paging="vm.paging" class="paging-footer"></div>\n\n</div>'},function(e,t){e.exports='<form name="cardResponse">\n\t<div class="image-thumb" ng-show="vm.isShowThumb">\n\t\t<div class="wrap-loader" ng-hide="vm.imageUrl">\n\t        <div layout="row" layout-sm="column" layout-align="space-around">\n\t            <md-progress-circular\n\t                    md-mode="indeterminate"\n\t                    md-diameter="40">\n\t            </md-progress-circular>\n\t        </div>\n\t    </div>\n\t\t<div class="image-thumb-vertical">\n\t\t\t<div><img ng-src="{{ vm.imageUrl }}" alt="" ng-show="vm.imageUrl" /></div>\n\t\t</div>\n\t</div>\n\t<div class="input-group solid-input first">\n\t\t<input ng-model="vm.content.imageUrl"\n\t\t\t\t\t completer="vm.textcompleteOptions"\n\t\t\t\t\t type="text" class="form-control"\n\t\t\t\t\t placeholder="Enter image URL"\n\t\t\t\t\t ng-blur="vm.imageUrlChanged()"\n\t\t\t\t\t maxlength="{{vm.limitsManager.getTextLength(\'url\', false)}}">\n\t</div>\n\t<div class="input-group solid-input">\n\t\t<input ng-model="vm.content.title"\n\t\t\t\t\t completer="vm.textcompleteOptions"\n\t\t\t\t\t type="text" class="form-control"\n\t\t\t\t\t placeholder="Enter card title (required)">\n\t</div>\n\t<div class="input-group solid-input">\n\t\t<input ng-model="vm.content.subtitle"\n\t\t\t\t\t completer="vm.textcompleteOptions"\n\t\t\t\t\t type="text" class="form-control"\n\t\t\t\t\t placeholder="Enter card subtitle">\n\t</div>\n\t<div class="input-group solid-input solid-input__roll" ng-repeat="button in vm.content.buttons track by $index">\n\t\t<a class="solid-input__toggle" ng-click="activeRoll = !activeRoll">\n\t\t\t<span class="flaticon stroke up-2"\n\t\t\t\t  ng-class="{\'up-2\': activeRoll, \'down-2\': !activeRoll }"\n\t\t\t></span>\n\t\t</a>\n\t\t<input ng-model="button.text"\n\t\t\t   completer="vm.textcompleteOptions"\n\t\t\t   type="text"\n\t\t\t   class="form-control solid-input__title"\n\t\t\t   placeholder="Enter new button title..."\n\t\t\t   ng-keydown="vm.keyDown($event, button, $index);"\n\t\t\t   focus-on="$index === vm.focusIndex">\n\t\t<input ng-model="button.postback"\n\t\t\t   completer="vm.textcompleteOptions"\n\t\t\t   type="text"\n\t\t\t   class="form-control"\n\t\t\t   placeholder="Enter URL or text postback..."\n\t\t\t   ng-show="activeRoll"\n\t\t\t\t maxlength="{{vm.limitsManager.getTextLength(\'url\', false)}}">\n\t</div>\n\t<div class="input-group solid-input solid-input__roll" ng-show="vm.blankButtonVisible()" ng-keyup="vm.blankButtonKeyUp()">\n\t\t<a class="solid-input__toggle" ng-click="vm.blankButtonActiveRoll = !vm.blankButtonActiveRoll">\n\t\t\t<span class="flaticon stroke up-2"\n\t\t\t\t  ng-class="{\'up-2\': vm.blankButtonActiveRoll, \'down-2\': !vm.blankButtonActiveRoll }"\n\t\t\t></span>\n\t\t</a>\n\t\t<input completer="vm.textcompleteOptions"\n\t\t\t   type="text"\n\t\t\t   class="form-control solid-input__title"\n\t\t\t   placeholder="Enter new button title..."\n\t\t\t   ng-focus="vm.blankButtonFocus()">\n\t\t<input completer="vm.textcompleteOptions"\n\t\t\t   type="text"\n\t\t\t   class="form-control"\n\t\t\t   placeholder="Enter URL or text postback..."\n\t\t\t   ng-show="vm.blankButtonActiveRoll"\n\t\t\t   ng-focus="vm.blankButtonFocus()"\n         maxlength="{{vm.limitsManager.getTextLength(\'url\', false)}}">\n\t</div>\n</form>'},function(e,t){e.exports='<json-editor options="vm.editorOptions" json="vm.content.payload"></json-editor>'},function(e,t){e.exports='<form name="basicCardResponse">\n  <div class="image-thumb" ng-show="vm.isShowThumb">\n    <div class="wrap-loader" ng-hide="vm.imageUrl">\n      <div layout="row" layout-sm="column" layout-align="space-around">\n        <md-progress-circular\n            md-mode="indeterminate"\n            md-diameter="40">\n        </md-progress-circular>\n      </div>\n    </div>\n    <div class="image-thumb-vertical">\n      <div><img ng-src="{{ vm.imageUrl }}" alt="" ng-show="vm.imageUrl"/></div>\n    </div>\n  </div>\n  <div class="input-group solid-input first">\n    <input ng-model="vm.content.image.url"\n           completer="vm.textcompleteOptions"\n           type="text"\n           class="form-control"\n           placeholder="Enter image URL..."\n           ng-blur="vm.imageUrlChanged()"\n           maxlength="{{vm.limitsManager.getTextLength(\'url\', false)}}">\n  </div>\n  <div class="input-group solid-input">\n    <input ng-model="vm.content.title" completer="vm.textcompleteOptions" type="text"\n           class="form-control" placeholder="Enter title...">\n  </div>\n  <div class="input-group solid-input">\n    <input ng-model="vm.content.subtitle" completer="vm.textcompleteOptions" type="text"\n           class="form-control" placeholder="Enter subtitle...">\n  </div>\n  <div class="input-group solid-input">\n    <textarea name="formatted_text"\n              ng-model="vm.content.formattedText"\n              class="borderless form-control"\n              ng-class="{\'has-error\':(vm.saveTouched || basicCardResponse.formatted_text.$touched) && basicCardResponse.formatted_text.$invalid}"\n              msd-elastic\n              ng-keydown="vm.keyDown($event);"\n              placeholder="Enter text..."\n              completer="vm.textcompleteOptions"\n              ng-required="!vm.content.image.url"\n    ></textarea>\n  </div>\n  <div class="input-group solid-input">\n    <input ng-model="vm.content.buttons[0].title"\n           type="text"\n           class="form-control"\n           placeholder="Enter weblink title..."\n           completer="vm.textcompleteOptions">\n  </div>\n  <div class="input-group solid-input">\n    <input ng-model="vm.content.buttons[0].openUrlAction.url"\n           type="text"\n           class="form-control"\n           placeholder="Enter weblink..."\n           completer="vm.textcompleteOptions"\n           maxlength="{{vm.limitsManager.getTextLength(\'url\', false)}}">\n  </div>\n</form>'},function(e,t){e.exports='<form name="carouselCardResponse">\n  <div class="image-thumb" ng-show="vm.isShowThumb">\n    <div class="wrap-loader" ng-hide="vm.imageUrl">\n      <div layout="row" layout-sm="column" layout-align="space-around">\n        <md-progress-circular\n            md-mode="indeterminate"\n            md-diameter="40">\n        </md-progress-circular>\n      </div>\n    </div>\n    <div class="image-thumb-vertical">\n      <div><img ng-src="{{ vm.imageUrl }}" alt="" ng-show="vm.imageUrl"/></div>\n    </div>\n  </div>\n  <div class="input-group solid-input first">\n    <input ng-model="vm.content.items[0].image.url"\n           completer="vm.textcompleteOptions"\n           type="text"\n           class="form-control"\n           placeholder="Enter image URL..."\n           ng-blur="vm.imageUrlChanged()"\n           maxlength="{{vm.limitsManager.getTextLength(\'url\', false)}}">\n  </div>\n  <div class="input-group solid-input">\n    <input name="title"\n           ng-model="vm.content.items[0].title"\n           completer="vm.textcompleteOptions"\n           type="text"\n           class="form-control"\n           ng-class="{\'has-error\':(vm.saveTouched || carouselCardResponse.title.$touched) && carouselCardResponse.title.$invalid}"\n           placeholder="Enter title (required)..." required>\n  </div>\n  <div class="input-group solid-input">\n    <textarea class="borderless form-control"\n              msd-elastic\n              ng-model="vm.content.items[0].description"\n              placeholder="Enter description..."\n              completer="vm.textcompleteOptions"\n    ></textarea>\n  </div>\n  <div class="input-group solid-input">\n    <input name="key"\n           ng-model="vm.content.items[0].optionInfo.key"\n           completer="vm.textcompleteOptions"\n           type="text"\n           class="form-control"\n           ng-class="{\'has-error\':(vm.saveTouched || carouselCardResponse.key.$touched) && carouselCardResponse.key.$invalid}"\n           placeholder="Enter option key (required)..."\n           required\n    >\n  </div>\n  <div class="input-group solid-input">\n    <md-chips ng-model="vm.content.items[0].optionInfo.synonyms"\n              class="md-chips"\n              placeholder="Add option synonym.."\n              md-separator-keys="vm.separatorKeys"\n              md-add-on-blur="true">\n    </md-chips>\n  </div>\n</form>'},function(e,t){e.exports='<form name="chatBubbleResponse">\n  <div class="chat-bubble">\n    <div layout="row" class="bubble-row" ng-repeat="item in vm.content.items track by $index">\n      <div class="bubble-cell numeric-cell"> {{$index + 1}}</div>\n      <div class="bubble-cell input-cell">\n            <textarea name="item_text{{$index * 2}}"\n                      class="borderless"\n                      ng-class="{\'has-error\': (vm.saveTouched || chatBubbleResponse.item_text{{$index * 2}}.$touched)\n                                  && chatBubbleResponse.item_text{{$index * 2}}.$invalid}"\n                      msd-elastic\n                      ng-model="item.displayText"\n                      placeholder="{{vm.audioCustomMode() ? \'Enter text output...\' : \'Enter text and speech output...\'}}"\n                      completer="vm.textcompleteOptions"\n                      leave-enter="true"\n                      ng-required="!vm.audioCustomMode()"\n            ></textarea>\n      </div>\n      <div class="bubble-cell input-cell secondary" ng-if="vm.audioCustomMode()">\n        <div id="{{($index * 2) + 1}}"\n             name="item_speech_{{($index * 2) + 1}}"\n             tabindex="-1"\n             ng-model="item.textToSpeech"\n             ui-ace="{\n                showGutter: false,\n                useWrapMode: true,\n                mode: \'xml\',\n                theme:\'clouds\',\n                onLoad: vm.aceLoaded}"></div>\n      </div>\n      <div class="bubble-cell action-cell">\n        <a ng-click="vm.removePrompt($index)" class="visible-on-hover"><span\n            class="flaticon stroke trash"></span></a>\n      </div>\n    </div>\n    <div layout="row" class="ng-hide bubble-row" ng-hide="!vm.blankInputVisible()">\n      <div class="bubble-cell numeric-cell">{{vm.content.items.length + 1}}</div>\n      <div class="bubble-cell input-cell">\n            <textarea id="{{(vm.content.items.length * 2) + 1}}"\n                      name="empty_text"\n                      class="borderless"\n                      ng-model="vm.newItem.displayText"\n                      ng-focus="vm.blankInputOnFocus($event)"\n                      placeholder="{{vm.audioCustomMode() ? \'Enter text output...\' : \'Enter text and speech output...\'}}"\n            ></textarea>\n      </div>\n      <div class="bubble-cell input-cell secondary" ng-if="vm.audioCustomMode()">\n            <textarea id="{{(vm.content.items.length * 2) + 2}}"\n                      name="empty_speech"\n                      class="borderless empty_speech"\n                      ng-focus="vm.blankInputOnFocus($event)"\n                      ng-model="vm.newItem.textToSpeech"\n                      placeholder="Enter speech output..."\n            ></textarea>\n      </div>\n      <div class="action-cell locked"></div>\n    </div>\n  </div>\n</form>'},function(e,t){e.exports='<form name="linkOutChipResponse">\n  <div class="input-group solid-input">\n    <input name="name"\n           ng-model="vm.content.destinationName"\n           completer="vm.textcompleteOptions"\n           type="text"\n           class="form-control"\n           ng-class="{\'has-error\':(vm.saveTouched || linkOutChipResponse.name.$touched) && linkOutChipResponse.name.$invalid}"\n           placeholder="Enter destination name (required)..."\n           required>\n  </div>\n  <div class="input-group solid-input">\n    <input name="url"\n           ng-model="vm.content.url"\n           completer="vm.textcompleteOptions"\n           type="text"\n           class="form-control"\n           ng-class="{\'has-error\':(vm.saveTouched || linkOutChipResponse.url.$touched) && linkOutChipResponse.url.$invalid}"\n           placeholder="Enter URL (required)..."\n           maxlength="{{vm.limitsManager.getTextLength(\'url\', false)}}"\n           required>\n  </div>\n</form>'},function(e,t){e.exports='<form name="listCardResponse">\n  <div class="input-group solid-input first">\n    <input ng-model="vm.content.title"\n           completer="vm.textcompleteOptions"\n           type="text"\n           class="form-control"\n           placeholder="Enter list title...">\n  </div>\n  <div class="input-group solid-input solid-input__roll"\n       ng-repeat="item in vm.content.items track by $index">\n\n    <a class="solid-input__toggle small visible-on-hover" ng-click="vm.removeItem($index)">\n      <span class="flaticon stroke trash"></span>\n    </a>\n\n    <input ng-model="item.image.url"\n           completer="vm.textcompleteOptions"\n           type="text"\n           class="form-control solid-input__title small"\n           placeholder="Enter item image URL..."\n           maxlength="{{vm.limitsManager.getTextLength(\'url\', false)}}">\n\n    <div class="input-group solid-input">\n      <input name="title_{{$index}}"\n             ng-model="item.title"\n             completer="vm.textcompleteOptions"\n             type="text"\n             class="form-control"\n             ng-class="{\'has-error\':(vm.saveTouched || listCardResponse.title_{{$index}}.$touched) && listCardResponse.title_{{$index}}.$invalid}"\n             placeholder="Enter item title (required)..."\n             required>\n    </div>\n\n    <div class="input-group solid-input">\n      <textarea class="borderless form-control"\n                msd-elastic\n                ng-model="item.description"\n                placeholder="Enter item description..."\n                completer="vm.textcompleteOptions"\n      ></textarea>\n    </div>\n\n    <div class="input-group solid-input">\n      <input name="key_{{$index}}"\n             ng-model="item.optionInfo.key"\n             completer="vm.textcompleteOptions"\n             type="text"\n             class="form-control"\n             ng-class="{\'has-error\':(vm.saveTouched || listCardResponse.key_{{$index}}.$touched) && listCardResponse.key_{{$index}}.$invalid}"\n             placeholder="Enter option key (required)..."\n             required>\n    </div>\n\n    <div class="input-group solid-input">\n      <md-chips ng-model="item.optionInfo.synonyms"\n                class="md-chips"\n                placeholder="Add option synonym.."\n                md-separator-keys="vm.separatorKeys"\n                md-add-on-blur="true">\n      </md-chips>\n    </div>\n\n  </div>\n\n  <div class="button" ng-click="vm.addItem()" ng-if="vm.newItemEnabled">Add item</div>\n\n</form>'},function(e,t){e.exports='<form name="suggestionChipsResponse">\n  <div class="input-group solid-input"\n       ng-repeat="suggestion in vm.content.suggestions track by $index">\n\n    <a class="solid-input__toggle small visible-on-hover" ng-click="vm.removeItem($index)">\n      <span class="flaticon stroke trash"></span>\n    </a>\n\n    <input name="title_{{$index}}"\n           ng-model="suggestion.title"\n           completer="vm.textcompleteOptions"\n           type="text"\n           class="form-control"\n           ng-class="{\'has-error\':(vm.saveTouched || suggestionChipsResponse.title_{{$index}}.$touched) && suggestionChipsResponse.title_{{$index}}.$invalid}"\n           placeholder="Enter chip text (required)..."\n           maxlength="{{vm.limitsManager.getTextLength(\'GASuggestion\', false)}}"\n           ng-keydown="vm.keyDown($event, $index);"\n           focus-on="$index === vm.focusIndex"\n           required\n    >\n  </div>\n  <div class="button" ng-click="vm.addItem()" ng-if="vm.newSuggestionEnabled">Add item</div>\n</form>'},function(e,t){e.exports='<div class="image-thumb" ng-show="vm.isShowThumb">\n\t<div class="wrap-loader" ng-hide="vm.imageUrl">\n        <div layout="row" layout-sm="column" layout-align="space-around">\n            <md-progress-circular\n                    md-mode="indeterminate"\n                    md-diameter="40">\n            </md-progress-circular>\n        </div>\n    </div>\n\t<div class="image-thumb-vertical">\n\t\t<div><img ng-src="{{ vm.imageUrl }}" alt="" ng-show="vm.imageUrl" /></div>\n\t</div>\n</div>\n<div class="input-group solid-input first">\n\t<input ng-model="vm.content.imageUrl"\n         completer="vm.textcompleteOptions"\n         type="text" class="form-control"\n         placeholder="Enter image URL"\n         ng-blur="vm.imageUrlChanged()"\n         maxlength="{{vm.limitsManager.getTextLength(\'url\', false)}}">\n</div>'},function(e,t){e.exports='<div class="input-group solid-input first">\n\t<input ng-model="vm.content.title"\n\t\t\t\t completer="vm.textcompleteOptions"\n\t\t\t\t type="text"\n\t\t\t\t class="form-control"\n\t\t\t\t placeholder="Title">\n</div>\n<div class="input-group solid-input solid-input__replie" ng-repeat="reply in vm.content.replies track by $index">\n\t<input ng-model="vm.content.replies[$index]"\n\t\t   completer="vm.textcompleteOptions"\n\t\t   type="text"\n\t\t   class="form-control"\n\t\t   placeholder="Enter up to {{vm.limitsManager.getTextLength(\'quickReply\', false)}} characters"\n\t\t   maxlength="{{vm.limitsManager.getTextLength(\'quickReply\', false)}}"\n\t\t   ng-keydown="vm.keyDown($event, reply, $index);"\n\t\t   focus-on="$index === vm.focusIndex">\n</div>'},function(e,t){e.exports='<intent-text-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.MESSAGE"\n></intent-text-response>\n<intent-card-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.CARD"\n></intent-card-response>\n<intent-quick-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.QUICK_REPLY"\n></intent-quick-response>\n<intent-image-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.IMAGE"\n></intent-image-response>\n<intent-custom-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.CUSTOM_PAYLOAD"\n></intent-custom-response>\n<intent-basic-card-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      save-touched="vm.saveTouched"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.BASIC_CARD"\n></intent-basic-card-response>\n<intent-list-card-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      save-touched="vm.saveTouched"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.LIST_CARD"\n></intent-list-card-response>\n<intent-suggestion-chips-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      save-touched="vm.saveTouched"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.SUGGESTION_CHIPS"\n></intent-suggestion-chips-response>\n<intent-chat-bubble-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      save-touched="vm.saveTouched"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.CHAT_BUBBLE"\n></intent-chat-bubble-response>\n<intent-carousel-card-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      save-touched="vm.saveTouched"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.CAROUSEL_CARD"\n></intent-carousel-card-response>\n<intent-link-out-chip-response intent="vm.intent"\n                      content="vm.content"\n                      textcomplete-options="vm.textcompleteOptions"\n                      save-touched="vm.saveTouched"\n                      ng-if="vm.getResponseType(vm.content.type) === vm.responseType.LINK_OUT_CHIP"\n></intent-link-out-chip-response>\n\n'},function(e,t){e.exports='<div class="sti-multiple-input">\n  <div class="params-modal-prompts">\n    <div class="input-group" sti-intent-param-prompts-editor\n         textcomplete-options="vm.textcompleteOptions"\n         collection="vm.content.speech"\n         collection-item-name="\'text response\'"\n         max-items-count="vm.limitsManager.getTextResponsesNumber()"\n         max-text-length="vm.limitsManager.getTextLength(\'textResponse\')"\n    ></div>\n  </div>\n</div>'},function(e,t){e.exports='<div class="rich_response">\n\n  <div class="tab-control rich_response__tab-control">\n    <ul class="wrap">\n      <li ng-class="{active: vm.activePlatforms.indexOf(vm.platformChosen)==$index}"\n          ng-repeat="platform in vm.activePlatforms track by $index">\n        <a href="javascript:void(0)" ng-click="vm.onPlatformChoosen(platform)">\n          {{platform.title}}\n        </a>\n      </li>\n      <md-menu ng-hide="!vm.platforms.length">\n        <span id="add-platform" ng-click="$mdMenu.open()" class="flaticon stroke plus"></span>\n        <md-menu-content width="3">\n          <md-menu-item ng-repeat="platform in vm.platforms track by $index">\n            <md-button ng-click="vm.addPlatform(platform, $index)">\n              {{ platform.title }}\n            </md-button>\n          </md-menu-item>\n        </md-menu-content>\n      </md-menu>\n    </ul>\n  </div>\n\n  <div layout="row" class="alert alert-general-light alert-dismissible b_static_info"\n       role="alert" ng-if="vm.platformChosen !== vm.platform.DEFAULT">\n    <span class="flaticon stroke info-2 alert-icon"></span>\n    <div flex>\n      <div class="info">\n        <p>Response from this tab will be sent to the {{vm.platformChosen.title}} integration.</p>\n      </div>\n      <div layout="row" layout-align="end center">\n        <div layout="row" layout-align="start center" flex>\n          <p>Use response from the DEFAULT tab as the first response.</p>\n        </div>\n        <md-switch class="md-primary" ng-model="vm.defaultResponseEnabled"\n                   ng-change="vm.defaultResponsePlatforms.setEnabled(vm.platformChosen, vm.defaultResponseEnabled)"></md-switch>\n      </div>\n    </div>\n  </div>\n\n  <div class="rich_response__message">\n\n    <div class="rich_response__contents clearfix"\n         ng-show="vm.filteredContents.length"\n         ui-sortable="vm.sortableConfig"\n         ng-model="vm.filteredContents">\n\n      <div class="rich_response__content"\n           ng-repeat="content in vm.filteredContents track by $index"\n           ng-class="\'type_\' + vm.getResponseType(content.type).type">\n        <md-card>\n          <md-card-header class="drag-handle">\n            <md-card-title-text flex layout="row" layout-align="start center">\n              <span>{{ vm.getResponseType(content.type).text }}</span>\n            </md-card-title-text>\n            <md-card-actions layout="row" layout-align="start center">\n              <md-button ng-if="vm.getResponseType(content.type) === vm.responseType.CHAT_BUBBLE"\n                         ng-class="{\'active\': content.customizeAudio}"\n                         ng-click="content.customizeAudio = !content.customizeAudio">Customize audio\n                output\n              </md-button>\n              <md-card-icon-actions>\n                <div class="rich_response__content__helps">\n                  \x3c!-- text --\x3e\n                  <span class="flaticon stroke question-mark-2 icon" ng-if="content.type === 0">\n                                      <md-tooltip md-direction="top" md-delay="100">Use Shift+Enter for a new line. Supported for Facebook Messenger, Kik, Slack, Skype and Telegram integrations.</md-tooltip>\n                                  </span>\n                  \x3c!-- card --\x3e\n                  <span class="flaticon stroke question-mark-2 icon" ng-if="content.type === 1">\n                                      <md-tooltip md-direction="top" md-delay="100">A card may consist of several elements: image, title, subtitle, clickable button. Depending on a platform, some elements are mandatory. In Facebook Messenger, multiple cards are displayed as a horizontal scrollable carousel.</md-tooltip>\n                                  </span>\n                  \x3c!-- quick --\x3e\n                  <span class="flaticon stroke question-mark-2 icon" ng-if="content.type === 2">\n                                      <md-tooltip md-direction="top" md-delay="100">Suggested user responses. When a quick reply is tapped, the text is sent back to the agent as a user query. Title is required for Facebook Messenger, Kik, Skype and Telegram integrations.</md-tooltip>\n                                  </span>\n                  \x3c!-- image --\x3e\n                  <span class="flaticon stroke question-mark-2 icon" ng-if="content.type === 3">\n                                      <md-tooltip md-direction="top" md-delay="100">Consult respective Facebook Messenger, Kik, Slack, Skype and Telegram documentation for supported formats and file sizes.</md-tooltip>\n                                  </span>\n                  \x3c!-- custom --\x3e\n                  <span class="flaticon stroke question-mark-2 icon" ng-if="content.type === 4">\n                                      <md-tooltip md-direction="top" md-delay="100">Supported for Facebook Messenger, Kik, Slack, Skype and Telegram one-click integrations. For other platforms, it can be handled in custom integrations.</md-tooltip>\n                                  </span>\n                  \x3c!-- basic card, list card --\x3e\n                  <span class="flaticon stroke question-mark-2 icon"\n                        ng-if="[5,6,7,8,9,10].indexOf(vm.getResponseType(content.type).type) > -1">\n                                      <md-tooltip md-direction="top" md-delay="100">Supported for Google Actions one-click integration.</md-tooltip>\n                                  </span>\n                </div>\n                <md-button class="md-icon-button rich_response__content__remove"\n                           aria-label="trash"\n                           ng-click="vm.removeContent($index)">\n                  <span class="flaticon stroke trash icon"></span>\n                </md-button>\n              </md-card-icon-actions>\n            </md-card-actions>\n          </md-card-header>\n\n          <md-card-content>\n            <intent-response-content\n                intent="vm.intent"\n                content="content"\n                textcomplete-options="vm.textcompleteOptions"\n                save-touched="vm.saveTouched"></intent-response-content>\n          </md-card-content>\n        </md-card>\n      </div>\n\n    </div>\n\n    <md-menu ng-show="vm.isShowMenu()">\n      <div aria-label="Add message content"\n           class="md-button rich_response__add_content"\n           ng-click="$mdMenu.open()">\n        Add message content\n      </div>\n      <md-menu-content width="4">\n        <md-menu-item ng-repeat="item in vm.contentListText" ng-if="vm.isShowItem(item)">\n          <md-button name="add-card"\n                     ng-click="vm.addContent(item)"\n                     ng-disabled="!vm.checkPossibilityAdding(item)">\n            {{ item.text }}\n          </md-button>\n        </md-menu-item>\n      </md-menu-content>\n    </md-menu>\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="comment-box">\n    <div class="head" ng-click="vm.webhookShown = !vm.webhookShown">\n        <span class="title">Fulfillment</span>\n        <i class="fa fa-angle-down pull-right intent-show-hide" aria-hidden="true" ng-if="!vm.webhookShown"></i>\n        <i class="fa fa-angle-up pull-right intent-show-hide" aria-hidden="true" ng-if="vm.webhookShown"></i>\n    </div>\n    <div layout="row" class="animate-show" ng-show="vm.webhookShown">\n        <md-checkbox ng-model="vm.webhookUsed" ng-change="vm.onChangeWebhookUsed()" class="md-primary">Use webhook</md-checkbox>\n        <md-checkbox ng-disabled="!vm.webhookUsed" ng-model="vm.webhookForSlotFilling" class="md-primary">Use webhook for slot-filling</md-checkbox>\n    </div>\n</div>'},function(e,t){e.exports='<div class="list-group-item"\n     ng-init="isIcoShown=false" ng-mouseover="isIcoShown=true" ng-mouseleave="isIcoShown=false"\n     ng-class="{\'ignore-intent-list-group-item\': vm.intent.fallbackIntent, \'follow-up-intent\': vm.isFollowUpIntent}"\n>\n  <div ng-if="!vm.intent.fallbackIntent">\n    <md-checkbox ng-click="vm.switchBatchCb(true)" ng-if="!vm.isAgentReadOnly && (vm.isBatch || (isIcoShown && !vm.isFollowUpIntent))" aria-label="mark for batch operation" class="list-batch md-primary"  ng-model="vm.batchSelected[vm.intent.id]"></md-checkbox>\n    <i ng-if="vm.isAgentReadOnly || (!vm.isBatch && !(isIcoShown && !vm.isFollowUpIntent))" class="i-priority-color-mark priority-{{vm.intent.priority}}" ng-hide="vm.simple">\n      <md-tooltip md-direction="top" md-delay="100">\n        {{vm.getPriorityLabel()}} priority\n      </md-tooltip>\n    </i>\n    <i ng-if="" class="i-priority-color-mark-ignore-intent fa fa-bookmark-o priority-{{vm.intent.priority}}" ng-hide="vm.simple"></i>\n\n    <span ng-click="vm.goSref(\'auth.workPlace.agent.intent_edit\', { agentId:vm.agentId, intentId:vm.intent.id });"\n          class="intent-name"\n          ng-style="vm.intentNameStyle">\n      <span class="sub-icon ico-item" ng-hide="vm.simple">\n        <span class="temporary-icon sub-right"></span>\n      </span>\n      <span class="link-intent-edit">\n        <span>{{vm.fullnameIntent}}</span>\n      </span>\n      <md-button class="md-icon-button exist-follow-up ico-item ng-hide"\n                 ng-click="vm.isShownFollowUpIntents = !vm.isShownFollowUpIntents;  $event.stopPropagation();"\n                 ng-show="vm.isExistFollowUpIntents"\n                 aria-label="Expand follow-up intents"\n      >\n        <i class="fa fa-angle-down" aria-hidden="true" ng-if="!vm.isShownFollowUpIntents"></i>\n        <i class="fa fa-angle-up" aria-hidden="true" ng-if="vm.isShownFollowUpIntents"></i>\n      </md-button>\n    </span>\n\n    <div class="ico-group" ng-show="isIcoShown">\n      <md-menu md-position-mode="target-right target" ng-hide="vm.simple || vm.disableFollowup || vm.isAgentReadOnly">\n        <span ng-click="$mdMenu.open($event)">Add follow-up intent</span>\n        <md-menu-content class="scrollbar-forced" width="3">\n          <md-menu-item ng-repeat="intent in vm.listFollowUpIntents track by $index">\n            <md-button ng-click="vm.createFollowUpIntent(intent)">\n              {{ intent.name }}\n            </md-button>\n          </md-menu-item>\n        </md-menu-content>\n      </md-menu>\n      <a class="ico-item" ng-hide="vm.simple">\n        <span class="flaticon stroke cloud-download" ng-click="vm.goDownloadIntent(\'json\')"></span>\n      </a>\n\n      <a class="ico-item" ng-click="vm.deleteIntent()" ng-hide="vm.isAgentReadOnly">\n        <span class="flaticon stroke trash"></span>\n      </a>\n    </div>\n  </div>\n\n  <div ng-if="vm.intent.fallbackIntent">\n    <md-checkbox ng-click="vm.switchBatchCb(true)" aria-label="mark for batch operation" class="list-batch md-primary" ng-if="!vm.isAgentReadOnly && (vm.isBatch || (isIcoShown && !vm.isFollowUpIntent))" aria ng-model="vm.batchSelected[vm.intent.id]"></md-checkbox>\n    <i ng-show="vm.isAgentReadOnly || (!vm.isBatch && !(isIcoShown && !vm.isFollowUpIntent))" class="i-priority-color-mark-ignore-intent fa fa-bookmark-o priority-{{vm.intent.priority}}"></i>\n\n    <span ng-click="vm.goSref(\'auth.workPlace.agent.intent_edit\', { agentId:vm.agentId, intentId:vm.intent.id });"\n          class="intent-name"\n          ng-style="vm.intentNameStyle">\n      <span class="sub-icon ico-item" ng-hide="vm.simple">\n        <span class="temporary-icon sub-right"></span>\n      </span>\n      <span class="link-intent-edit">\n        <span>\n          {{vm.fullnameIntent}}\n          <span  ng-if="vm.intent.contextIn.length">\n          &nbsp;&nbsp;&nbsp;&nbsp;Contexts: <span ng-repeat="context in vm.intent.contextIn track by $index" ><span ng-bind="context"></span><span ng-if="!$last">, </span></span>\n          </span>\n        </span>\n      </span>\n      <md-button class="md-icon-button exist-follow-up ico-item ng-hide"\n                 ng-click="vm.isShownFollowUpIntents = !vm.isShownFollowUpIntents;  $event.stopPropagation();"\n                 ng-show="vm.isExistFollowUpIntents"\n                 aria-label="Expand follow-up intents"\n      >\n        <i class="fa fa-angle-down" aria-hidden="true" ng-if="!vm.isShownFollowUpIntents"></i>\n        <i class="fa fa-angle-up" aria-hidden="true" ng-if="vm.isShownFollowUpIntents"></i>\n      </md-button>\n    </span>\n\n    <div class="ico-group" ng-show="isIcoShown">\n      <md-menu md-position-mode="target-right target" ng-hide="vm.simple || vm.disableFollowup || vm.isAgentReadOnly || vm.listFollowUpIntents.length === 0">\n        <span ng-click="$mdMenu.open($event)">Add follow-up intent</span>\n        <md-menu-content width="3">\n          <md-menu-item ng-repeat="intent in vm.listFollowUpIntents track by $index">\n            <md-button ng-click="vm.createFollowUpIntent(intent)">\n              {{ intent.name }}\n            </md-button>\n          </md-menu-item>\n        </md-menu-content>\n      </md-menu>\n      <a class="ico-item">\n        <span class="flaticon stroke cloud-download" ng-click="vm.goDownloadIntent(\'json\')"></span>\n      </a>\n      <a class="ico-item" ng-click="vm.deleteIntent()" ng-hide="vm.isAgentReadOnly">\n        <span class="flaticon stroke trash"></span>\n      </a>\n    </div>\n  </div>\n</div>\n<ul class="list-group follow-up-intents ng-hide" ng-show="vm.isExistFollowUpIntents && vm.isShownFollowUpIntents">\n  <li ng-repeat="followUpIntent in vm.intent.followUpIntents">\n    <intents-list-item intent="followUpIntent"\n                       list-follow-up-intents="vm.listFollowUpIntents"\n                       layer="vm.layer + 1"\n                       parent-name="vm.fullnameIntent"\n                       refresh-intents-cb="vm.refreshIntentsCb"\n                       path-expand-intents="vm.pathExpandIntents"\n    ></intents-list-item>\n  </li>\n</ul>'},function(e,t){e.exports='<md-dialog-content>\n  <div class="md-dialog-content" layout="row" layout-align="center center" ng-if="vm.viewState.isLoading">\n    <div layout="row" layout-align="center center">\n      <md-progress-circular  md-mode=\'indeterminate\' md-diameter="40"></md-progress-circular>\n    </div>\n  </div>\n\n  <div class="md-dialog-content" ng-if="!vm.viewState.isLoading">\n    <h1>Insufficient permissions</h1>\n    <p>To continue please log in with your Google account.</p>\n  </div>\n</md-dialog-content>\n<md-dialog-actions ng-if="!vm.viewState.isLoading">\n  <md-button ng-click="vm.cancelDialog()">Cancel</md-button>\n  <div flex></div>\n  <md-button ng-click="vm.authorizeGCP()">Authorize</md-button>\n</md-dialog-actions>\n'},function(e,t){e.exports='<md-toolbar class="md-accent">\n  <div class="md-toolbar-tools">\n    <h2><span ng-bind="::(vm.batchOperation.charAt(0).toUpperCase() + vm.batchOperation.slice(1))"></span> <span ng-bind="::vm.getLiteral()"></span></h2>\n  </div>\n</md-toolbar>\n\n<md-dialog-content ng-if="!vm.success">\n  <div class="md-dialog-content" ng-if="vm.batchOperationIds.length && vm.agentList.length">\n\n    <p>You are about to {{::vm.batchOperation}} <strong>{{::vm.batchOperationIds.length}}</strong> {{::vm.getLiteral()}} into another agent. Please select the destination agent.</p>\n    <div layout="row">\n      <md-input-container flex>\n        <label>Destination agent</label>\n        <md-select ng-model="vm.selectedAgentId">\n          <md-option ng-repeat="agent in vm.agentList" ng-value="agent.id">\n            {{::agent.name}} [{{::agent.language}}]\n          </md-option>\n        </md-select>\n      </md-input-container>\n    </div>\n    <md-input-container class="md-block">\n      <md-checkbox class="md-primary" ng-model="vm.additionalParams.copyEntities" aria-label="Copy related entities">Copy related entities</md-checkbox>\n    </md-input-container>\n    <md-input-container class="md-block">\n      <md-checkbox class="md-primary" ng-model="vm.additionalParams.overwriteEntities" aria-label="Overwrite entities">Overwrite entities</md-checkbox>\n    </md-input-container>\n    <md-input-container class="md-block">\n      <md-checkbox class="md-primary" ng-model="vm.additionalParams.overwriteIntents" ng-if="vm.subject === \'intent\'" aria-label="Overwrite intents">Overwrite intents</md-checkbox>\n    </md-input-container>\n\n  </div>\n  <div class="md-dialog-content" ng-if="vm.batchOperationIds.length && !vm.agentList.length">\n    <p>It looks like you does not have other agents to move or copy {{::vm.getLiteral()}} there</p>\n  </div>\n  <div class="md-dialog-content" ng-if="!vm.batchOperationIds.length">\n    <p>Please, select some {{::vm.getLiteral()}} before proceed</p>\n  </div>\n</md-dialog-content>\n\n\n<md-dialog-content ng-if="vm.success">\n  <div class="md-dialog-content">\n    <p>You\'re good to go!</p>\n  </div>\n</md-dialog-content>\n<md-dialog-actions ng-if="!vm.isLoading">\n  <md-button ng-click="vm.closeDialog()" ng-if="!vm.success">Cancel</md-button>\n  <md-button ng-click="vm.goToAgent()" ng-if="vm.success">Proceed to agent</md-button>\n  <div flex></div>\n  <md-button\n      ng-if="!vm.success"\n      ng-click="vm.perform()"\n      ng-disabled="!vm.batchOperationIds.length || !vm.agentList.length || !vm.selectedAgentId"\n  >Start</md-button>\n  <md-button ng-if="vm.success" ng-click="vm.closeDialog()" >Done</md-button>\n</md-dialog-actions>\n<md-dialog-actions ng-if="vm.isLoading">\n  <md-progress-linear md-mode="indeterminate"></md-progress-linear>\n</md-dialog-actions>'},function(e,t){e.exports='<div class="jsoneditor__container" ng-show="vm.jsoneditorLoaded"></div>\n<div class="jsoneditor__preloader" ng-hide="vm.jsoneditorLoaded">\n    <md-dialog-loader>\n        <div layout="row" layout-sm="column" layout-align="center center">\n            <md-progress-circular\n                    md-mode="indeterminate"\n                    md-diameter="40">\n            </md-progress-circular>\n        </div>\n    </md-dialog-loader>\n</div>'},function(e,t){e.exports='<div ng-if="!vm.viewState.started">\n  <div layout="row" layout-align="center center">\n    <h4>Already have non-Google Dialogflow account?</h4>\n  </div>\n  <div layout="row" layout-align="center center">\n    <md-button flex class="md-raised" ng-click="vm.start()">Restore access</md-button>\n  </div>\n</div>\n\n<div ng-if="vm.viewState.finished">\n  <div layout="row" layout-align="center center">\n      <h4>Success!</h4>\n  </div>\n  <p>You successfully link your Google account to Dialogflow, please, use "Sign in with Google" button on the left to sign in.</p>\n</div>\n\n\n<div ng-if="!vm.viewState.finished && vm.viewState.started && vm.token && !vm.isLoading()">\n  <h4 layout-align="center center">Connect Google account</h4>\n  <p>Your Google account will be linked to <strong ng-bind="vm.currentUser"></strong> Dialogflow account.</p>\n  <p ng-if="vm.agentNames.length">Your agents are\n    <span ng-repeat="agentName in vm.agentNames">\n      <strong ng-bind="agentName"></strong><span ng-if="!$last">,</span>\n    </span>\n  </p>\n  <p ng-if="!vm.agentNames.length">There is no agents in your account</p>\n\n  <p>Please make sure this is correct account as linking operation is irreversible</p>\n\n\n  <div layout="row">\n    \x3c!--md-button\n        flex\n        class="md-raised md-btn-login md-btn-google" ng-click="vm.connect()">\n      <img src="/api-client/assets/img/new-google-favicon-128.png"  />\n      Sign in with Google\n    </md-button--\x3e\n\n    <md-button\n        flex\n        class="md-raised md-primary md-btn-login md-btn-google" ng-click="vm.connect()">\n      <div class="md-btn-login-image-wrapper"><img src="/api-client/assets/img/new-google-favicon-128.png"  /></div>\n      <div class="md-btn-login-text-wrapper">Sign in with Google</div>\n    </md-button>\n\n  </div>\n  <div layout="row">\n    <md-button flex ng-click="vm.clear()">Switch account</md-button>\n  </div>\n\n</div>\n\n\n<div ng-if="!vm.viewState.finished && vm.viewState.started && !vm.token && !vm.isLoading()">\n\n  <h4>Restore access</h4>\n  <h5 ng-if="vm.viewState.isAnyNetworkPresent && vm.viewState.isPasswordEnabled">\n    Sign in with your Dialogflow or social account\n  </h5>\n  <h5 ng-if="vm.viewState.isAnyNetworkPresent && !vm.viewState.isPasswordEnabled">\n    Sign in with your social account\n  </h5>\n  <h5 ng-if="!vm.viewState.isAnyNetworkPresent && vm.viewState.isPasswordEnabled">\n    Sign in with your Dialogflow account\n  </h5>\n\n  <form name="form" role="form" class="signin-form" ng-submit="vm.passwordLogin(username, password)">\n    <fieldset ng-show="vm.viewState.isPasswordEnabled">\n      <div layout="row">\n        <div flex="100">\n          <md-input-container class="md-block">\n            <label>Email</label>\n            <input ng-model="username" type="email" name="username" id="username" ng-required="true">\n            <div ng-messages="form.username.$error" role="alert" ng-show="form.username.$touched || buttonTouch">\n              <div ng-message-exp="[\'required\']">\n                Email address is required\n              </div>\n              <div ng-message-exp="[\'email\']">\n                Email address is incorrect\n              </div>\n            </div>\n          </md-input-container>\n        </div>\n      </div>\n      <div layout="row">\n        <div flex="100">\n          <md-input-container class="md-block">\n            <label>Password</label>\n            <input ng-model="password" type="password" name="password" id="password" ng-required="true">\n            <a ui-sref="authless.forgotPassword">I forgot password</a>\n            <div ng-messages="form.password.$error" role="alert" ng-show="form.password.$touched || buttonTouch">\n              <div ng-message-exp="[\'required\']">\n                Password is required\n              </div>\n            </div>\n          </md-input-container>\n        </div>\n      </div>\n    </fieldset>\n\n\n  <fieldset>\n\n    <md-button type="submit" class="md-raised md-btn-login" ng-disabled="form.$invalid" layout="center" ng-show="vm.viewState.isPasswordEnabled">\n      <i class="icon fa-lg fa"></i>\n      Sign in with password\n    </md-button>\n\n    <md-button class="md-raised md-btn-login"  ng-click="vm.oauthLogin(\'facebook\')" ng-if="vm.isNetworkPresent(\'facebook\')">\n      <i class="icon fa-lg fa fa-facebook"></i>\n      Sign in with Facebook\n    </md-button>\n\n    <md-button class="md-raised md-btn-login" ng-click="vm.oauthLogin(\'slack\')" ng-if="vm.isNetworkPresent(\'slack\')">\n      <i class="icon fa-lg fa fa-slack"></i>\n      Sign in with Slack\n    </md-button>\n\n    <md-button class="md-raised md-btn-login" ng-click="vm.oauthLogin(\'github\')" ng-if="vm.isNetworkPresent(\'github\')">\n      <i class="icon fa-lg fa fa-github"></i>\n      Sign in with GitHub\n    </md-button>\n\n  </fieldset>\n\n  </form>\n</div>\n\n<div ng-if="vm.isLoading()">\n  <br/><br/>\n  <div layout="row" layout-align="center center">\n    <md-progress-circular  md-mode=\'indeterminate\' md-diameter="40"></md-progress-circular>\n  </div>\n  <br/>\n  <div layout="row" layout-align="center center">\n    <span>Restoring access...</span>\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="alert alert-general-light alert-dismissible animate-show b_static_info" role="alert" >\n    <span class="flaticon stroke info-2 alert-icon"></span>\n    <div class="frame"><p ng-bind-html="vm.message"></p></div>\n</div>'},function(e,t){e.exports='<div class="md-toolbar-tools" style="background-color:{{vm.notice.backgroundColor}};">\n\n  <md-button class="md-icon-button" aria-label="Settings" ng-disabled="true" style="color:{{vm.notice.textColor}};">\n    <span class="flaticon stroke info-2 alert-icon"></span>\n  </md-button>\n\n  <p flex style="color:{{vm.notice.textColor}}; font-size: {{vm.notice.fontSize}}; " ng-bind-html="vm.getTrustHTML()"></p>\n\n  <md-button class="md-raised" ng-click="vm.dismiss()">Dismiss</md-button>\n\n</div>\n'},function(e,t){e.exports='<md-toolbar>\n    <custom-toolbar-notice ng-repeat="notice in vm.notifications" ng-show="notice.wasShown !== true" notice="notice"></custom-toolbar-notice>\n</md-toolbar>\n'},function(e,t){e.exports='<md-toolbar class="md-accent">\n  <div class="md-toolbar-tools">\n    <h2>Updated Firebase Terms</h2>\n  </div>\n</md-toolbar>\n<md-dialog-content ng-if="!vm.success">\n  <div class="md-dialog-content">\n      <strong>By proceeding and clicking the button below</strong>, you agree that you are using Firebase services in your app and agree to the updated <a target="_blank" href="https://firebase.google.com/terms?hl=en">terms</a>.\n  </div>\n</md-dialog-content>\n<md-dialog-actions>\n  <div flex></div>\n  <md-button class="md-primary"\n      ng-click="vm.acceptTos()"\n  >Accept</md-button>\n</md-dialog-actions>'},function(e,t){e.exports='<div class="side-row" ng-show="vm.showFirebaseBillingWarning && vm.cloudFunctionsEnabled">\n    <div>\n        <span class="item-header">FULFILLMENT</span>\n    </div>\n    <div class="table-box fulfillment-table" title="Fulfillment parameters">\n        <table>\n            <tbody>\n                <tr class="test-console-fulfillment-parameters-row">\n                    <td width="150"><span class="test-console-fulfillment-parameters-key">Cloud function</span></td>\n                    <td class="td-test-console-fulfillment-parameter-value td-test-console-fulfillment-parameter-value-failed">failed</td>\n                </tr>\n            </tbody>\n        </table>\n        <div>\n            <span class="text">\n                <span id="test-client-action">\n                      Billing is not configured. External network traffic is not available and quotas are\n                      severely limited.\n                      <a ng-href="{{vm.getFireconsoleBillingLink()}}" target="_blank" >\n                          Configure billing account to remove these restrictions.\n                      </a>\n                  </div>\n\n                </span>\n            </span>\n        </div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="jsoneditor__preloader" ng-hide="vm.componentsInitialized">\n  <md-dialog-loader>\n    <div layout="row" layout-sm="column" layout-align="center center">\n      <md-progress-circular\n          md-mode="indeterminate"\n          md-diameter="40">\n      </md-progress-circular>\n    </div>\n  </md-dialog-loader>\n</div>\n<div class="side-row" title="Response" ng-show="vm.componentsInitialized">\n  <div>\n    <md-select ng-model="vm.responseType"\n               aria-label="response type"\n               class="md-no-underline b_response_select">\n      <md-option ng-repeat="sample in vm.samplesDataItems"\n                 ng-value="sample">\n        <md-icon class="b_integration_icon" id="b_integration_icon_{{sample.iconName}}">\n          <i class="md-fab"></i>\n        </md-icon>\n        {{ sample.text.toUpperCase()}}\n      </md-option>\n    </md-select>\n    <div class="pull-right" style="padding-top: 5px" ng-show="vm.speech && vm.speakControl.ttsEnabled()">\n      <a class="item-link"\n         ng-show="!vm.speakControl.ttsSpeak()"\n         ng-click="vm.speakControl.playSpeech(vm.speech)"\n         ng-disabled="vm.speakControl.ttsWait()">{{ vm.speakControl.ttsWait() ? \'LOADING...\' :\n        \'PLAY\' }}</a>\n      <a class="item-link"\n         ng-show="vm.speakControl.ttsSpeak()"\n         ng-click="vm.speakControl.stopSpeech()">STOP</a>\n    </div>\n  </div>\n  \x3c!-- shown when no text to speak, and summarize not available content.--\x3e\n  <div class="side-row">\n    <div title="Text Response"\n         ng-if="vm.responseForSelectedPlatform.length == 0">\n      <div>\n        <div class="item">\n                <span class="text">\n                    <i>Not available</i>\n                </span>\n        </div>\n      </div>\n    </div>\n\n    <div ng-repeat="content in vm.responseForSelectedPlatform">\n\n      <div title="Text Response"\n           ng-if="(vm.getResponseType(content.type) === vm.responseTypeEnum.MESSAGE || vm.getResponseType(content.type) === vm.responseTypeEnum.CHAT_BUBBLE)\n                  && (content.speech || content.displayText || content.textToSpeech)">\n        <div>\n          <div class="item">\n                <span class="text">\n                    <span>{{content.speech || content.displayText || content.textToSpeech}}</span>\n                </span>\n          </div>\n        </div>\n      </div>\n\n      <div title="Card Response" ng-if="vm.getResponseType(content.type) === vm.responseTypeEnum.CARD">\n        <console-card-response content="content"\n                               send-request="vm.sendRequest"></console-card-response>\n      </div>\n\n      <div title="Quick Reply Response" ng-if="vm.getResponseType(content.type) === vm.responseTypeEnum.QUICK_REPLY">\n        <console-quick-resposne content="content"\n                                send-request="vm.sendRequest"></console-quick-resposne>\n      </div>\n\n      <div class="md-padding" ng-if="vm.getResponseType(content.type) === vm.responseTypeEnum.IMAGE && content.imageUrl.length > 0">\n        <md-card class="card-container">\n          <div class="container">\n            <img class="card-image" ng-src="{{content.imageUrl}}" class="md-card-image">\n          </div>\n        </md-card>\n      </div>\n\n      <div title="Google Basic Card" ng-if="vm.getResponseType(content.type) === vm.responseTypeEnum.BASIC_CARD" style="padding:0;">\n        <console-basic-card-response content="content"\n                                     send-request="vm.sendRequest"></console-basic-card-response>\n      </div>\n\n      <div title="List Response" ng-if="vm.getResponseType(content.type) === vm.responseTypeEnum.LIST_CARD">\n        <console-list-response content="content"\n                               send-request="vm.sendRequest"></console-list-response>\n      </div>\n\n      <div title="Suggestion Chips Response" ng-if="vm.getResponseType(content.type) === vm.responseTypeEnum.SUGGESTION_CHIPS">\n        <console-suggestion-chips content="content"\n                                  send-request="vm.sendRequest"></console-suggestion-chips>\n      </div>\n\n\n      <div title="Google Carousel Card Response" ng-if="vm.getResponseType(content.type) === vm.responseTypeEnum.CAROUSEL_CARD">\n        <console-carousel-response content="content" send-request="vm.sendRequest"></console-carousel-response>\n      </div>\n\n      <div title="Link Out Chip Response" ng-if="vm.getResponseType(content.type) === vm.responseTypeEnum.LINK_OUT_CHIP">\n        <console-link-out-chip content="content"></console-link-out-chip>\n      </div>\n\n    </div>\n  </div>\n</div>\n\n'},function(e,t){e.exports='<form class="whitelist-form">\n\n  <h2>Whitelist emails</h2>\n\n  <div class="top-button" layout="row"  layout-align="end center">\n    <label layout="column" class="md-button md-raised" flex="20" ng-disabled="vm.uploading">\n      <span>Choose JSON</span>\n      <input type="file" id="file" name="file" style="display: none" ng-disabled="vm.uploading">\n    </label>\n  </div>\n\n  <div class="input-group" ng-repeat="email in vm.emails track by $index">\n    <input\n        ng-model="vm.emails[$index]"\n        type="text"\n        class="form-control"\n        placeholder="Enter email...">\n\n    <span class="mic-ico">\n      <span class="glyphicon glyphicon-trash" ng-click="vm.removeEmail($index)"></span>\n    </span>\n\n  </div>\n\n  <a class="bottom-button" ng-click="vm.addEmail()">\n    <span class="flaticon stroke plus"></span> New email\n  </a>\n\n  <div class="bottom-button" layout="row" layout-align="end center">\n    <div layout="column" flex="20" layout-align="center stretch">\n      <md-button\n          class="md-button md-raised md-primary"\n          ng-click="vm.updateEmails()"\n          ng-disabled="!vm.uploadingEnabled()"\n          ng-hide="vm.uploading">\n        Update\n      </md-button>\n    </div>\n    <div layout="column" flex="20" layout-align="center center" ng-show="vm.uploading">\n      <md-progress-circular md-mode=\'indeterminate\' md-diameter="50"></md-progress-circular>\n    </div>\n  </div>\n\n</form>\n'},,,function(e,t,n){var i=n(285);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(286);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(287);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(288);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(289);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(291);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(292);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(293);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(294);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(295);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(296);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(297);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(298);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(299);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(300);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(301);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(302);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(303);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(305);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(306);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(307);"string"==typeof i&&(i=[[e.i,i,""]]);n(7)(i,{});i.locals&&(e.exports=i.locals)},,,function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(150),o=(n.n(i),n(152)),a=(n.n(o),n(129)),r=n(118),s=n(119),l=n(132),u=n(116),c=n(133),d=n(17),m=n(76),g=n(37),h=n(145),p=n(122),f=n(124),v=n(13),b=n(81),y=n(45),k=n(142),A=n(138),S=n(144),w=n(143),E=n(55),C=n(77),_=n(141),T=n(41),L=n(8),I=n(147),x=n(78),R=n(131),U=n(90),P=n(140),O=n(139),$=n(117),D=n(121),N=n(123),M=n(126),F=n(125),j=n(115),G=(n.n(j),n(130)),B=n(120),q=n(148),V=n(149),z=n(146),H=n(127);n(153);var K=angular.module("api.components",[l.a.name,a.a.name,r.a.name,s.a.name,_.a.name,c.a.name,u.a.name,"api.security",B.a.name,$.a.name,P.a.name,O.a.name,"ui.ace","ngFileUpload",G.a.name]);K.config(["$provide","$compileProvider",function(e,t){"ngInject";e.constant("$compileProvider",t)}]),K.component("staticInfo",f.a).component("batchPopup",p.a).component("consoleResponseContent",U.a).component("consoleFulfillment",R.a).component("authorizeGooglePopup",D.a).component("retrieveAccess",N.a).component("toolbarNotice",M.a).component("customToolbarNotice",F.a).component("tosPopup",H.a).factory("ParserService",function(){return g.a}).factory("MetaAliasService",function(){return E.a}).factory("AnnotateHelperService",function(){return d.a}).factory("ColorHelperService",function(){return m.a}).factory("WrapColorHelperService",function(){return C.a}).factory("PubSubHelperService",function(){return v.a}).factory("AnalyticsServiceV2",function(){return y.a}).factory("UtilsService",function(){return T.a}).factory("IntegrationDependencyManager",function(){return x.a}).factory("NotificationService",function(){return L.a}).factory("RecordRTC",function(){return o}).service("intentParamsAutosyncService",h.a).service("ChartService",k.a).service("limitsManager",A.a).service("TTSService",I.a).service("ApiAiQueryService",q.a).service("CceQueryService",V.a).service("LanguageServiceV2",z.a).constant("ModelsProvider",b.default).constant("METAS",d.b),angular.module("api.security").service("CurrentUser",S.a).service("CurrentAgentService",w.a),t.default=K},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=jQuery}],[382]);