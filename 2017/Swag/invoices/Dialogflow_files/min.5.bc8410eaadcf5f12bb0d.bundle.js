webpackJsonp([5],{388:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t(441),a=t(443),s=[{name:"domainsTraining",component:new i.a},{name:"smalltalk",component:a.a}];e.default=s},441:function(n,e,t){"use strict";var i=t(0),a=t.n(i),s=t(442),o=t(514);t(535);var r=function n(){a()(this,n),this.bindings={agent:"<",domain:"<",smalltalkMap:"<",closeCb:"&",saveCb:"=",switchVersionCb:"=",getCompletedCb:"=",customizedPercent:"=",hideDescription:"<",isNewVersion:"<",isAgentReadOnly:"<"},this.template=o,this.controller=s.a,this.controllerAs="vm"};e.a=r},442:function(n,e,t){"use strict";var i=t(39),a=t.n(i),s=t(26),o=t.n(s),r=t(0),c=t.n(r),d=t(1),l=t.n(d),g=t(13),m=function(){function n(e,t,i,a,s,o,r){var d=this,l=arguments.length>7&&void 0!==arguments[7]&&arguments[7];c()(this,n),this.CurrentAgentService=e,this.urls=t,this.AnalyticsService=i,this.$http=a,this.$q=s,this.$timeout=o,this.domainDataService=r,this.initManually=l,this.categoriesCount=0,this.isLoading=!0,this.preventAutoSave=!1,this.agentChangedHandler=function(){d.preventAutoSave=!0},this.categories={},this.categoryOpened=[],this.isLoading=!0,this.currentLanguage=this.CurrentAgentService.getCurrentLanguage(),g.a.subscribe(g.a.DEFINED_EVENTS.CURRENT_AGENT_CHANGED,this.agentChangedHandler)}return n.$inject=["CurrentAgentService","urls","AnalyticsService","$http","$q","$timeout","domainDataService"],l()(n,[{key:"$onDestroy",value:function(){g.a.unsubscribe(g.a.DEFINED_EVENTS.CURRENT_AGENT_CHANGED,this.agentChangedHandler),this.preventAutoSave||(console.log("saving custom answers"),this.saveCustomAnswers())}},{key:"$onInit",value:function(){this.saveCb=this.saveCustomAnswers.bind(this),this.getCompletedCb=this.getCompletedTotal.bind(this),this.initManually||(this.AnalyticsService.track("DOMAINS_CUSTOMIZATION_OPENED",{domain:this.domain.featureName}),this.init())}},{key:"loadQuestions",value:function(){return this.domainDataService.loadQuestions(this.currentLanguage).then(this.processQuestions.bind(this))}},{key:"loadAnswers",value:function(){return this.domainDataService.loadAnswers(this.currentLanguage)}},{key:"processAnswers",value:function(n){var e=this;if(this.clearAnswers(),null!=n[1].data){var t=n[1].data.customResponses;_.each(t,function(n){var t=null;_.some(e.categories,function(i){var a=i.find(function(t){if(e.isNewVersion){var i=t.action===n.action;if(!i&&n.parameters&&n.parameters.length&&e.smalltalkMap[t.action]){var a=e.smalltalkMap[t.action].action,s=o()(e.smalltalkMap[t.action].parameters);return n.action===a&&o()(n.parameters)===s}return i}return t.action===n.action&&o()(t.parameters)===o()(n.parameters)});if(a)return t=a,!0}),t&&(t.answers=n.customAnswers)})}}},{key:"init",value:function(){var n=this;return this.$q.all([this.loadQuestions(),this.loadAnswers()]).then(this.processAnswers.bind(this)).then(function(){return n.isLoading=!1})}},{key:"processQuestions",value:function(n){var e=this;if(null!==n){n.categories.forEach(function(n){e.categories[n.Category]||(e.categories[n.Category]=[],e.categoriesCount++),e.isNewVersion||(n.parameters=_.isArray(n.parameters)?n.parameters:[n.parameters]),e.categories[n.Category].push(n)})}}},{key:"saveCustomAnswers",value:function(){var n=this,e={domain:"smalltalk",customResponses:[]};_.forEach(this.categories,function(n){n.forEach(function(n){if(n.answers&&n.answers.length){var t=n.answers.filter(function(n){return!!n});if(t.length){var i={action:n.action,parameters:n.parameters,customAnswers:t};e.customResponses.push(i)}}})}),this.makeCustomAnswersSave(e).then(function(){n.AnalyticsService.track("DOMAINS_CUSTOMIZATION_SAVED",{domain:n.domain.featureName,customized:n.getCompletedTotal()}),n.$timeout(function(){return n.isLoading=!1},300)})}},{key:"makeCustomAnswersSave",value:function(n){return this.isLoading=!0,this.domainDataService.saveAnswers(n,this.currentLanguage)}},{key:"getCompletedTotal",value:function(){var n=this,e=a()(this.categories).reduce(function(e,t){return e+n.getCompletedForCategory(n.categories[t])},0);return this.customizedPercent=Math.round(e/this.categoriesCount),this.customizedPercent}},{key:"getCompletedForCategory",value:function(n){var e=n.length,t=n.reduce(function(n,e){return e.answers&&e.answers.length&&(e.answers.length>1||e.answers[0])?n+1:n},0);return Math.round(t/e*100)}},{key:"toggleCategory",value:function(n){this.isCategoryOpened(n)?this.categoryOpened.splice(this.categoryOpened.indexOf(n),1):this.categoryOpened.push(n)}},{key:"isCategoryOpened",value:function(n){return this.categoryOpened.indexOf(n)>-1}},{key:"clearAnswers",value:function(){_.each(this.categories,function(n){_.each(n,function(n){n.answers=[]})})}}]),n}();e.a=m},443:function(n,e,t){"use strict";var i=t(0),a=t.n(i),s=t(1),o=t.n(s),r=t(61);t.d(e,"a",function(){return d});var c=function(){function n(e,t,i,s){var o=this;a()(this,n),this.CurrentAgentService=t,this.AgentData=i,this.apiConfig=s,this.domain=new r.a({}),this.getCompletedTotal=null,this.saveCustomAnswers=null,this.updateVersionQuestions=null,this.isEnabled=!1,this.isNewVersion=!0,this.saveProgressConf={loading:"Saving...",finished:"Saved",type:"background-horizontal",recoverytime:0,aftertime:3},this.saveProgressPromise=null;var c={label:"Save",callback:this.makeSaveCustomAnswers.bind(this)};e.config.navButton={items:[c],progressButtonClosure:function(){return o.saveProgressPromise},progressButtonConf:this.saveProgressConf},this.agent=this.CurrentAgentService.getCurrentAgent(),this.isEnabled=s.isUsingSmalltalk(this.agent),t.checkReadOnly().then(function(n){o.isAgentReadOnly=n,c.disabled=n})}return n.$inject=["InnerHeaderService","CurrentAgentService","AgentData","apiConfig"],o()(n,[{key:"$onInit",value:function(){this.domain=this.domainsList.find(function(n){return"smalltalk"===n.domainShortName})||this.domain}},{key:"onSwitchChange",value:function(){this.isEnabled?this.apiConfig.enableSmallTalk(this.agent):this.apiConfig.disableSmallTalk(this.agent),this.makeSaveCustomAnswers()}},{key:"makeSaveCustomAnswers",value:function(){var n=this;this.saveProgressPromise=this.AgentData.updateAgent(this.agent).then(function(){n.CurrentAgentService.setCurrentAgent(n.agent),n.saveCustomAnswers()})}}]),n}();t(536);var d={controller:c,controllerAs:"vm",template:t(515),bindings:{domainsList:"<",smalltalkMap:"<"}}},474:function(n,e,t){e=n.exports=t(6)(),e.push([n.i,"/* Mixin */\n.b-domain-training-is-loading {\n  display: block !important;\n  position: absolute;\n  top: 45%;\n  left: 0;\n  width: 100%;\n}\n.md-button.b_domains_training-save_button {\n  position: absolute;\n  top: 45px;\n  right: 20px;\n  margin: 0;\n  width: 155px;\n}\n.b_domains_training-category_head {\n  height: 60px;\n  background-color: white;\n  border: 1px #DFE0E2 solid;\n  padding-top: 10px;\n  position: relative;\n}\n.b_domains_training-category_head_icon {\n  margin-left: 20px;\n  margin-right: 20px;\n  color: #b7bbc4;\n}\n.b_domains_training-category_holder {\n  margin-bottom: 20px;\n}\n.b_domains_training-category_body {\n  border: 1px #DFE0E2 solid;\n  border-top: 0;\n  padding: 20px;\n}\n.b_domains_training-category_body .description-holder {\n  text-transform: uppercase;\n  padding: 12px 0;\n  font-weight: 400;\n  color: #9399a9;\n  font-size: 12px;\n}\n.b_domains_training-category_body .question-holder {\n  padding: 9px 0;\n  font-weight: 400;\n}\n.b_domains_training-category_body hr {\n  margin: 20px -20px;\n}\n.b_domains_training-category_body .input-row-form:last-of-type hr {\n  display: none;\n}\n.b_domains_training-category_head_completed {\n  position: absolute;\n  right: 20px;\n  top: 20px;\n}\n.b_domains_training-category_head_completed .b_domains_training-category_head_completed__bar {\n  width: 100px;\n  height: 8px;\n  margin-right: 10px;\n  background-color: #b7bbc4;\n  position: absolute;\n  right: 45px;\n  top: 50%;\n  margin-top: -4px;\n}\n.b_domains_training-category_head_completed .b_domains_training-category_head_completed__bar_completed {\n  height: 8px;\n  width: 0;\n  background-color: #5fc9af;\n  transition: width 0.5s;\n}\n.b_domains_training-category_head_completed .b_domains_training-category_head_completed__value {\n  display: inline-block;\n}\n.b_domains_training-category_head_completed .b_domains_training-category_head_completed__value:after {\n  content: '%';\n}\n",""])},475:function(n,e,t){e=n.exports=t(6)(),e.push([n.i,"smalltalk .customization-holder {\n  position: relative;\n}\nsmalltalk .customization-holder .b_domains_training-category_head_completed {\n  top: 0px;\n}\n",""])},514:function(n,e){n.exports='\n<div class="b-domain-training-is-loading" ng-show="vm.isLoading">\n    <div layout="row"  layout-align="center center">\n        <md-progress-circular  md-mode=\'indeterminate\'></md-progress-circular>\n    </div>\n\n    <div layout="row" layout-align="center center">\n        Checking status...\n    </div>\n</div>\n\n<div ng-class="{\'invisible\': vm.isLoading}">\n\n    <p class="b-domain-popup-description" ng-if="::!vm.hideDescription">You can customize responses for the most popular requests here.</p>\n\n    <div ng-repeat="(categoryName, category) in vm.categories track by categoryName" class="b_domains_training-category_holder">\n        <div class="b_domains_training-category_head" ng-click="vm.toggleCategory(categoryName)">\n            <h4>\n                <span class="flaticon stroke folder b_domains_training-category_head_icon"></span>\n                {{::categoryName}}\n            </h4>\n\n            <div class="b_domains_training-category_head_completed">\n                <div class="b_domains_training-category_head_completed__bar">\n                    <div class="b_domains_training-category_head_completed__bar_completed" style="width: {{vm.getCompletedForCategory(category)}}%"></div>\n                </div>\n                <div class="b_domains_training-category_head_completed__value" ng-bind="vm.getCompletedForCategory(category)"></div>\n            </div>\n        </div>\n        <div class="b_domains_training-category_body animate-show" ng-show="vm.isCategoryOpened(categoryName)">\n            <div ng-repeat="question in category track by $index" class="input-row-form">\n                <div layout="row">\n                    <div flex="20" class="description-holder">\n                        <span >QUESTION</span>\n                    </div>\n                    <div class="question-holder" flex>\n                        {{::question.Example}}\n                    </div>\n                </div>\n                <div layout="row">\n                    <div flex="20" class="description-holder">\n                        <span>ANSWER</span>\n                    </div>\n                    <div flex>\n                        <div class="input-group sti-multiple-input" sti-intent-param-prompts-editor\n                             collection="question.answers"\n                             collection-item-name="\'Answer\'"\n                             ng-disabled="vm.isAgentReadOnly"\n                        ></div>\n                    </div>\n                </div>\n\n                <hr/>\n\n            </div>\n        </div>\n    </div>\n</div>\n\n'},515:function(n,e){n.exports='<p>\n  \x3c!--span ng-bind="::vm.domain.longDescription"></span--\x3e\n  Your agent can learn how to support small talk without any extra development. By default, it will respond with predefined phrases. Use the form below to customize responses to the most popular requests.\n</p>\n<pre ng-bind="::vm.domain.sampleRequests"></pre>\n<md-switch class="md-primary" ng-model="vm.isEnabled" ng-change="vm.onSwitchChange()" aria-label="Enable smalltalk" ng-disabled="vm.isAgentReadOnly">Enable</md-switch>\n\n\x3c!--p></p>\n<a ng-click="customization = !customization">Customization > </a>\n<div ng-show="customization" class="animate-show">\n  <p></p--\x3e\n\n<div class="customization-holder" style="position: relative">\n  <h4>Small Talk Customization Progress</h4>\n  <div class="b_domains_training-category_head_completed" flex="15">\n    <div class="b_domains_training-category_head_completed__bar">\n      <div class="b_domains_training-category_head_completed__bar_completed" style="width: {{vm.getCompletedTotal()}}%"></div>\n    </div>\n    <div class="b_domains_training-category_head_completed__value" ng-bind="vm.getCompletedTotal()"></div>\n  </div>\n</div>\n\n<domains-training\n    agent="vm.agent"\n    customized-percent="vm.customizedPercent"\n    domain="vm.domain"\n    smalltalk-map="vm.smalltalkMap"\n    hide-description="true"\n    is-new-version="vm.isNewVersion"\n    close-cb="vm.closeDialog()"\n    save-cb="vm.saveCustomAnswers"\n    get-completed-cb="vm.getCompletedTotal"\n    is-agent-read-only="vm.isAgentReadOnly">\n</domains-training>'},535:function(n,e,t){var i=t(474);"string"==typeof i&&(i=[[n.i,i,""]]);t(7)(i,{});i.locals&&(n.exports=i.locals)},536:function(n,e,t){var i=t(475);"string"==typeof i&&(i=[[n.i,i,""]]);t(7)(i,{});i.locals&&(n.exports=i.locals)}});